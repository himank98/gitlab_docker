(this.webpackJsonp=this.webpackJsonp||[]).push([[91],{"+ihE":function(t,e,n){"use strict";n.r(e);n("va8A"),n("kO4A"),n("+kFb"),n("zCcL"),n("zpLX"),n("BD5p"),n("Id6h");var r,a=n("yi8e"),i=n("4SWJ"),o=n.n(i),s=n("GTGS"),c=n("BXQK"),u=n("s1D3"),l=n("/lV4"),d=n("930T"),f=(n("9U97"),n("FMw2"),n("yaFd"),n("y6Fo"),n("QifN"),n("RyA9")),h=n("BR6W"),p=n("5c3i"),m=n("1aG2"),v=n("R9PN");function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O={components:{DashboardPanel:f.a},props:{containerClass:{type:String,required:!1,default:"col-lg-12"},dashboardUrl:{type:String,required:!0},namespace:{type:String,required:!1,default:"monitoringDashboard"}},data:function(){var t=Object(m.m)(this.dashboardUrl)||p.a;return{timeRange:Object(h.a)(t),elWidth:0}},computed:g(g({},Object(a.e)({dashboard:function(t){return t[this.namespace].dashboard},metricsWithData:function(t,e){return e["".concat(this.namespace,"/metricsWithData")]()}})),{},{charts:function(){var t=this;return this.dashboard&&this.dashboard.panelGroups?this.dashboard.panelGroups.reduce((function(e,n){return e.concat(n.panels.filter(t.chartHasData))}),[]):[]},isSingleChart:function(){return 1===this.charts.length},embedClass:function(){return this.isSingleChart?this.containerClass:"col-lg-12"},panelClass:function(){return this.isSingleChart?"col-lg-12":"col-lg-6"}}),mounted:function(){this.setInitialState({dashboardEndpoint:Object(m.j)(this.dashboardUrl)}),this.setShowErrorBanner(!1),this.setTimeRange(this.timeRange),this.fetchDashboard(),(r=new MutationObserver(this.onSidebarMutation)).observe(document.querySelector(".layout-page"),{attributes:!0,childList:!1,subtree:!1})},beforeDestroy:function(){r&&r.disconnect()},methods:g(g({},Object(a.c)({setTimeRange:function(t,e){return t("".concat(this.namespace,"/setTimeRange"),e)},fetchDashboard:function(t,e){return t("".concat(this.namespace,"/fetchDashboard"),e)},setInitialState:function(t,e){return t("".concat(this.namespace,"/setInitialState"),e)},setShowErrorBanner:function(t,e){return t("".concat(this.namespace,"/setShowErrorBanner"),e)}})),{},{chartHasData:function(t){var e=this;return t.metrics.some((function(t){return e.metricsWithData.includes(t.metricId)}))},onSidebarMutation:function(){var t=this;setTimeout((function(){t.elWidth=t.$el.clientWidth}),v.u)}})},A=n("tBpV"),S=Object(A.a)(O,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"metrics-embed p-0 d-flex flex-wrap",class:t.embedClass},t._l(t.charts,(function(e,r){return n("dashboard-panel",{key:"dashboard-panel-"+r,class:t.panelClass,attrs:{"graph-data":e,"group-id":t.dashboardUrl,namespace:t.namespace}})})),1)}),[],!1,null,null,null).exports;function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){D(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var j={components:{GlDeprecatedButton:s.a,GlCard:c.a,GlIcon:u.a,MetricEmbed:S},props:{urls:{type:Array,required:!0,validator:function(t){return t.length>0}}},data:function(){return{isCollapsed:!1}},computed:E(E(E({},Object(a.e)("embedGroup",["module"])),Object(a.d)("embedGroup",["metricsWithData"])),{},{arrowIconName:function(){return this.isCollapsed?"chevron-right":"chevron-down"},bodyClass:function(){return["border-top","pl-3","pt-3",{"d-none":this.isCollapsed}]},buttonLabel:function(){return this.isCollapsed?Object(l.c)("View chart","View charts",this.numCharts):Object(l.c)("Hide chart","Hide charts",this.numCharts)},containerClass:function(){return this.isSingleChart?"col-lg-12":"col-lg-6"},numCharts:function(){return null===this.metricsWithData?0:o()(this.metricsWithData)},isSingleChart:function(){return 1===this.numCharts}}),created:function(){var t=this;this.urls.forEach((function(e,n){var r=t.getNamespace(n);t.$store.registerModule(r,d.b),t.addModule(r)}))},methods:E(E({},Object(a.c)("embedGroup",["addModule"])),{},{getNamespace:function(t){return"monitoringDashboard/".concat(t)},toggleCollapsed:function(){this.isCollapsed=!this.isCollapsed}})},T=Object(A.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("gl-card",{directives:[{name:"show",rawName:"v-show",value:t.numCharts>0,expression:"numCharts > 0"}],staticClass:"collapsible-card border p-0 mb-3",attrs:{"header-class":"d-flex align-items-center border-bottom-0 py-2","body-class":t.bodyClass},scopedSlots:t._u([{key:"header",fn:function(){return[n("gl-deprecated-button",{staticClass:"collapsible-card-btn d-flex text-decoration-none",attrs:{"aria-label":t.buttonLabel,variant:"link"},on:{click:t.toggleCollapsed}},[n("gl-icon",{staticClass:"mr-1",attrs:{name:t.arrowIconName}}),t._v("\n      "+t._s(t.buttonLabel)+"\n    ")],1)]},proxy:!0}])},[t._v(" "),n("div",{staticClass:"d-flex flex-wrap"},t._l(t.urls,(function(e,r){return n("metric-embed",{key:r+"/"+e,attrs:{"dashboard-url":e,namespace:t.getNamespace(r),"container-class":t.containerClass}})})),1)])}),[],!1,null,null,null);e.default=T.exports},"1aG2":function(t,e,n){"use strict";n.d(e,"h",(function(){return h})),n.d(e,"e",(function(){return m})),n.d(e,"c",(function(){return v})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return g})),n.d(e,"m",(function(){return y})),n.d(e,"b",(function(){return A})),n.d(e,"l",(function(){return S})),n.d(e,"k",(function(){return _})),n.d(e,"j",(function(){return E})),n.d(e,"n",(function(){return D})),n.d(e,"d",(function(){return j})),n.d(e,"i",(function(){return T})),n.d(e,"a",(function(){return k}));n("va8A"),n("9U97"),n("kO4A"),n("t3Gg"),n("+kFb"),n("FMw2"),n("x/6R"),n("Z5ek"),n("yaFd"),n("zCcL"),n("zpLX"),n("BD5p"),n("MRnW"),n("N0ZT"),n("Ag57"),n("IdsT"),n("GzNv"),n("QifN"),n("S26F"),n("TZoF"),n("Ch9p"),n("Id6h"),n("orcL");var r=n("R4kS"),a=n.n(r),i=n("osXd"),o=n.n(i),s=n("3twG"),c=n("BR6W"),u=n("R9PN");function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(t,e){var n=t?"value":"values";return Array.isArray(e.metrics)&&e.metrics.filter((function(t){return!!Array.isArray(t.result)&&t.result.filter((function(t){return Array.isArray(t[n])})).length===t.result.length})).length===e.metrics.filter((function(t){return t.result})).length},p=function(){return(document.body.dataset.page||"").includes(":clusters:show")},m=function(t){var e=p();return{category:e?"Cluster Monitoring":"Incident Management::Embedded metrics",action:e?"generate_link_to_cluster_metric_chart":"generate_link_to_metrics_chart",label:"Chart link",property:t}},v=function(t){var e=p();return{category:e?"Cluster Monitoring":"Incident Management::Embedded metrics",action:e?"download_csv_of_cluster_metric_chart":"download_csv_of_metrics_dashboard_chart",label:"Chart title",property:t}},b=function(){return{category:document.body.dataset.page,action:"click_button",label:"add_new_metric",property:"modal"}},g=function(t){return t.metrics&&3===t.metrics.length&&h(!1,t)},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e=Object(s.p)(t);return Object(c.e)(e)},O=function(t){return(t||"").replace(new RegExp("^".concat(u.f)),"")},A=function(t){return Object.keys(t||{}).reduce((function(e,n){var r,a;return e[(a=n,"".concat(u.f).concat(a))]=null===(r=t[n])||void 0===r?void 0:r.value,e}),{})},S=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.search,e=Object(s.p)(t),n=o()(e,(function(t,e){return e.startsWith(u.f)}));return a()(n,(function(t,e){return O(e)}))},_=function(t){var e=A(t);Object(s.w)({url:Object(s.n)(e,window.location.href),title:document.title})},E=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href;return Object(s.t)(c.f,t)},D=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href,n=E(e),r=Object(c.g)(t);return Object(s.n)(r,n)},j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.search,n=Object(s.p)(e);if(n.group||n.title||n.y_label){var r=t.panelGroups.find((function(t){var e=t.group;return n.group===e})),a=r.panels.find((function(t){var e=t.y_label,r=t.title;return e===n.y_label&&r===n.title}));if(!a)throw new Error("Panel could no found by URL parameters.");return{group:r.group,panel:a}}return null},T=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window.location.href,i=d({dashboard:t},e);return n&&r?(i.group=n,i.title=r.title,i.y_label=r.y_label):(i.group=null,i.title=null,i.y_label=null),Object(s.n)(i,a)},w=function(t){var e;return null===(e=t[0])||void 0===e?void 0:e[1]},x=function(t){var e;return null===(e=Object.values(t))||void 0===e?void 0:e[0]},C=function(t){var e=t.metric,n=t.values;return[w(void 0===n?[]:n),x(e)]},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return null==t?void 0:t.reduce((function(t,e){var n=e.result,r=void 0===n?[]:n,a=e.label;return d(d({},t),{},f({},a,r.map(C)))}),{})}},"5c3i":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));n("t3Gg"),n("8Qi2");var r=n("/lV4"),a="minute",i="hour",o="day",s=[{label:Object(r.a)("30 minutes"),duration:{seconds:1800},name:"thirtyMinutes",interval:a},{label:Object(r.a)("3 hours"),duration:{seconds:10800},name:"threeHours",interval:i},{label:Object(r.a)("8 hours"),duration:{seconds:28800},name:"eightHours",default:!0,interval:i},{label:Object(r.a)("1 day"),duration:{seconds:86400},name:"oneDay",interval:i},{label:Object(r.a)("3 days"),duration:{seconds:259200},name:"threeDays",interval:i},{label:Object(r.a)("1 week"),duration:{seconds:604800},name:"oneWeek",interval:o},{label:Object(r.a)("1 month"),duration:{seconds:2592e3},name:"oneMonth",interval:o}],c=s.find((function(t){return t.default}))},"7ASz":function(t,e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getEnvironments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"states"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"data"},name:{kind:"Name",value:"environments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"states"},value:{kind:"Variable",name:{kind:"Name",value:"states"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"environments"},name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:247}};n.loc.source={body:"query getEnvironments($projectPath: ID!, $search: String, $states: [String!]) {\n  project(fullPath: $projectPath) {\n    data: environments(search: $search, states: $states) {\n      environments: nodes {\n        name\n        id\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};function a(t,e){for(var n=0;n<t.definitions.length;n++){var r=t.definitions[n];if(r.name&&r.name.value==e)return r}}n.definitions.forEach((function(t){if(t.name){var e=new Set;!function t(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var r=e.type;"NamedType"===r.kind&&n.add(r.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,n)})),e.definitions&&e.definitions.forEach((function(e){t(e,n)}))}(t,e),r[t.name.value]=e}})),t.exports=n,t.exports.getEnvironments=function(t,e){var n={kind:t.kind,definitions:[a(t,e)]};t.hasOwnProperty("loc")&&(n.loc=t.loc);var i=r[e]||new Set,o=new Set,s=new Set;for(i.forEach((function(t){s.add(t)}));s.size>0;){var c=s;s=new Set,c.forEach((function(t){o.has(t)||(o.add(t),(r[t]||new Set).forEach((function(t){s.add(t)})))}))}return o.forEach((function(e){var r=a(t,e);r&&n.definitions.push(r)})),n}(n,"getEnvironments")},"930T":function(t,e,n){"use strict";n.d(e,"b",(function(){return le})),n.d(e,"a",(function(){return de}));var r={};n.r(r),n.d(r,"setGettingStartedEmptyState",(function(){return lt})),n.d(r,"setInitialState",(function(){return dt})),n.d(r,"setTimeRange",(function(){return ft})),n.d(r,"setVariables",(function(){return ht})),n.d(r,"filterEnvironments",(function(){return pt})),n.d(r,"setShowErrorBanner",(function(){return mt})),n.d(r,"setExpandedPanel",(function(){return vt})),n.d(r,"clearExpandedPanel",(function(){return bt})),n.d(r,"fetchData",(function(){return gt})),n.d(r,"fetchDashboard",(function(){return yt})),n.d(r,"requestMetricsDashboard",(function(){return Ot})),n.d(r,"receiveMetricsDashboardSuccess",(function(){return At})),n.d(r,"receiveMetricsDashboardFailure",(function(){return St})),n.d(r,"fetchDashboardData",(function(){return _t})),n.d(r,"fetchPrometheusMetric",(function(){return Et})),n.d(r,"fetchDeploymentsData",(function(){return Dt})),n.d(r,"receiveDeploymentsDataSuccess",(function(){return jt})),n.d(r,"receiveDeploymentsDataFailure",(function(){return Tt})),n.d(r,"fetchEnvironmentsData",(function(){return wt})),n.d(r,"requestEnvironmentsData",(function(){return xt})),n.d(r,"receiveEnvironmentsDataSuccess",(function(){return Ct})),n.d(r,"receiveEnvironmentsDataFailure",(function(){return kt})),n.d(r,"fetchAnnotations",(function(){return It})),n.d(r,"receiveAnnotationsSuccess",(function(){return Nt})),n.d(r,"receiveAnnotationsFailure",(function(){return Pt})),n.d(r,"toggleStarredValue",(function(){return Rt})),n.d(r,"setPanelGroupMetrics",(function(){return Mt})),n.d(r,"duplicateSystemDashboard",(function(){return Lt})),n.d(r,"updateVariablesAndFetchData",(function(){return Ft})),n.d(r,"default",(function(){return Ut}));var a={};n.r(a),n.d(a,"selectedDashboard",(function(){return qt})),n.d(a,"getMetricStates",(function(){return Bt})),n.d(a,"metricsWithData",(function(){return $t})),n.d(a,"metricsSavedToDb",(function(){return Qt})),n.d(a,"filteredEnvironments",(function(){return Wt})),n.d(a,"linksWithMetadata",(function(){return Ht})),n.d(a,"getCustomVariablesParams",(function(){return Zt})),n.d(a,"default",(function(){return Yt}));n("va8A"),n("kO4A"),n("+kFb"),n("zCcL"),n("zpLX"),n("BD5p"),n("Id6h");var i=n("jB52"),o=n("yi8e"),s=(n("x/6R"),n("MRnW"),n("jaBk"),n("tbvx"),n("orcL"),n("cT/n")),c=n("2ibD"),u=n("XRO8"),l=n("BR6W"),d=(n("z4I3"),n("dj/k"),n("9U97"),n("t3Gg"),n("OZM5"),n("S6uq"),n("Z5ek"),n("4ql4"),n("8Qi2"),n("+xU6"),n("L1PU"),n("IdsT"),n("GzNv"),n("S26F"),n("CgWz"),n("0AwG")),f=n("5v28"),h=n("gnBj"),p=n("FxFN"),m=n("R9PN"),v=(n("yaFd"),n("5j0x"),n("lx39")),b=n.n(v),g=n("1aG2");function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){A(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var E=function(t){return{type:m.g.text,label:null,value:t}},D=function(t){return{type:m.g.text,label:t.label,value:t.options.default_value}},j=function(t){var e=t.default,n=void 0!==e&&e,r=t.text,a=t.value;return{default:n,text:r||a,value:a}},T=function(t){var e,n,r=(null!==(e=null==t?void 0:null===(n=t.options)||void 0===n?void 0:n.values)&&void 0!==e?e:[]).map(j),a=r.find((function(t){return!0===t.default}))||r[0];return{type:m.g.custom,label:t.label,value:null==a?void 0:a.value,options:r}},w=function(t){return{text:t,value:t}},x=function(t){var e=(t||[]).map(w);return{type:m.g.custom,value:e[0].value,label:null,options:e.map(j)}},C=function(t){return e=t,Array.isArray(e)?x:t.type===m.g.custom?T:t.type===m.g.text?D:b()(t)?E:function(){return null};var e},k=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.variables,n=void 0===e?{}:e;return Object.entries(n).reduce((function(t,e){var n=S(e,2),r=n[0],a=n[1],i=C(a)(a);return i&&(t[r]=O(O({},i),{},{label:i.label||r})),t}),{})},I=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(g.l)(),n={};return Object.keys(t).forEach((function(r){Object.prototype.hasOwnProperty.call(e,r)?n[r]=O(O({},t[r]),{},{value:e[r]}):n[r]=t[r]})),n},N=n("GuZl"),P=n("3twG");function R(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function L(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var V=Object(f.a)({},{fetchPolicy:f.b.NO_CACHE}),z=function(t){var e=t.metric_id,n=t.id;return"".concat(e||m.c,"_").concat(n)},q=function(t){return(t||"").replace(/^\/+/,"")},B=function(t){return t?t.map((function(t){return U(U({},t),{},{startingAt:new Date(t.startingAt),endingAt:t.endingAt?new Date(t.endingAt):null})})):[]},$=function(t){return t.map((function(t){var e=t.label,n=t.id,r=t.metric_id,a=t.query_range,i=t.prometheus_endpoint_path,o=L(t,["label","id","metric_id","query_range","prometheus_endpoint_path"]);return U({label:e,queryRange:a,prometheusEndpointPath:i,metricId:z({metric_id:r,id:n}),loading:!1,result:null,state:null},o)}))},Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.url,n=void 0===e?null:e,r=t.title,a=void 0===r?"":r,i=t.type;return{title:a||String(n),type:i,url:n&&Object(P.l)(n)?String(n):"#"}},W=function(t){var e,n,r,a,i,o,s,c,u,l=t.id,d=void 0===l?null:l,f=t.title,p=void 0===f?"":f,m=t.type,v=t.x_axis,b=void 0===v?{}:v,g=t.x_label,y=t.y_label,O=t.y_axis,A=void 0===O?{}:O,S=t.metrics,_=void 0===S?[]:S,E=t.links,D=void 0===E?[]:E,j=t.max_value,T=(e=U({name:g},b),{name:void 0===(n=e.name)?"":n}),w=(r=U({name:y},A),a=r.name,i=void 0===a?"":a,o=r.format,s=void 0===o?h.a.engineering:o,c=r.precision,u=void 0===c?2:c,{name:i,format:h.a[s]||h.a.engineering,precision:u});return{id:d,title:p,type:m,xLabel:T.name,y_label:w.name,yAxis:w,xAxis:T,maxValue:j,links:D.map(Q),metrics:$(_)}},H=function(t,e){var n=t.group,r=void 0===n?"":n,a=t.panels,i=void 0===a?[]:a;return{key:"".concat(Object(d.k)(r||"default"),"-").concat(e),group:r,panels:i.map(W)}},Z=function(t,e){return e===m.r.GRAFANA?function(t){var e=Object(l.c)(t);if(e===N.b.fixed)return{from:new Date(t.start).getTime(),to:new Date(t.end).getTime()};if(e===N.b.rolling){var n=t.duration.seconds;return{from:"now-".concat(n,"s"),to:"now"}}return t}(t):Object(l.g)(t)},Y=function(t){var e={};return t.values?(e=U(U({},t),{},{values:t.values.map((function(t){var e=R(t,2),n=e[0],r=e[1];return[new Date(1e3*n).toISOString(),Number(r)]}))})).values=e.values.filter((function(t){return t.find((function(t){return!Number.isNaN(t[1])&&(null!==t[1]||void 0!==t[1])}))})):t.value&&(e=U(U({},t),{},{value:[new Date(1e3*t.value[0]).toISOString(),Number(t.value[1])]})),e},K=n("4ZIW"),J=function(t){var e=t.label,n=t.value;return K.a.event(document.body.dataset.page,"dashboard_fetch",{label:e,property:"count",value:n})},X=n("7ASz"),tt=n.n(X),et=n("kcAi"),nt=n.n(et),rt=n("QwBj"),at=n("NmEs"),it=n("/lV4");function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function st(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){ct(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ct(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ut(t){return Object(at.e)((function(e,n){t().then((function(t){t.status===rt.a.NO_CONTENT?e():n(t)})).catch(n)}),m.e)}var lt=function(t){(0,t.commit)("SET_GETTING_STARTED_EMPTY_STATE")},dt=function(t,e){(0,t.commit)("SET_INITIAL_STATE",e)},ft=function(t,e){(0,t.commit)("SET_TIME_RANGE",e)},ht=function(t,e){(0,t.commit)("SET_VARIABLES",e)},pt=function(t,e){var n=t.commit,r=t.dispatch;n("SET_ENVIRONMENTS_FILTER",e),r("fetchEnvironmentsData")},mt=function(t,e){(0,t.commit)("SET_SHOW_ERROR_BANNER",e)},vt=function(t,e){(0,t.commit)("SET_EXPANDED_PANEL",{group:e.group,panel:e.panel})},bt=function(t){(0,t.commit)("SET_EXPANDED_PANEL",{group:null,panel:null})},gt=function(t){var e=t.dispatch;e("fetchEnvironmentsData"),e("fetchDashboard"),e("fetchAnnotations")},yt=function(t){var e=t.state,n=t.commit,r=t.dispatch;r("requestMetricsDashboard");var a={};return e.currentDashboard&&(a.dashboard=e.currentDashboard),ut((function(){return c.a.get(e.dashboardEndpoint,{params:a})})).then((function(t){return t.data})).then((function(t){return r("receiveMetricsDashboardSuccess",{response:t})})).catch((function(t){var a,i,o;if(s.a(t),n("SET_ALL_DASHBOARDS",null!==(a=null===(i=t.response)||void 0===i?void 0:null===(o=i.data)||void 0===o?void 0:o.all_dashboards)&&void 0!==a?a:[]),r("receiveMetricsDashboardFailure",t),e.showErrorBanner)if(t.response.data&&t.response.data.message){var c=t.response.data.message;Object(u.a)(Object(it.e)(Object(it.d)("Metrics|There was an error while retrieving metrics. %{message}"),{message:c},!1))}else Object(u.a)(Object(it.d)("Metrics|There was an error while retrieving metrics"))}))},Ot=function(t){(0,t.commit)("REQUEST_METRICS_DASHBOARD")},At=function(t,e){var n=t.commit,r=t.dispatch,a=e.response,i=a.all_dashboards,o=a.dashboard,s=a.metrics_data;return n("SET_ALL_DASHBOARDS",i),n("RECEIVE_METRICS_DASHBOARD_SUCCESS",o),n("SET_ENDPOINTS",Object(at.g)(s)),r("fetchDashboardData")},St=function(t,e){(0,t.commit)("RECEIVE_METRICS_DASHBOARD_FAILURE",e)},_t=function(t){var e=t.state,n=t.dispatch,r=t.getters;if(n("fetchDeploymentsData"),!e.timeRange)return Object(u.a)(Object(it.d)("Metrics|Invalid time range, please verify."),"warning"),Promise.reject();var a,i,o,s,c,d=(a=e.timeRange,i=Object(l.a)(a),o=i.start,s=i.end,c=(new Date(s)-new Date(o))/1e3,{start_time:o,end_time:s,step:Math.max(60,Math.ceil(c/600))}),f=[];return e.dashboard.panelGroups.forEach((function(t){t.panels.forEach((function(t){t.metrics.forEach((function(t){f.push(n("fetchPrometheusMetric",{metric:t,defaultQueryParams:d}))}))}))})),Promise.all(f).then((function(){var t=""===e.currentDashboard?"default":"custom";J({label:"".concat(t,"_metrics_dashboard"),value:r.metricsWithData().length})})).catch((function(){Object(u.a)(Object(it.d)("Metrics|There was an error while retrieving metrics"),"warning")}))},Et=function(t,e){var n,r,a=t.commit,i=t.state,o=t.getters,u=e.metric,l=st({},e.defaultQueryParams);return u.step&&(l.step=u.step),Object.keys(i.variables).length>0&&(l=st(st({},l),o.getCustomVariablesParams)),a("REQUEST_METRIC_RESULT",{metricId:u.metricId}),(n=u.prometheusEndpointPath,r=l,ut((function(){return c.a.get(n,{params:r})})).then((function(t){return t.data})).then((function(t){if("error"===t.status)throw new Error(t.error);return t.data.result}))).then((function(t){a("RECEIVE_METRIC_RESULT_SUCCESS",{metricId:u.metricId,result:t})})).catch((function(t){throw s.a(t),a("RECEIVE_METRIC_RESULT_FAILURE",{metricId:u.metricId,error:t}),t}))},Dt=function(t){var e=t.state,n=t.dispatch;return e.deploymentsEndpoint?c.a.get(e.deploymentsEndpoint).then((function(t){return t.data})).then((function(t){t&&t.deployments||Object(u.a)(Object(it.d)("Metrics|Unexpected deployment data response from prometheus endpoint")),n("receiveDeploymentsDataSuccess",t.deployments)})).catch((function(t){s.a(t),n("receiveDeploymentsDataFailure"),Object(u.a)(Object(it.d)("Metrics|There was an error getting deployment information."))})):Promise.resolve([])},jt=function(t,e){(0,t.commit)("RECEIVE_DEPLOYMENTS_DATA_SUCCESS",e)},Tt=function(t){(0,t.commit)("RECEIVE_DEPLOYMENTS_DATA_FAILURE")},wt=function(t){var e=t.state,n=t.dispatch;return n("requestEnvironmentsData"),V.mutate({mutation:tt.a,variables:{projectPath:q(e.projectPath),search:e.environmentsSearchTerm,states:[m.b]}}).then((function(t){var n,r,a;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;return(t||[]).map((function(t){var n=Object(p.a)(t.id);return U(U({},t),{},{id:n,metrics_path:"".concat(e,"/environments/").concat(n,"/metrics")})}))}(null===(n=t.data)||void 0===n?void 0:null===(r=n.project)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.environments,e.projectPath)})).then((function(t){t||Object(u.a)(Object(it.d)("Metrics|There was an error fetching the environments data, please try again")),n("receiveEnvironmentsDataSuccess",t)})).catch((function(t){s.a(t),n("receiveEnvironmentsDataFailure"),Object(u.a)(Object(it.d)("Metrics|There was an error getting environments information."))}))},xt=function(t){(0,t.commit)("REQUEST_ENVIRONMENTS_DATA")},Ct=function(t,e){(0,t.commit)("RECEIVE_ENVIRONMENTS_DATA_SUCCESS",e)},kt=function(t){(0,t.commit)("RECEIVE_ENVIRONMENTS_DATA_FAILURE")},It=function(t){var e=t.state,n=t.dispatch,r=Object(l.a)(e.timeRange).start,a=e.currentDashboard||m.a;return V.mutate({mutation:nt.a,variables:{projectPath:q(e.projectPath),environmentName:e.currentEnvironmentName,dashboardPath:a,startingFrom:r}}).then((function(t){var e,n,r,a,i;return null===(e=t.data)||void 0===e?void 0:null===(n=e.project)||void 0===n?void 0:null===(r=n.environments)||void 0===r?void 0:null===(a=r.nodes)||void 0===a?void 0:null===(i=a[0].metricsDashboard)||void 0===i?void 0:i.annotations.nodes})).then(B).then((function(t){t||Object(u.a)(Object(it.d)("Metrics|There was an error fetching annotations. Please try again.")),n("receiveAnnotationsSuccess",t)})).catch((function(t){s.a(t),n("receiveAnnotationsFailure"),Object(u.a)(Object(it.d)("Metrics|There was an error getting annotations information."))}))},Nt=function(t,e){return(0,t.commit)("RECEIVE_ANNOTATIONS_SUCCESS",e)},Pt=function(t){return(0,t.commit)("RECEIVE_ANNOTATIONS_FAILURE")},Rt=function(t){var e=t.commit,n=t.state,r=t.getters.selectedDashboard;if(!n.isUpdatingStarredValue&&r){var a=r.starred?"DELETE":"POST",i=r.user_starred_path,o=!r.starred;e("REQUEST_DASHBOARD_STARRING"),Object(c.a)({url:i,method:a}).then((function(){e("RECEIVE_DASHBOARD_STARRING_SUCCESS",{selectedDashboard:r,newStarredValue:o})})).catch((function(){e("RECEIVE_DASHBOARD_STARRING_FAILURE")}))}},Mt=function(t,e){(0,t.commit)("SET_PANEL_GROUP_METRICS",e)},Lt=function(t,e){var n=t.state,r={dashboard:e.dashboard,file_name:e.fileName,branch:e.branch,commit_message:e.commitMessage};return c.a.post(n.dashboardsEndpoint,r).then((function(t){return t.data})).then((function(t){return t.dashboard})).catch((function(t){s.a(t);var e=t.response;throw e&&e.data&&e.data.error?Object(it.e)(Object(it.d)("Metrics|There was an error creating the dashboard. %{error}"),{error:e.data.error}):Object(it.d)("Metrics|There was an error creating the dashboard.")}))},Ft=function(t,e){var n=t.commit,r=t.dispatch;return n("UPDATE_VARIABLES",e),r("fetchDashboardData")},Ut=function(){};n("FMw2"),n("2A3y"),n("QifN"),n("Ch9p"),n("+xeR"),n("dHQd"),n("yoDG"),n("tWNI"),n("8d6S"),n("VwWG"),n("IYHS"),n("MViX"),n("GDOA"),n("a0mT"),n("ta8/"),n("IKCR"),n("nmTw"),n("W2kU"),n("58fc"),n("Rhav"),n("eppl");function Gt(t){return function(t){if(Array.isArray(t))return Vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Vt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var zt,qt=function(t){var e=t.allDashboards;return e.find((function(e){return e.path===t.currentDashboard}))||e.find((function(t){return t.default}))||null},Bt=function(t){return function(e){var n=t.dashboard.panelGroups;e&&(n=n.filter((function(t){return t.key===e})));var r=n.reduce((function(t,e){return e.panels.forEach((function(e){e.metrics.forEach((function(e){e.state&&t.push(e.state)}))})),t}),[]);return Array.from(new Set(r)).sort()}},$t=function(t){return function(e){var n=t.dashboard.panelGroups;e&&(n=n.filter((function(t){return t.key===e})));var r=[];return n.forEach((function(t){t.panels.forEach((function(t){r.push.apply(r,Gt(function(t){return t.metrics.filter((function(t){return t.metricId&&t.result})).map((function(t){return t.metricId}))}(t)))}))})),r}},Qt=function(t){var e=[];return t.dashboard.panelGroups.forEach((function(t){t.panels.forEach((function(t){var n=t.metrics.filter((function(t){return!t.metricId.startsWith(m.c)})).map((function(t){return t.metricId}));e.push.apply(e,Gt(n))}))})),e},Wt=function(t){return t.environments.filter((function(e){return e.name.toLowerCase().includes((t.environmentsSearchTerm||"").trim().toLowerCase())}))},Ht=function(t){var e,n={timeRange:t.timeRange};return null===(e=t.links)||void 0===e?void 0:e.map(function(t){return function(e){var n=U({},e);return t.timeRange&&(n=U(U({},n),{},{url:Object(P.n)(Z(t.timeRange,e.type),e.url)})),n}}(n))},Zt=function(t){return Object.keys(t.variables).reduce((function(e,n){var r,a;return e[(a=n,"variables[".concat(a,"]"))]=null===(r=t.variables[n])||void 0===r?void 0:r.value,e}),{})},Yt=function(){},Kt=(n("8pn6"),n("EWC9"),n("LwwS"),n("2Z+u")),Jt=n.n(Kt);function Xt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function te(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(n),!0).forEach((function(e){ee(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ee(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ne=function(t,e){var n=null;return e.panelGroups.forEach((function(e){e.panels.forEach((function(e){e.metrics.forEach((function(e){e.metricId===t&&(n=e)}))}))})),n},re=(ee(zt={},"REQUEST_METRICS_DASHBOARD",(function(t){t.emptyState="loading",t.showEmptyState=!0})),ee(zt,"RECEIVE_METRICS_DASHBOARD_SUCCESS",(function(t,e){var n=function(t){var e=t.dashboard,n=void 0===e?"":e,r=t.templating,a=void 0===r?{}:r,i=t.links,o=void 0===i?[]:i,s=t.panel_groups,c=void 0===s?[]:s;return{dashboard:n,variables:I(k(a)),links:o.map(Q),panelGroups:c.map(H)}}(e),r=n.dashboard,a=n.panelGroups,i=n.variables,o=n.links;t.dashboard={dashboard:r,panelGroups:a},t.variables=i,t.links=o,t.dashboard.panelGroups.length||(t.emptyState="noData")})),ee(zt,"RECEIVE_METRICS_DASHBOARD_FAILURE",(function(t,e){t.emptyState=e?"unableToConnect":"noData",t.showEmptyState=!0})),ee(zt,"REQUEST_DASHBOARD_STARRING",(function(t){t.isUpdatingStarredValue=!0})),ee(zt,"RECEIVE_DASHBOARD_STARRING_SUCCESS",(function(t,e){var n=e.selectedDashboard,r=e.newStarredValue,a=t.allDashboards.findIndex((function(t){return t===n}));t.isUpdatingStarredValue=!1,i.default.set(t.allDashboards,a,te(te({},n),{},{starred:r}))})),ee(zt,"RECEIVE_DASHBOARD_STARRING_FAILURE",(function(t){t.isUpdatingStarredValue=!1})),ee(zt,"RECEIVE_DEPLOYMENTS_DATA_SUCCESS",(function(t,e){t.deploymentData=e})),ee(zt,"RECEIVE_DEPLOYMENTS_DATA_FAILURE",(function(t){t.deploymentData=[]})),ee(zt,"REQUEST_ENVIRONMENTS_DATA",(function(t){t.environmentsLoading=!0})),ee(zt,"RECEIVE_ENVIRONMENTS_DATA_SUCCESS",(function(t,e){t.environmentsLoading=!1,t.environments=e})),ee(zt,"RECEIVE_ENVIRONMENTS_DATA_FAILURE",(function(t){t.environmentsLoading=!1,t.environments=[]})),ee(zt,"RECEIVE_ANNOTATIONS_SUCCESS",(function(t,e){t.annotations=e})),ee(zt,"RECEIVE_ANNOTATIONS_FAILURE",(function(t){t.annotations=[]})),ee(zt,"REQUEST_METRIC_RESULT",(function(t,e){var n=e.metricId,r=ne(n,t.dashboard);r.loading=!0,r.result||(r.state=m.s.LOADING)})),ee(zt,"RECEIVE_METRIC_RESULT_SUCCESS",(function(t,e){var n=e.metricId,r=e.result,a=ne(n,t.dashboard);if(a.loading=!1,t.showEmptyState=!1,r&&0!==r.length){var i=r.map(Y);a.state=m.s.OK,a.result=Object.freeze(i)}else a.state=m.s.NO_DATA,a.result=null})),ee(zt,"RECEIVE_METRIC_RESULT_FAILURE",(function(t,e){var n=e.metricId,r=e.error,a=ne(n,t.dashboard);a.state=function(t){if(!t)return m.s.UNKNOWN_ERROR;if(t.message===at.a)return m.s.TIMEOUT;var e=t.response;return e&&e.status===rt.a.SERVICE_UNAVAILABLE?m.s.CONNECTION_FAILED:e&&e.status===rt.a.BAD_REQUEST?m.s.BAD_QUERY:m.s.UNKNOWN_ERROR}(r),a.loading=!1,a.result=null})),ee(zt,"SET_INITIAL_STATE",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.assign(t,Jt()(e,m.n))})),ee(zt,"SET_ENDPOINTS",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.assign(t,Jt()(e,m.l))})),ee(zt,"SET_TIME_RANGE",(function(t,e){t.timeRange=e})),ee(zt,"SET_GETTING_STARTED_EMPTY_STATE",(function(t){t.emptyState="gettingStarted"})),ee(zt,"SET_NO_DATA_EMPTY_STATE",(function(t){t.showEmptyState=!0,t.emptyState="noData"})),ee(zt,"SET_ALL_DASHBOARDS",(function(t,e){t.allDashboards=e||[]})),ee(zt,"SET_SHOW_ERROR_BANNER",(function(t,e){t.showErrorBanner=e})),ee(zt,"SET_PANEL_GROUP_METRICS",(function(t,e){t.dashboard.panelGroups.find((function(t){return e.key===t.key})).panels=e.panels})),ee(zt,"SET_ENVIRONMENTS_FILTER",(function(t,e){t.environmentsSearchTerm=e})),ee(zt,"SET_EXPANDED_PANEL",(function(t,e){var n=e.group,r=e.panel;t.expandedPanel.group=n,t.expandedPanel.panel=r})),ee(zt,"SET_VARIABLES",(function(t,e){t.variables=e})),ee(zt,"UPDATE_VARIABLES",(function(t,e){Object.assign(t.variables[e.key],te(te({},t.variables[e.key]),{},{value:e.value}))})),zt),ae=n("kRJI"),ie=n("DJiL"),oe=function(){return{deploymentsEndpoint:null,dashboardEndpoint:ae.a,dashboardsEndpoint:ae.a,timeRange:null,currentDashboard:null,emptyState:"gettingStarted",showEmptyState:!0,showErrorBanner:!0,isUpdatingStarredValue:!1,dashboard:{panelGroups:[]},expandedPanel:{group:null,panel:null},allDashboards:[],variables:{},links:[],dashboardTimezone:ie.c.LOCAL,annotations:[],deploymentData:[],environments:[],environmentsSearchTerm:"",environmentsLoading:!1,currentEnvironmentName:null,projectPath:null,logsPath:ae.a}};function se(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ce(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?se(Object(n),!0).forEach((function(e){ue(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ue(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}i.default.use(o.b);var le={namespaced:!0,actions:r,getters:a,mutations:re,state:oe},de=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new o.b.Store({modules:{monitoringDashboard:ce(ce({},le),{},{state:ce(ce({},oe()),t)})}})}},BR6W:function(t,e,n){"use strict";n.d(e,"c",(function(){return x})),n.d(e,"a",(function(){return C})),n.d(e,"d",(function(){return I})),n.d(e,"b",(function(){return N})),n.d(e,"f",(function(){return P})),n.d(e,"g",(function(){return R})),n.d(e,"e",(function(){return M}));n("va8A"),n("z4I3"),n("dj/k"),n("kO4A"),n("t3Gg"),n("+kFb"),n("OZM5"),n("x/6R"),n("yaFd"),n("4ql4"),n("8Qi2"),n("+xU6"),n("7WVv"),n("5j0x"),n("zCcL"),n("zpLX"),n("BD5p"),n("MRnW"),n("GzNv"),n("tbvx"),n("Ch9p"),n("+xeR"),n("F1YE"),n("CgWz"),n("Id6h"),n("orcL");var r=n("Q33P"),a=n.n(r),i=n("VNnR"),o=n.n(i),s=n("r7AW"),c=n.n(s),u=n("2Z+u"),l=n.n(u),d=n("a+C/"),f=n.n(d),h=n("GuZl"),p=n("bOix");function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function b(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function g(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?b(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var O=new Date(0),A=function(t){if(1===Object.entries(t).length&&Number.isFinite(t.seconds))return Object(p.r)(t.seconds);throw new Error("Invalid duration: only `seconds` is supported")},S=function(t,e){return new Date(t.getTime()-A(e))},_=function(t,e){return new Date(t.getTime()+A(e))},E=function(t){return Boolean(t&&Number.isFinite(t.seconds))},D=function(t){if("string"!=typeof t||!t.trim())return!1;try{return f()(t,"isoUtcDateTime"),!0}catch(t){return!1}},j=function(t){var e,n,r=t.direction,a=void 0===r?"before":r,i=t.anchorDate,o=t.minDate,s=t.maxDate;return"before"===a?(e=o,n=i):(e=i,n=s),{startDate:e,endDate:n}},T=function(t){var e=t.anchor,n=t.duration,r=t.direction,a=new Date(e),i=j({minDate:S(a,n),maxDate:_(a,n),direction:r,anchorDate:a}),o=i.startDate,s=i.endDate;return{start:o.toISOString(),end:s.toISOString()}},w={invalid:function(){throw new Error("The input range does not have the right format.")},fixed:function(t){return{start:t.start,end:t.end}},anchored:T,rolling:function(t){var e=t.duration,n=t.direction,r=new Date(Date.now());return T({duration:e,direction:n,anchor:r.toISOString()})},open:function(t){var e=t.anchor,n=t.direction,r=new Date(Date.now()),a=j({minDate:O,maxDate:r,direction:n,anchorDate:new Date(e)}),i=a.startDate,o=a.endDate;return{start:i.toISOString(),end:o.toISOString()}}};function x(t){var e=t.start,n=t.end,r=t.anchor,a=t.duration;return!e&&!n||r||a?r&&a?D(r)&&E(a)?h.b.anchored:h.b.invalid:a&&!r?E(a)?h.b.rolling:h.b.invalid:r&&!a&&D(r)?h.b.open:h.b.invalid:D(e)&&D(n)?h.b.fixed:h.b.invalid}var C=function(t){return w[x(t)](t)},k=function(t){var e=l()(t,["start","end","anchor","duration","direction"]);return"before"===e.direction?c()(e,"direction"):e},I=function(t,e){var n=k(t),r=k(e);return o()(n,r)},N=function(t,e){return e.find((function(e){return I(e,t)}))},P=["start","end","anchor","duration_seconds","direction"],R=function(t){var e=k(t);if(t.duration){var n={};Object.keys(t.duration).forEach((function(e){n["duration_".concat(e)]=t.duration[e].toString()})),e=g(g({},n),e),e=c()(e,"duration")}return e},M=function(t){var e=l()(t,P),n=Object.entries(e).reduce((function(t,e){var n=m(e,2),r=n[0],a=n[1];return r.startsWith("duration_")?(t.duration=t.duration||{},t.duration[r.slice("duration_".length)]=parseInt(a,10),t):g(y({},r,a),t)}),{});return n=k(n),a()(n)?null:n}},DJiL:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s}));var r=n("a+C/"),a=n.n(r),i={LOCAL:"LOCAL",UTC:"UTC"},o={shortTime:"h:MM TT",default:"dd mmm yyyy, h:MMTT (Z)"},s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.format,r=void 0===n?o.default:n,s=e.timezone,c=void 0===s?i.LOCAL:s,u=c===i.UTC;return a()(t,r,u)}},FxFN:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("IdsT"),n("S26F");var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return parseInt((t||"").replace(/gid:\/\/gitlab\/.*\//g,""),10)||null}},GuZl:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return i}));var r=1024,a="hidden",i={fixed:"fixed",anchored:"anchored",rolling:"rolling",open:"open",invalid:"invalid"}},JTkt:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));n("va8A"),n("z4I3"),n("dj/k"),n("OZM5"),n("x/6R"),n("4ql4"),n("8Qi2"),n("MRnW"),n("IdsT"),n("GzNv"),n("tbvx"),n("S26F"),n("orcL");function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var i=function(t){var e=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,r){return e+e+n+n+r+r})),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null},o=function(t){var e=r(i(t),3);return e[0]+e[1]+e[2]>500?"#333333":"#FFFFFF"}},QwBj:function(t,e,n){"use strict";n.d(e,"b",(function(){return a}));var r={ABORTED:0,OK:200,CREATED:201,ACCEPTED:202,NON_AUTHORITATIVE_INFORMATION:203,NO_CONTENT:204,RESET_CONTENT:205,PARTIAL_CONTENT:206,MULTI_STATUS:207,ALREADY_REPORTED:208,IM_USED:226,MULTIPLE_CHOICES:300,BAD_REQUEST:400,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,GONE:410,UNPROCESSABLE_ENTITY:422,SERVICE_UNAVAILABLE:503},a=[r.OK,r.CREATED,r.ACCEPTED,r.NON_AUTHORITATIVE_INFORMATION,r.NO_CONTENT,r.RESET_CONTENT,r.PARTIAL_CONTENT,r.MULTI_STATUS,r.ALREADY_REPORTED,r.IM_USED];e.a=r},R9PN:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"s",(function(){return a})),n.d(e,"t",(function(){return i})),n.d(e,"u",(function(){return o})),n.d(e,"j",(function(){return s})),n.d(e,"m",(function(){return c})),n.d(e,"v",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"k",(function(){return d})),n.d(e,"p",(function(){return f})),n.d(e,"q",(function(){return h})),n.d(e,"r",(function(){return p})),n.d(e,"o",(function(){return m})),n.d(e,"l",(function(){return v})),n.d(e,"n",(function(){return b})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return y})),n.d(e,"h",(function(){return O})),n.d(e,"a",(function(){return A})),n.d(e,"d",(function(){return S})),n.d(e,"g",(function(){return _})),n.d(e,"f",(function(){return E}));n("9U97");var r=12e4,a={OK:"OK",LOADING:"LOADING",TIMEOUT:"TIMEOUT",NO_DATA:"NO_DATA",CONNECTION_FAILED:"CONNECTION_FAILED",BAD_QUERY:"BAD_QUERY",UNKNOWN_ERROR:"UNKNOWN_ERROR"},i={AREA_CHART:"area-chart",LINE_CHART:"line-chart",ANOMALY_CHART:"anomaly-chart",SINGLE_STAT:"single-stat",HEATMAP:"heatmap",BAR:"bar",COLUMN:"column",STACKED_COLUMN:"stacked-column"},o=300,s=300,c={annotationsData:"scatter"},u={anomaly:8,default:14},l={default:.2},d={primaryColor:"#1f78d1",anomalySymbol:"#db3b21",anomalyAreaColor:"#1f78d1"},f={default:"solid"},h={default:2},p={GRAFANA:"grafana"},m={inline:"inline",table:"table"},v=["deploymentsEndpoint","dashboardEndpoint","dashboardsEndpoint","currentDashboard","projectPath","logsPath"],b=[].concat(v,["currentEnvironmentName"]),g="NO_DB",y="available",O="path://m5 229 5 8h-10z",A="config/prometheus/common_metrics.yml",S={greaterThan:">",equalTo:"==",lessThan:"<"},_={custom:"custom",text:"text"},E="var-"},RyA9:function(t,e,n){"use strict";n("va8A"),n("9U97"),n("kO4A"),n("+kFb"),n("FMw2"),n("x/6R"),n("gyUR"),n("Z5ek"),n("yaFd"),n("y6Fo"),n("zCcL"),n("zpLX"),n("BD5p"),n("MRnW"),n("N0ZT"),n("QifN"),n("tbvx"),n("Id6h"),n("orcL"),n("pETN");var r=n("osXd"),a=n.n(r),i=n("yi8e"),o=n("kRJI"),s=n("s1D3"),c=n("FkSe"),u=n("DZUU"),l=n("SKUH"),d=n("PDH/"),f=n("c0zC"),h=n("1cpz"),p=n("waGw"),m=n("XqDB"),v=n("LLbv"),b=n("/lV4"),g=n("R9PN"),y=n("CxPQ"),O={data:function(){return{height:g.j}},computed:{svgContainerStyle:function(){return{height:"".concat(this.height,"px")}}},created:function(){this.chartEmptyStateIllustration=y.a}},A=n("tBpV"),S=Object(A.a)(O,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex flex-column justify-content-center"},[e("div",{staticClass:"gl-mt-3 svg-w-100 d-flex align-items-center",style:this.svgContainerStyle,domProps:{innerHTML:this._s(this.chartEmptyStateIllustration)}}),this._v(" "),e("h5",{staticClass:"text-center gl-mt-3"},[this._v(this._s(this.__("No data to display")))])])}),[],!1,null,null,null).exports,_=(n("z4I3"),n("dj/k"),n("OZM5"),n("4ql4"),n("8Qi2"),n("+xU6"),n("GzNv"),n("h7kv")),E=n.n(_),D=n("r7AW"),j=n.n(D),T=n("GTGS"),w=n("MV2A"),x=n("mlng"),C=n("8gQS"),k=n("tu2K"),I=n("bO+A"),N=n("len0"),P=n("gnBj"),R=n("DJiL");function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function L(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var U=[.1,.1],G=P.a.engineering,V=G,z=G,q="category",B="time",$=function(t){var e=t.format,n=t.precision,r=t.name,a=Object(P.b)(e);return{name:r,nameLocation:"center",scale:!0,axisLabel:{formatter:function(t){return a(t,n,8)}}}},Q=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.name,n=void 0===e?Object(b.d)("Metrics|Values"):e,r=t.format,a=void 0===r?V:r,i=t.precision,o=void 0===i?2:i;return L({nameGap:63,scale:!0,boundaryGap:U},$({name:n,format:a,precision:o}))},W=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.timezone,n=void 0===e?R.c.LOCAL:e;return{name:Object(b.a)("Time"),type:B,axisLabel:{formatter:function(t){return Object(R.a)(t,{format:R.b.shortTime,timezone:n})}},axisPointer:{snap:!1}}},H=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.left,n=void 0===e?75:e;return{left:n}},Z=0,Y=3,K={show:!1,min:Z,max:100,axisLabel:{formatter:function(){}}},J=function(t){return t.reduce((function(t,e){return t.lines.push({xAxis:e.startingAt,lineStyle:{color:g.k.primaryColor}}),t.points.push({name:"annotations",xAxis:e.startingAt,yAxis:Z,tooltipData:{title:e.startingAt,content:e.description}}),t}),{lines:[],points:[]})};n("L1PU"),n("5j0x"),n("Ag57"),n("IdsT"),n("S26F");function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){et(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function et(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var at=function(t,e){return function(t,e){if(!t)return"";var n=e[t.toLowerCase().replace(" ","_")];return n?"".concat(t,": ").concat(n):""}(t,e)||function(t,e){return t?(Object.entries(e).map((function(e){var n=nt(e,2),r=n[0],a=n[1],i=new RegExp("{{\\s*".concat(r,"\\s*}}"),"g");t=t.replace(i,a)})),t):""}(t,e)||function(t){return Object.entries(t).map((function(t){var e=nt(t,2),n=e[0],r=e[1];return"".concat(n,": ").concat(r)})).join(", ")}(e)||t},it=function(t,e){return t.map((function(t){var n=t.values.filter((function(t){var e=nt(t,2)[1];return!Number.isNaN(e)}));if(!n.length)return null;var r={data:n};return tt(tt(tt({},e),r),{},{name:at(e.name,t.metric)})})).filter((function(t){return null!==t}))},ot=n("1aG2");function st(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(n),!0).forEach((function(e){dt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function dt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ft=function(t){return new Date(t).toISOString()},ht="datazoom",pt={components:{GlAreaChart:x.a,GlLineChart:C.a,GlTooltip:u.a,GlDeprecatedButton:T.a,GlChartSeriesLabel:k.a,GlLink:w.a,Icon:N.a},directives:{GlResizeObserverDirective:p.a},inheritAttrs:!1,props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!1)},option:{type:Object,required:!1,default:function(){return{}}},seriesConfig:{type:Object,required:!1,default:function(){return{}}},deploymentData:{type:Array,required:!1,default:function(){return[]}},annotations:{type:Array,required:!1,default:function(){return[]}},projectPath:{type:String,required:!1,default:""},height:{type:Number,required:!1,default:g.j},thresholds:{type:Array,required:!1,default:function(){return[]}},legendLayout:{type:String,required:!1,default:g.o.table},legendAverageText:{type:String,required:!1,default:Object(b.d)("Metrics|Avg")},legendCurrentText:{type:String,required:!1,default:Object(b.d)("Metrics|Current")},legendMaxText:{type:String,required:!1,default:Object(b.d)("Metrics|Max")},legendMinText:{type:String,required:!1,default:Object(b.d)("Metrics|Min")},groupId:{type:String,required:!1,default:""},timezone:{type:String,required:!1,default:R.c.LOCAL}},data:function(){return{tooltip:{type:"",title:"",content:[],commitUrl:"",sha:""},width:0,svgs:{},primaryColor:null,throttledDatazoom:null}},computed:{chartData:function(){var t=this;return this.graphData.metrics.reduce((function(e,n){var r=n.appearance,a=r&&r.line&&r.line.type?r.line.type:g.p.default,i=r&&r.line&&r.line.width?r.line.width:g.q.default,o={opacity:r&&r.area&&"number"==typeof r.area.opacity?r.area.opacity:void 0},s=it(n.result||[],lt({name:t.formatLegendLabel(n),lineStyle:{type:a,width:i},showSymbol:!1,areaStyle:"area-chart"===t.graphData.type?o:void 0},t.seriesConfig));return e.concat(s)}),[])},chartOptionSeries:function(){return(this.option.series||[]).concat(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.deployments,n=void 0===e?[]:e,r=t.annotations,a=void 0===r?[]:r,i=n.map((function(t){return{name:"deployments",value:[t.createdAt,Y],symbol:t.icon,symbolSize:g.v.default,itemStyle:{color:t.color},tooltipData:{sha:t.sha.substring(0,8),commitUrl:t.commitUrl}}})),o=J(a),s={symbol:"none",silent:!0,data:o.lines},c={symbol:g.h,symbolSize:"8",symbolOffset:[0," 60%"],data:o.points};return{name:"annotations",type:g.m.annotationsData,yAxisIndex:1,data:i,markLine:s,markPoint:c}}({deployments:this.recentDeployments,annotations:this.annotations}))},chartOptions:function(){var t=this.option,e=t.yAxis,n=t.xAxis,r=j()(this.option,["series","yAxis","xAxis"]),a=lt(lt({},W({timezone:this.timezone})),n),i=lt(lt({},Q(this.graphData.yAxis)),e);return lt({series:this.chartOptionSeries,xAxis:a,yAxis:[i,K],grid:H(),dataZoom:[this.dataZoomConfig]},r)},dataZoomConfig:function(){var t=this.svgs["scroll-handle"];return t?{handleIcon:t}:{}},earliestDatapoint:function(){return this.chartData.reduce((function(t,e){var n=e.data,r=n.length;if(!r)return t;var a=st(n[0],1)[0],i=st(n[r-1],1)[0],o=a<i?a:i;return o<t||null===t?o:t}),null)},glChartComponent:function(){var t;return(dt(t={},g.t.AREA_CHART,x.a),dt(t,g.t.LINE_CHART,C.a),t)[this.graphData.type]||x.a},isMultiSeries:function(){return this.tooltip.content.length>1},recentDeployments:function(){var t=this;return this.deploymentData.reduce((function(e,n){if(n.created_at>=t.earliestDatapoint){var r=n.id,a=n.created_at,i=n.sha,o=n.ref,s=n.tag;e.push({id:r,createdAt:a,sha:i,commitUrl:"".concat(t.projectPath,"/-/commit/").concat(i),tag:s,tagUrl:s?"".concat(t.tagsPath,"/").concat(o.name):null,ref:o.name,showDeploymentFlag:!1,icon:t.svgs.rocket,color:t.primaryColor})}return e}),[])},tooltipYFormatter:function(){var t;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.format,n=void 0===e?z:e,r=t.precision,a=void 0===r?3:r,i=Object(P.b)(n);return function(t){return i(t,a)}}({format:null===(t=this.graphData.yAxis)||void 0===t?void 0:t.format})}},created:function(){this.setSvg("rocket"),this.setSvg("scroll-handle")},destroyed:function(){this.throttledDatazoom&&this.throttledDatazoom.cancel()},methods:{formatLegendLabel:function(t){return t.label},isTooltipOfType:function(t,e){return t===e},formatAnnotationsTooltipText:function(t){var e,n,r,a;return{title:Object(R.a)(null===(e=t.data)||void 0===e?void 0:null===(n=e.tooltipData)||void 0===n?void 0:n.title,{timezone:this.timezone}),content:null===(r=t.data)||void 0===r?void 0:null===(a=r.tooltipData)||void 0===a?void 0:a.content}},formatTooltipText:function(t){var e=this;this.tooltip.title=Object(R.a)(t.value,{timezone:this.timezone}),this.tooltip.content=[],t.seriesData.forEach((function(t){if(t.value){var n=st(t.value,2)[1];if(e.tooltip.type=t.name,"deployments"===e.tooltip.type){var r,a,i=t.data,o=void 0===i?{}:i;e.tooltip.sha=null==o?void 0:null===(r=o.tooltipData)||void 0===r?void 0:r.sha,e.tooltip.commitUrl=null==o?void 0:null===(a=o.tooltipData)||void 0===a?void 0:a.commitUrl}else{var s=t.seriesName,c=t.color,u=t.dataIndex;e.tooltip.content.push({name:s,dataIndex:u,value:e.tooltipYFormatter(n),color:c})}}}))},setSvg:function(t){var e=this;Object(I.a)(t).then((function(n){n&&e.$set(e.svgs,t,"path://".concat(n))})).catch((function(t){console.error("SVG could not be rendered correctly: ",t)}))},onChartUpdated:function(t){var e=st(t.getOption().color,1);this.primaryColor=e[0]},onChartCreated:function(t){var e=this;this.throttledDatazoom&&this.throttledDatazoom.cancel(),this.throttledDatazoom=E()((function(){var n=t.getOption().dataZoom[0],r=n.startValue,a=n.endValue;e.$emit(ht,{start:ft(r),end:ft(a)})}),1e3,{leading:!1}),t.off("datazoom"),t.on("datazoom",this.throttledDatazoom)},onResize:function(){if(this.$refs.chart){var t=this.$refs.chart.$el.getBoundingClientRect().width;this.width=t}}}},mt=Object(A.a)(pt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer-directive",rawName:"v-gl-resize-observer-directive",value:t.onResize,expression:"onResize"}]},[n(t.glChartComponent,t._b({ref:"chart",tag:"component",attrs:{"group-id":t.groupId,data:t.chartData,option:t.chartOptions,"format-tooltip-text":t.formatTooltipText,"format-annotations-tooltip-text":t.formatAnnotationsTooltipText,thresholds:t.thresholds,width:t.width,height:t.height,"legend-layout":t.legendLayout,"legend-average-text":t.legendAverageText,"legend-current-text":t.legendCurrentText,"legend-max-text":t.legendMaxText,"legend-min-text":t.legendMinText},on:{created:t.onChartCreated,updated:t.onChartUpdated}},"component",t.$attrs,!1),["deployments"===t.tooltip.type?[n("template",{slot:"tooltipTitle"},[t._v("\n        "+t._s(t.__("Deployed"))+"\n      ")]),t._v(" "),n("div",{staticClass:"d-flex align-items-center",attrs:{slot:"tooltipContent"},slot:"tooltipContent"},[n("icon",{staticClass:"mr-2",attrs:{name:"commit"}}),t._v(" "),n("gl-link",{attrs:{href:t.tooltip.commitUrl}},[t._v(t._s(t.tooltip.sha))])],1)]:[n("template",{slot:"tooltipTitle"},[n("div",{staticClass:"text-nowrap"},[t._v("\n          "+t._s(t.tooltip.title)+"\n        ")])]),t._v(" "),n("template",{attrs:{tooltip:t.tooltip},slot:"tooltipContent"},t._l(t.tooltip.content,(function(e,r){return n("div",{key:r,staticClass:"d-flex justify-content-between"},[n("gl-chart-series-label",{attrs:{color:t.isMultiSeries?e.color:""}},[t._v("\n            "+t._s(e.name)+"\n          ")]),t._v(" "),n("div",{staticClass:"prepend-left-32"},[t._v("\n            "+t._s(e.value)+"\n          ")])],1)})),0)]],2)],1)}),[],!1,null,null,null).exports,vt=(n("MoW5"),n("6npM")),bt=n.n(vt),gt=n("HCER"),yt=n.n(gt),Ot=n("NmEs"),At=n("JTkt");function St(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?St(Object(n),!0).forEach((function(e){Et(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Et(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dt(t){return function(t){if(Array.isArray(t))return wt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Tt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||Tt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tt(t,e){if(t){if("string"==typeof t)return wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var xt=g.k.anomalyAreaColor,Ct=g.i.default,kt="rgba(".concat(Object(At.a)(xt).join(","),",").concat(Ct,")"),It={components:{GlChartSeriesLabel:k.a,MonitorTimeSeriesChart:mt},inheritAttrs:!1,props:{graphData:{type:Object,required:!0,validator:ot.g}},computed:{series:function(){return this.graphData.metrics.map((function(t){var e=t.result&&t.result[0]?t.result[0].values:[];return{label:t.label,data:e.filter((function(t){var e=jt(t,2)[1];return!Number.isNaN(e)}))}}))},yOffset:function(){var t=yt()(this.series.map((function(t){return t.data.map((function(t){return jt(t,2)[1]}))}))),e=t.length?Math.floor(Math.min.apply(Math,Dt(t))):0;return e<0?-e:0},metricData:function(){var t=this,e=_t({},this.graphData.metrics[0]);return e.result[0].values=e.result[0].values.map((function(e){var n=jt(e,2);return[n[0],n[1]+t.yOffset]})),_t(_t({},this.graphData),{},{type:g.t.LINE_CHART,metrics:[e]})},metricSeriesConfig:function(){var t=this;return{type:"line",symbol:"circle",symbolSize:function(e,n){return t.isDatapointAnomaly(n.dataIndex)?g.v.anomaly:.001},showSymbol:!0,itemStyle:{color:function(e){return t.isDatapointAnomaly(e.dataIndex)?g.k.anomalySymbol:g.k.primaryColor}}}},chartOptions:function(){var t=this,e=jt(this.series,3),n=e[1],r=e[2],a=function(t,e){return t.map((function(t,n){var r=jt(t,2);return[r[0],r[1]+e(n)]}))},i={axisLabel:{formatter:function(e){return Object(Ot.O)(e-t.yOffset,3).toString()}}},o=[];return n.data.length&&r.data.length&&(o.push(this.makeBoundarySeries({name:this.formatLegendLabel(r),data:a(r.data,(function(){return t.yOffset}))})),o.push(this.makeBoundarySeries({name:this.formatLegendLabel(n),data:a(n.data,(function(e){return-t.yValue(2,e)})),areaStyle:{color:xt,opacity:Ct}}))),{yAxis:i,series:o}}},methods:{formatLegendLabel:function(t){return t.label},yValue:function(t,e){var n=this.series[t].data[e];return n&&n[1]},yValueFormatted:function(t,e){var n=this.yValue(t,e);return bt()(n)?n.toFixed(3):""},isDatapointAnomaly:function(t){var e=this.yValue(0,t),n=this.yValue(1,t),r=this.yValue(2,t);return bt()(n)&&e>n||bt()(r)&&e<r},makeBoundarySeries:function(t){return _t({type:"line",stack:"anomaly-boundary-series-stack",lineStyle:{width:0,color:kt},color:kt,symbol:"none"},t)}}},Nt=Object(A.a)(It,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("monitor-time-series-chart",t._b({attrs:{"graph-data":t.metricData,option:t.chartOptions,"series-config":t.metricSeriesConfig},scopedSlots:t._u([{key:"tooltip-content",fn:function(e){return t._l(e.tooltip.content,(function(e,r){return n("div",{key:r,staticClass:"d-flex justify-content-between"},[n("gl-chart-series-label",{attrs:{color:e.color}},[t._v("\n        "+t._s(e.name)+"\n      ")]),t._v(" "),n("div",{staticClass:"prepend-left-32"},[t._v("\n        "+t._s(t.yValueFormatted(r,e.dataIndex))+"\n      ")])],1)}))}}])},"monitor-time-series-chart",t.$attrs,!1),[t._t("default")],2)}),[],!1,null,null,null).exports,Pt=n("W6ad"),Rt={components:{GlSingleStat:Pt.a},inheritAttrs:!1,props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!0)}},computed:{queryInfo:function(){return this.graphData.metrics[0]},queryResult:function(){var t;return null===(t=this.queryInfo.result[0])||void 0===t?void 0:t.value[1]},statValue:function(){var t,e;return(null===(t=this.graphData)||void 0===t?void 0:t.maxValue)?(e=Object(P.b)(P.a.percent))(this.queryResult/Number(this.graphData.maxValue),2):(e=Object(P.b)(P.a.number),"".concat(e(this.queryResult,2)).concat(this.queryInfo.unit))},graphTitle:function(){return this.queryInfo.label}}},Mt=Object(A.a)(Rt,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("gl-single-stat",{attrs:{value:this.statValue,title:this.graphTitle,variant:"success"}})],1)}),[],!1,null,null,null).exports;function Lt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}(t,e)||Ut(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(t){return function(t){if(Array.isArray(t))return Gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Ut(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(t,e){if(t){if("string"==typeof t)return Gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(t,e):void 0}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Vt={components:{GlHeatmap:n("jmGI").a},directives:{GlResizeObserverDirective:p.a},props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!1)},timezone:{type:String,required:!1,default:R.c.LOCAL}},data:function(){return{width:0}},computed:{chartData:function(){return this.metrics.result.reduce((function(t,e,n){return[].concat(Ft(t),Ft(e.values.map((function(t,e){return[n,e,t[1]]}))))}),[])},xAxisName:function(){return this.graphData.x_label||""},yAxisName:function(){return this.graphData.y_label||""},xAxisLabels:function(){return this.metrics.result.map((function(t){return Object.values(t.metric)[0]}))},yAxisLabels:function(){var t=this;return this.result.values.map((function(e){var n=Lt(e,1)[0];return Object(R.a)(new Date(n),{format:R.b.shortTime,timezone:t.timezone})}))},result:function(){return this.metrics.result[0]},metrics:function(){return this.graphData.metrics[0]}},methods:{onResize:function(){if(!this.$refs.heatmapChart){var t=this.$refs.heatmapChart.$el.getBoundingClientRect().width;this.width=t}}}},zt=Object(A.a)(Vt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer-directive",rawName:"v-gl-resize-observer-directive",value:t.onResize,expression:"onResize"}]},[n("gl-heatmap",t._b({ref:"heatmapChart",attrs:{"data-series":t.chartData,"x-axis-name":t.xAxisName,"y-axis-name":t.yAxisName,"x-axis-labels":t.xAxisLabels,"y-axis-labels":t.yAxisLabels,width:t.width}},"gl-heatmap",t.$attrs,!1))],1)}),[],!1,null,null,null).exports;function qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach((function(e){$t(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Qt={components:{GlColumnChart:n("16r0").a},directives:{GlResizeObserverDirective:p.a},props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!1)},timezone:{type:String,required:!1,default:R.c.LOCAL}},data:function(){return{width:0,height:g.j,svgs:{}}},computed:{chartData:function(){var t=this;return{values:this.graphData.metrics.reduce((function(e,n){var r=it(n.result||[],{name:t.formatLegendLabel(n)});return e.concat(r)}),[])[0].data}},chartOptions:function(){var t=W({timezone:this.timezone}),e=Bt(Bt({},Q(this.graphData.yAxis)),{},{scale:!1});return{grid:H(),xAxis:t,yAxis:e,dataZoom:[this.dataZoomConfig]}},xAxisTitle:function(){return void 0!==this.graphData.metrics[0].result[0].x_label?this.graphData.metrics[0].result[0].x_label:""},yAxisTitle:function(){return this.chartOptions.yAxis.name},xAxisType:function(){return void 0!==this.graphData.x_type?this.graphData.x_type:"category"},dataZoomConfig:function(){var t=this.svgs["scroll-handle"];return t?{handleIcon:t}:{}}},created:function(){this.setSvg("scroll-handle")},methods:{formatLegendLabel:function(t){return t.label},onResize:function(){if(this.$refs.columnChart){var t=this.$refs.columnChart.$el.getBoundingClientRect().width;this.width=t}},setSvg:function(t){var e=this;Object(I.a)(t).then((function(n){n&&e.$set(e.svgs,t,"path://".concat(n))})).catch((function(){}))}}},Wt=Object(A.a)(Qt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer-directive",rawName:"v-gl-resize-observer-directive",value:t.onResize,expression:"onResize"}]},[n("gl-column-chart",t._b({ref:"columnChart",attrs:{data:t.chartData,option:t.chartOptions,width:t.width,height:t.height,"x-axis-title":t.xAxisTitle,"y-axis-title":t.yAxisTitle,"x-axis-type":t.xAxisType}},"gl-column-chart",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,Ht={components:{GlBarChart:n("xrTT").a},directives:{GlResizeObserverDirective:p.a},props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!1)}},data:function(){return{width:0,height:g.j,svgs:{}}},computed:{chartData:function(){return Object(ot.a)(this.graphData.metrics)},chartOptions:function(){return{dataZoom:[this.dataZoomConfig]}},xAxisTitle:function(){var t=this.graphData.xLabel;return void 0===t?"":t},yAxisTitle:function(){var t=this.graphData.y_label;return void 0===t?"":t},xAxisType:function(){var t=this.graphData.x_type;return void 0===t?"value":t},dataZoomConfig:function(){var t=this.svgs["scroll-handle"];return t?{handleIcon:t}:{}}},created:function(){this.setSvg("scroll-handle")},methods:{formatLegendLabel:function(t){return t.label},onResize:function(){if(this.$refs.barChart){var t=this.$refs.barChart.$el.getBoundingClientRect().width;this.width=t}},setSvg:function(t){var e=this;Object(I.a)(t).then((function(n){n&&e.$set(e.svgs,t,"path://".concat(n))})).catch((function(t){console.error("SVG could not be rendered correctly: ",t)}))}}},Zt=Object(A.a)(Ht,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer-directive",rawName:"v-gl-resize-observer-directive",value:t.onResize,expression:"onResize"}]},[n("gl-bar-chart",t._b({ref:"barChart",attrs:{data:t.chartData,option:t.chartOptions,width:t.width,height:t.height,"x-axis-title":t.xAxisTitle,"y-axis-title":t.yAxisTitle,"x-axis-type":t.xAxisType}},"gl-bar-chart",t.$attrs,!1))],1)}),[],!1,null,null,null).exports;function Yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(n),!0).forEach((function(e){Jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Xt={components:{GlStackedColumnChart:n("BAbt").a},directives:{GlResizeObserverDirective:p.a},props:{graphData:{type:Object,required:!0,validator:ot.h.bind(null,!1)},timezone:{type:String,required:!1,default:R.c.LOCAL},legendLayout:{type:String,required:!1,default:g.o.table},legendAverageText:{type:String,required:!1,default:Object(b.d)("Metrics|Avg")},legendCurrentText:{type:String,required:!1,default:Object(b.d)("Metrics|Current")},legendMaxText:{type:String,required:!1,default:Object(b.d)("Metrics|Max")},legendMinText:{type:String,required:!1,default:Object(b.d)("Metrics|Min")}},data:function(){return{width:0,height:g.j,svgs:{}}},computed:{chartData:function(){return this.graphData.metrics.map((function(t){var e=t.result;return e&&0!==e.length?e[0].values.map((function(t){return t[1]})):[]}))},xAxisTitle:function(){return void 0!==this.graphData.x_label?this.graphData.x_label:""},yAxisTitle:function(){return void 0!==this.graphData.y_label?this.graphData.y_label:""},xAxisType:function(){return q},groupBy:function(){var t=this.graphData.metrics[0].result;return t&&0!==t.length?t[0].values.map((function(t){return t[0]})):[]},dataZoomConfig:function(){var t=this.svgs["scroll-handle"];return t?{handleIcon:t}:{}},chartOptions:function(){return{xAxis:Kt(Kt({},W({timezone:this.timezone})),{},{type:this.xAxisType}),dataZoom:[this.dataZoomConfig]}},seriesNames:function(){return this.graphData.metrics.map((function(t){return t.label}))}},created:function(){this.setSvg("scroll-handle")},methods:{setSvg:function(t){var e=this;Object(I.a)(t).then((function(n){n&&e.$set(e.svgs,t,"path://".concat(n))})).catch((function(t){console.error("SVG could not be rendered correctly: ",t)}))},onResize:function(){if(this.$refs.chart){var t=this.$refs.chart.$el.getBoundingClientRect().width;this.width=t}}}},te=Object(A.a)(Xt,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer-directive",rawName:"v-gl-resize-observer-directive",value:t.onResize,expression:"onResize"}]},[n("gl-stacked-column-chart",t._b({ref:"chart",attrs:{data:t.chartData,option:t.chartOptions,"x-axis-title":t.xAxisTitle,"y-axis-title":t.yAxisTitle,"x-axis-type":t.xAxisType,"group-by":t.groupBy,width:t.width,height:t.height,"series-names":t.seriesNames,"legend-layout":t.legendLayout,"legend-average-text":t.legendAverageText,"legend-current-text":t.legendCurrentText,"legend-max-text":t.legendMaxText,"legend-min-text":t.legendMinText}},"gl-stacked-column-chart",t.$attrs,!1))],1)}),[],!1,null,null,null).exports,ee=n("yA3Z"),ne=(n("t3Gg"),n("jaBk"),n("B42D")),re=n.n(ne),ae=n("R9Wj"),ie=n.n(ae),oe=n("Lzak"),se=n("30su"),ce=n("XRO8"),ue=n("hJLR"),le=n.n(ue),de=n("Q33P"),fe=n.n(de),he=n("jB52"),pe=n("1fc5"),me=n("l5WF"),ve=n("PrLL"),be=n("Yyc1"),ge=n("wP8z"),ye=n("0KyK"),Oe=n("sHIo");n("vHow");function Ae(t){return Object.keys(t).every((function(e){var n=t[e];return n.alert_path&&e===n.alert_path&&n.metricId&&"string"==typeof n.metricId&&n.operator&&"number"==typeof n.threshold}))}function Se(t){return t.every((function(t){return t.metricId&&"string"==typeof t.metricId&&"string"==typeof t.label}))}he.default.use(ye.a);var _e={create:Object(b.a)("Add"),update:Object(b.a)("Save"),delete:Object(b.a)("Delete")},Ee={create:"btn-success",update:"btn-success",delete:"btn-remove"},De={components:{GlDeprecatedButton:T.a,GlButtonGroup:pe.a,GlFormGroup:me.a,GlFormInput:ve.a,GlDropdown:be.a,GlDropdownItem:ge.a,GlModal:h.a,GlLink:w.a,Icon:N.a},directives:{GlTooltip:v.a,TrackEvent:ee.a},mixins:[Object(Oe.a)()],props:{disabled:{type:Boolean,required:!0},errorMessage:{type:String,required:!1,default:""},configuredAlert:{type:String,required:!1,default:""},alertsToManage:{type:Object,required:!1,default:function(){return{}},validator:Ae},relevantQueries:{type:Array,required:!0,validator:Se},modalId:{type:String,required:!0}},data:function(){return{operators:g.d,operator:null,threshold:null,prometheusMetricId:null,selectedAlert:{},alertQuery:""}},computed:{isValidQuery:function(){return!!this.alertQuery.length||null},currentQuery:function(){var t=this;return this.relevantQueries.find((function(e){return e.metricId===t.prometheusMetricId}))||{}},formDisabled:function(){return this.disabled||!(this.prometheusMetricId||this.isValidQuery)},supportsComputedAlerts:function(){return this.glFeatures.prometheusComputedAlerts},queryDropdownLabel:function(){return this.currentQuery.label||Object(b.d)("PrometheusAlerts|Select query")},haveValuesChanged:function(){return this.operator&&this.threshold===Number(this.threshold)&&(this.operator!==this.selectedAlert.operator||this.threshold!==this.selectedAlert.threshold)},submitAction:function(){return fe()(this.selectedAlert)?"create":this.haveValuesChanged?"update":"delete"},submitActionText:function(){return _e[this.submitAction]},submitButtonClass:function(){return Ee[this.submitAction]},isSubmitDisabled:function(){return this.disabled||"create"===this.submitAction&&!this.haveValuesChanged},dropdownTitle:function(){return"create"===this.submitAction?Object(b.d)("PrometheusAlerts|Add alert"):Object(b.d)("PrometheusAlerts|Edit alert")}},watch:{alertsToManage:function(){this.resetAlertData()},submitAction:function(){this.$emit("setAction",this.submitAction)}},methods:{selectQuery:function(t){var e=le()(this.alertsToManage,(function(e){return e.metricId===t})),n=this.alertsToManage[e];n?(this.selectedAlert=n,this.operator=n.operator,this.threshold=n.threshold):(this.selectedAlert={},this.operator=this.operators.greaterThan,this.threshold=null),this.prometheusMetricId=t},handleHidden:function(){this.resetAlertData(),this.$emit("cancel")},handleSubmit:function(t){t.preventDefault(),this.$emit(this.submitAction,{alert:this.selectedAlert.alert_path,operator:this.operator,threshold:this.threshold,prometheus_metric_id:this.prometheusMetricId})},handleShown:function(){this.configuredAlert?this.selectQuery(this.configuredAlert):1===this.relevantQueries.length&&this.selectQuery(this.relevantQueries[0].metricId)},resetAlertData:function(){this.operator=null,this.threshold=null,this.prometheusMetricId=null,this.selectedAlert={}},getAlertFormActionTrackingOption:function(){var t="".concat(this.submitAction,"_alert");return{category:document.body.dataset.page,action:"click_button",label:t}}},alertQueryText:{label:Object(b.a)("Query"),validFeedback:Object(b.a)("Query is valid"),invalidFeedback:Object(b.a)("Invalid query"),descriptionTooltip:Object(b.a)("Example: Usage = single query. (Requested) / (Capacity) = multiple queries combined into a formula.")}},je=Object(A.a)(De,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("gl-modal",{ref:"alertModal",attrs:{title:t.dropdownTitle,"modal-id":t.modalId,"ok-variant":"delete"===t.submitAction?"danger":"success","ok-disabled":t.formDisabled},on:{ok:t.handleSubmit,hidden:t.handleHidden,shown:t.handleShown},scopedSlots:t._u([{key:"modal-ok",fn:function(){return[n("gl-link",{directives:[{name:"track-event",rawName:"v-track-event",value:t.getAlertFormActionTrackingOption(),expression:"getAlertFormActionTrackingOption()"}],staticClass:"text-reset text-decoration-none"},[t._v("\n      "+t._s(t.submitActionText)+"\n    ")])]},proxy:!0}])},[t.errorMessage?n("div",{staticClass:"alert-modal-message danger_message"},[t._v(t._s(t.errorMessage))]):t._e(),t._v(" "),n("div",{staticClass:"alert-form"},[t.supportsComputedAlerts?n("gl-form-group",{attrs:{label:t.$options.alertQueryText.label,"label-for":"alert-query-input","valid-feedback":t.$options.alertQueryText.validFeedback,"invalid-feedback":t.$options.alertQueryText.invalidFeedback,state:t.isValidQuery},scopedSlots:t._u([{key:"description",fn:function(){return[n("div",{staticClass:"d-flex align-items-center"},[t._v("\n          "+t._s(t.__("Single or combined queries"))+"\n          "),n("icon",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip",value:t.$options.alertQueryText.descriptionTooltip,expression:"$options.alertQueryText.descriptionTooltip"}],staticClass:"gl-ml-2",attrs:{name:"question"}})],1)]},proxy:!0}],null,!1,75640526)},[n("gl-form-input",{attrs:{id:"alert-query-input",state:t.isValidQuery},model:{value:t.alertQuery,callback:function(e){t.alertQuery="string"==typeof e?e.trim():e},expression:"alertQuery"}})],1):n("gl-form-group",{attrs:{"label-for":"alert-query-dropdown",label:t.$options.alertQueryText.label}},[n("gl-dropdown",{attrs:{id:"alert-query-dropdown",text:t.queryDropdownLabel,"toggle-class":"dropdown-menu-toggle qa-alert-query-dropdown"}},t._l(t.relevantQueries,(function(e){return n("gl-dropdown-item",{key:e.metricId,attrs:{"data-qa-selector":"alert_query_option"},on:{click:function(n){return t.selectQuery(e.metricId)}}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1),t._v(" "),n("gl-button-group",{staticClass:"mb-2",attrs:{label:t.s__("PrometheusAlerts|Operator")}},[n("gl-deprecated-button",{class:{active:t.operator===t.operators.greaterThan},attrs:{disabled:t.formDisabled,type:"button"},on:{click:function(e){t.operator=t.operators.greaterThan}}},[t._v("\n        "+t._s(t.operators.greaterThan)+"\n      ")]),t._v(" "),n("gl-deprecated-button",{class:{active:t.operator===t.operators.equalTo},attrs:{disabled:t.formDisabled,type:"button"},on:{click:function(e){t.operator=t.operators.equalTo}}},[t._v("\n        "+t._s(t.operators.equalTo)+"\n      ")]),t._v(" "),n("gl-deprecated-button",{class:{active:t.operator===t.operators.lessThan},attrs:{disabled:t.formDisabled,type:"button"},on:{click:function(e){t.operator=t.operators.lessThan}}},[t._v("\n        "+t._s(t.operators.lessThan)+"\n      ")])],1),t._v(" "),n("gl-form-group",{attrs:{label:t.s__("PrometheusAlerts|Threshold"),"label-for":"alerts-threshold"}},[n("gl-form-input",{attrs:{id:"alerts-threshold",disabled:t.formDisabled,type:"number","data-qa-selector":"alert_threshold_field"},model:{value:t.threshold,callback:function(e){t.threshold=t._n(e)},expression:"threshold"}})],1)],1)])}),[],!1,null,null,null).exports,Te=n("2ibD");function we(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xe=function(){function t(e){var n=e.alertsEndpoint;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.alertsEndpoint=n}var e,n,r;return e=t,(n=[{key:"getAlerts",value:function(){return Te.a.get(this.alertsEndpoint).then((function(t){return t.data}))}},{key:"createAlert",value:function(t){var e=t.prometheus_metric_id,n=t.operator,r=t.threshold;return Te.a.post(this.alertsEndpoint,{prometheus_metric_id:e,operator:n,threshold:r}).then((function(t){return t.data}))}},{key:"readAlert",value:function(t){return Te.a.get(t).then((function(t){return t.data}))}},{key:"updateAlert",value:function(t,e){var n=e.operator,r=e.threshold;return Te.a.put(t,{operator:n,threshold:r}).then((function(t){return t.data}))}},{key:"deleteAlert",value:function(t){return Te.a.delete(t).then((function(t){return t.data}))}}])&&we(e.prototype,n),r&&we(e,r),t}();function Ce(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(n),!0).forEach((function(e){Ie(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ie(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ne={components:{AlertWidgetForm:je,GlBadge:oe.a,GlLoadingIcon:c.a,GlIcon:s.a,GlTooltip:u.a,GlSprintf:se.a},directives:{GlModal:m.a},props:{alertsEndpoint:{type:String,required:!0},showLoadingState:{type:Boolean,required:!1,default:!0},alertsToManage:{type:Object,required:!1,default:function(){return{}},validator:Ae},relevantQueries:{type:Array,required:!0,validator:Se},modalId:{type:String,required:!0}},data:function(){return{service:null,errorMessage:null,isLoading:!1,apiAction:"create"}},i18n:{alertsCountMsg:Object(b.d)("PrometheusAlerts|%{count} alerts applied"),singleFiringMsg:Object(b.d)("PrometheusAlerts|Firing: %{alert}"),multipleFiringMsg:Object(b.d)("PrometheusAlerts|%{firingCount} firing"),firingAlertsTooltip:Object(b.d)("PrometheusAlerts|Firing: %{alerts}")},computed:{singleAlertSummary:function(){return{message:this.isFiring?this.$options.i18n.singleFiringMsg:this.thresholds[0],alert:this.thresholds[0]}},multipleAlertsSummary:function(){return{message:this.isFiring?"".concat(this.$options.i18n.alertsCountMsg,", ").concat(this.$options.i18n.multipleFiringMsg):this.$options.i18n.alertsCountMsg,count:this.thresholds.length,firingCount:this.firingAlerts.length}},shouldShowLoadingIcon:function(){return this.showLoadingState&&this.isLoading},thresholds:function(){return Object.keys(this.alertsToManage).map(this.formatAlertSummary)},hasAlerts:function(){return Boolean(Object.keys(this.alertsToManage).length)},hasMultipleAlerts:function(){return this.thresholds.length>1},isFiring:function(){return Boolean(this.firingAlerts.length)},firingAlerts:function(){var t=this;return ie()(this.alertsToManage).filter((function(e){return t.passedAlertThreshold(t.getQueryData(e),e)}))},formattedFiringAlerts:function(){var t=this;return this.firingAlerts.map((function(e){return t.formatAlertSummary(e.alert_path)}))},configuredAlert:function(){return this.hasAlerts?ie()(this.alertsToManage)[0].metricId:""}},created:function(){this.service=new xe({alertsEndpoint:this.alertsEndpoint}),this.fetchAlertData()},methods:{fetchAlertData:function(){var t=this;this.isLoading=!0;var e=this.relevantQueries.filter((function(t){return t.alert_path}));return Promise.all(e.map((function(e){return t.service.readAlert(e.alert_path).then((function(n){return t.setAlert(n,e.metricId)}))}))).then((function(){t.isLoading=!1})).catch((function(){Object(ce.a)(Object(b.d)("PrometheusAlerts|Error fetching alert")),t.isLoading=!1}))},setAlert:function(t,e){this.$emit("setAlerts",t.alert_path,ke(ke({},t),{},{metricId:e}))},removeAlert:function(t){this.$emit("setAlerts",t,null)},formatAlertSummary:function(t){var e=this.alertsToManage[t],n=this.relevantQueries.find((function(t){return t.metricId===e.metricId}));return"".concat(n.label," ").concat(e.operator," ").concat(e.threshold)},passedAlertThreshold:function(t,e){var n=e.threshold;switch(e.operator){case g.d.greaterThan:return t.some((function(t){return t>n}));case g.d.lessThan:return t.some((function(t){return t<n}));case g.d.equalTo:return t.some((function(t){return t===n}));default:return!1}},getQueryData:function(t){var e=this.relevantQueries.find((function(e){return e.metricId===t.metricId}));return re()(e,"result[0].values",[]).map((function(t){return re()(t,"[1]",null)}))},showModal:function(){this.$root.$emit("bv::show::modal",this.modalId)},hideModal:function(){this.errorMessage=null,this.$root.$emit("bv::hide::modal",this.modalId)},handleSetApiAction:function(t){this.apiAction=t},handleCreate:function(t){var e=this,n=t.operator,r=t.threshold,a=t.prometheus_metric_id,i={operator:n,threshold:r,prometheus_metric_id:a};this.isLoading=!0,this.service.createAlert(i).then((function(t){e.setAlert(t,a),e.isLoading=!1,e.hideModal()})).catch((function(){e.errorMessage=Object(b.d)("PrometheusAlerts|Error creating alert"),e.isLoading=!1}))},handleUpdate:function(t){var e=this,n=t.alert,r={operator:t.operator,threshold:t.threshold};this.isLoading=!0,this.service.updateAlert(n,r).then((function(t){e.setAlert(t,e.alertsToManage[n].metricId),e.isLoading=!1,e.hideModal()})).catch((function(){e.errorMessage=Object(b.d)("PrometheusAlerts|Error saving alert"),e.isLoading=!1}))},handleDelete:function(t){var e=this,n=t.alert;this.isLoading=!0,this.service.deleteAlert(n).then((function(){e.removeAlert(n),e.isLoading=!1,e.hideModal()})).catch((function(){e.errorMessage=Object(b.d)("PrometheusAlerts|Error deleting alert"),e.isLoading=!1}))}}},Pe=Object(A.a)(Ne,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"prometheus-alert-widget dropdown flex-grow-2 overflow-hidden"},[t.shouldShowLoadingIcon?n("gl-loading-icon",{attrs:{inline:!0}}):t.errorMessage?n("span",{ref:"alertErrorMessage",staticClass:"alert-error-message"},[t._v(t._s(t.errorMessage))]):t.hasAlerts?n("span",{ref:"alertCurrentSetting",staticClass:"alert-current-setting cursor-pointer d-flex",on:{click:t.showModal}},[n("gl-badge",{staticClass:"d-flex-center text-truncate",attrs:{variant:t.isFiring?"danger":"neutral"}},[n("gl-icon",{staticClass:"flex-shrink-0",attrs:{name:"warning",size:16}}),t._v(" "),n("span",{staticClass:"text-truncate gl-pl-1-deprecated-no-really-do-not-use-me"},[n("gl-sprintf",{attrs:{message:t.hasMultipleAlerts?t.multipleAlertsSummary.message:t.singleAlertSummary.message},scopedSlots:t._u([{key:"alert",fn:function(){return[t._v("\n            "+t._s(t.singleAlertSummary.alert)+"\n          ")]},proxy:!0},{key:"count",fn:function(){return[t._v("\n            "+t._s(t.multipleAlertsSummary.count)+"\n          ")]},proxy:!0},{key:"firingCount",fn:function(){return[t._v("\n            "+t._s(t.multipleAlertsSummary.firingCount)+"\n          ")]},proxy:!0}])})],1)],1),t._v(" "),t.hasMultipleAlerts&&t.isFiring?n("gl-tooltip",{attrs:{target:function(){return t.$refs.alertCurrentSetting}}},[n("gl-sprintf",{attrs:{message:t.$options.i18n.firingAlertsTooltip},scopedSlots:t._u([{key:"alerts",fn:function(){return t._l(t.formattedFiringAlerts,(function(e){return n("div",{key:e.alert_path},[t._v("\n            "+t._s(e)+"\n          ")])}))},proxy:!0}],null,!1,2717757754)})],1):t._e()],1):t._e(),t._v(" "),n("alert-widget-form",{ref:"widgetForm",attrs:{disabled:t.isLoading,"alerts-to-manage":t.alertsToManage,"relevant-queries":t.relevantQueries,"error-message":t.errorMessage,"configured-alert":t.configuredAlert,"modal-id":t.modalId},on:{create:t.handleCreate,update:t.handleUpdate,delete:t.handleDelete,cancel:t.hideModal,setAction:t.handleSetApiAction}})],1)}),[],!1,null,null,null).exports,Re=n("3twG");function Me(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Me(Object(n),!0).forEach((function(e){Fe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Fe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ue="timerangezoom",Ge="expand",Ve={components:{MonitorEmptyChart:S,AlertWidget:Pe,GlIcon:s.a,GlLoadingIcon:c.a,GlTooltip:u.a,GlDropdown:l.a,GlDropdownItem:d.a,GlDropdownDivider:f.a,GlModal:h.a},directives:{GlResizeObserver:p.a,GlModal:m.a,GlTooltip:v.a,TrackEvent:ee.a},props:{clipboardText:{type:String,required:!1,default:""},graphData:{type:Object,required:!1,default:null},groupId:{type:String,required:!1,default:"dashboard-panel"},namespace:{type:String,required:!1,default:"monitoringDashboard"},alertsEndpoint:{type:String,required:!1,default:null},prometheusAlertsAvailable:{type:Boolean,required:!1,default:!1},settingsPath:{type:String,required:!1,default:null}},data:function(){return{showTitleTooltip:!1,zoomedTimeRange:null,allAlerts:{},expandBtnAvailable:Boolean(this.$listeners[Ge])}},computed:Le(Le({},Object(i.e)({deploymentData:function(t){return t[this.namespace].deploymentData},annotations:function(t){return t[this.namespace].annotations},projectPath:function(t){return t[this.namespace].projectPath},logsPath:function(t){return t[this.namespace].logsPath},timeRange:function(t){return t[this.namespace].timeRange},dashboardTimezone:function(t){return t[this.namespace].dashboardTimezone},metricsSavedToDb:function(t,e){return e["".concat(this.namespace,"/metricsSavedToDb")]},selectedDashboard:function(t,e){return e["".concat(this.namespace,"/selectedDashboard")]}})),{},{title:function(){var t;return(null===(t=this.graphData)||void 0===t?void 0:t.title)||""},graphDataHasResult:function(){var t,e,n,r;return(null===(t=this.graphData)||void 0===t?void 0:null===(e=t.metrics)||void 0===e?void 0:null===(n=e[0])||void 0===n?void 0:null===(r=n.result)||void 0===r?void 0:r.length)>0},graphDataIsLoading:function(){var t;return((null===(t=this.graphData)||void 0===t?void 0:t.metrics)||[]).some((function(t){return t.loading}))},logsPathWithTimeRange:function(){var t=this.zoomedTimeRange||this.timeRange;return this.logsPath&&this.logsPath!==o.a&&t?Object(ot.n)(t,this.logsPath):null},csvText:function(){var t,e=(null===(t=this.graphData)||void 0===t?void 0:t.metrics[0].result[0].values)||[],n=this.graphData.y_label,r="timestamp,".concat(n,"\r\n");return e.reduce((function(t,e){var n=e.join(",");return"".concat(t).concat(n,"\r\n")}),r)},downloadCsv:function(){var t=new Blob([this.csvText],{type:"text/plain"});return window.URL.createObjectURL(t)},basicChartComponent:function(){return this.isPanelType(g.t.SINGLE_STAT)?Mt:this.isPanelType(g.t.HEATMAP)?zt:this.isPanelType(g.t.BAR)?Zt:this.isPanelType(g.t.COLUMN)?Wt:this.isPanelType(g.t.STACKED_COLUMN)?te:this.isPanelType(g.t.ANOMALY_CHART)?Nt:null},timeSeriesChartComponent:function(){return this.isPanelType(g.t.ANOMALY_CHART)?Nt:mt},isContextualMenuShown:function(){return Boolean(this.graphDataHasResult&&!this.basicChartComponent)},editCustomMetricLink:function(){var t;return this.graphData.metrics.length>1?this.settingsPath:null===(t=this.graphData)||void 0===t?void 0:t.metrics[0].edit_path},editCustomMetricLinkText:function(){return Object(b.c)("Metrics|Edit metric","Metrics|Edit metrics",this.graphData.metrics.length)},hasMetricsInDb:function(){var t=this,e=this.graphData.metrics;return(void 0===e?[]:e).some((function(e){var n=e.metricId;return t.metricsSavedToDb.includes(n)}))},alertWidgetAvailable:function(){return this.prometheusAlertsAvailable&&this.alertsEndpoint&&this.graphData&&this.hasMetricsInDb}}),mounted:function(){this.refreshTitleTooltip()},methods:{getGraphAlerts:function(t){if(!this.allAlerts)return{};var e=t.map((function(t){return t.metricId}));return a()(this.allAlerts,(function(t){return e.includes(t.metricId)}))},getGraphAlertValues:function(t){return Object.values(this.getGraphAlerts(t))},isPanelType:function(t){var e;return(null===(e=this.graphData)||void 0===e?void 0:e.type)===t},showToast:function(){this.$toast.show(Object(b.a)("Link copied"))},refreshTitleTooltip:function(){var t=this.$refs.graphTitle;this.showTitleTooltip=Boolean(t)&&t.scrollWidth>t.offsetWidth},downloadCSVOptions:ot.c,generateLinkToChartOptions:ot.e,onResize:function(){this.refreshTitleTooltip()},onDatazoom:function(t){var e=t.start,n=t.end;this.zoomedTimeRange={start:e,end:n},this.$emit(Ue,{start:e,end:n})},onExpand:function(){this.$emit(Ge)},setAlerts:function(t,e){e?this.$set(this.allAlerts,t,e):this.$delete(this.allAlerts,t)},safeUrl:function(t){return Object(Re.l)(t)?t:"#"}},panelTypes:g.t},ze=Object(A.a)(Ve,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"gl-resize-observer",rawName:"v-gl-resize-observer",value:t.onResize,expression:"onResize"}],staticClass:"prometheus-graph"},[n("div",{staticClass:"d-flex align-items-center mr-3"},[t._t("topLeft"),t._v(" "),n("h5",{ref:"graphTitle",staticClass:"prometheus-graph-title gl-font-lg font-weight-bold text-truncate gl-mr-3",attrs:{tabindex:"0"}},[t._v("\n      "+t._s(t.title)+"\n    ")]),t._v(" "),n("gl-tooltip",{attrs:{target:function(){return t.$refs.graphTitle},disabled:!t.showTitleTooltip}},[t._v("\n      "+t._s(t.title)+"\n    ")]),t._v(" "),t.isContextualMenuShown&&t.alertWidgetAvailable?n("alert-widget",{staticClass:"mx-1",attrs:{"modal-id":"alert-modal-"+t.graphData.id,"alerts-endpoint":t.alertsEndpoint,"relevant-queries":t.graphData.metrics,"alerts-to-manage":t.getGraphAlerts(t.graphData.metrics)},on:{setAlerts:t.setAlerts}}):t._e(),t._v(" "),n("div",{staticClass:"flex-grow-1"}),t._v(" "),t.graphDataIsLoading?n("div",{staticClass:"mx-1 mt-1"},[n("gl-loading-icon")],1):t._e(),t._v(" "),t.isContextualMenuShown?n("div",{ref:"contextualMenu",attrs:{"data-qa-selector":"prometheus_graph_widgets"}},[n("div",{staticClass:"d-flex align-items-center"},[n("gl-dropdown",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],attrs:{"toggle-class":"shadow-none border-0","data-qa-selector":"prometheus_widgets_dropdown",right:"",title:t.__("More actions")}},[n("template",{slot:"button-content"},[n("gl-icon",{staticClass:"dropdown-icon text-secondary",attrs:{name:"ellipsis_v"}})],1),t._v(" "),t.expandBtnAvailable?n("gl-dropdown-item",{ref:"expandBtn",attrs:{href:t.clipboardText},on:{click:function(e){return e.preventDefault(),t.onExpand(e)}}},[t._v("\n            "+t._s(t.s__("Metrics|Expand panel"))+"\n          ")]):t._e(),t._v(" "),t.editCustomMetricLink?n("gl-dropdown-item",{ref:"editMetricLink",attrs:{href:t.editCustomMetricLink}},[t._v("\n            "+t._s(t.editCustomMetricLinkText)+"\n          ")]):t._e(),t._v(" "),t.logsPathWithTimeRange?n("gl-dropdown-item",{ref:"viewLogsLink",attrs:{href:t.logsPathWithTimeRange}},[t._v("\n            "+t._s(t.s__("Metrics|View logs"))+"\n          ")]):t._e(),t._v(" "),t.csvText?n("gl-dropdown-item",{directives:[{name:"track-event",rawName:"v-track-event",value:t.downloadCSVOptions(t.title),expression:"downloadCSVOptions(title)"}],ref:"downloadCsvLink",attrs:{href:t.downloadCsv,download:"chart_metrics.csv"}},[t._v("\n            "+t._s(t.__("Download CSV"))+"\n          ")]):t._e(),t._v(" "),t.clipboardText?n("gl-dropdown-item",{directives:[{name:"track-event",rawName:"v-track-event",value:t.generateLinkToChartOptions(t.clipboardText),expression:"generateLinkToChartOptions(clipboardText)"}],ref:"copyChartLink",attrs:{"data-clipboard-text":t.clipboardText,"data-qa-selector":"generate_chart_link_menu_item"},on:{click:function(e){return t.showToast(t.clipboardText)}}},[t._v("\n            "+t._s(t.__("Copy link to chart"))+"\n          ")]):t._e(),t._v(" "),t.alertWidgetAvailable?n("gl-dropdown-item",{directives:[{name:"gl-modal",rawName:"v-gl-modal",value:"alert-modal-"+t.graphData.id,expression:"`alert-modal-${graphData.id}`"}],attrs:{"data-qa-selector":"alert_widget_menu_item"}},[t._v("\n            "+t._s(t.__("Alerts"))+"\n          ")]):t._e(),t._v(" "),t.graphData.links.length?[n("gl-dropdown-divider"),t._v(" "),t._l(t.graphData.links,(function(e,r){return n("gl-dropdown-item",{key:r,staticClass:"text-break",attrs:{href:t.safeUrl(e.url)}},[t._v(t._s(e.title))])}))]:t._e(),t._v(" "),t.selectedDashboard&&t.selectedDashboard.can_edit?[n("gl-dropdown-divider"),t._v(" "),n("gl-dropdown-item",{ref:"manageLinksItem",attrs:{href:t.selectedDashboard.project_blob_path}},[t._v(t._s(t.s__("Metrics|Manage chart links")))])]:t._e()],2)],1)]):t._e()],2),t._v(" "),t.graphDataHasResult?t.basicChartComponent?n(t.basicChartComponent,t._g(t._b({tag:"component",attrs:{"graph-data":t.graphData,timezone:t.dashboardTimezone}},"component",t.$attrs,!1),t.$listeners)):n(t.timeSeriesChartComponent,t._g(t._b({ref:"timeSeriesChart",tag:"component",attrs:{"graph-data":t.graphData,"deployment-data":t.deploymentData,annotations:t.annotations,"project-path":t.projectPath,thresholds:t.getGraphAlertValues(t.graphData.metrics),"group-id":t.groupId,timezone:t.dashboardTimezone},on:{datazoom:t.onDatazoom}},"component",t.$attrs,!1),t.$listeners)):n("monitor-empty-chart")],1)}),[],!1,null,null,null);e.a=ze.exports},"bO+A":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("htNe"),a=n.n(r),i=n("2ibD"),o=a()((function(){return i.a.get(gon.sprite_icons).then((function(t){var e=t.data;return(new DOMParser).parseFromString(e,"text/xml")})).catch((function(t){throw o.cache.clear(),t}))})),s=function(t){return o().then((function(e){return e.querySelector("#".concat(t," path")).getAttribute("d")})).catch((function(){return null}))}},gnBj:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return f}));var r=n("oIb9"),a=n("/lV4");n("9U97"),n("Z5ek"),n("4ql4"),n("+xU6"),n("L1PU");function i(t,e){var n=e.fractionDigits,r=void 0===n?void 0:n,a=e.valueFactor,i=void 0===a?1:a,o=e.style,s=void 0===o?void 0:o,c=e.maxLength,u=void 0===c?void 0:c;if(null===t)return"";var l=t*i,d=l.toLocaleString(void 0,{minimumFractionDigits:r,maximumFractionDigits:r,style:s});return void 0!==u&&d.length>u?l.toExponential(2):d}var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return 0===e?new RangeError("unitFactor cannot have the value 0."):function(n,r){if(null===n)return"";if(n===Number.NEGATIVE_INFINITY||n===Number.POSITIVE_INFINITY||Number.isNaN(n))return n.toLocaleString(void 0);for(var a=n,o=0,s=t.length;Math.abs(a)>=e;)if(a/=e,(o+=1)>=s)return"NA";var c=t[o];return"".concat(i(a,{fractionDigits:r})).concat(c)}},s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decimal",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n,r,a){return"".concat(i(n,{fractionDigits:r,maxLength:a,valueFactor:e,style:t}))}},c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(n,r,a){var o=void 0!==a?a-t.length:void 0;return"".concat(i(n,{fractionDigits:r,maxLength:o,valueFactor:e})).concat(t)}},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["y","z","a","f","p","n","","m"],r=["k","M","G","T","P","E","Z","Y"],a=[].concat(n,[""],r),i=a.slice(n.length+e).map((function(e){return"".concat(e).concat(t)}));if(!i.length)throw new RangeError("The unit cannot be converted, please try a different scale");return o(i)},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],r=[""].concat(n),a=r.slice(e).map((function(e){return"".concat(e).concat(t)}));if(!a.length)throw new RangeError("The unit cannot be converted, please try a different scale");return o(a,1024)},d={number:"number",percent:"percent",percentHundred:"percentHundred",seconds:"seconds",milliseconds:"milliseconds",decimalBytes:"decimalBytes",kilobytes:"kilobytes",megabytes:"megabytes",gigabytes:"gigabytes",terabytes:"terabytes",petabytes:"petabytes",bytes:"bytes",kibibytes:"kibibytes",mebibytes:"mebibytes",gibibytes:"gibibytes",tebibytes:"tebibytes",pebibytes:"pebibytes",engineering:"engineering"},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.engineering;if(t===d.number)return s();if(t===d.percent)return s("percent");if(t===d.percentHundred)return s("percent",.01);if(t===d.seconds)return c(Object(a.d)("Units|s"));if(t===d.milliseconds)return c(Object(a.d)("Units|ms"));if(t===d.decimalBytes)return u("B");if(t===d.kilobytes)return u("B",1);if(t===d.megabytes)return u("B",2);if(t===d.gigabytes)return u("B",3);if(t===d.terabytes)return u("B",4);if(t===d.petabytes)return u("B",5);if(t===d.bytes)return l("B");if(t===d.kibibytes)return l("B",1);if(t===d.mebibytes)return l("B",2);if(t===d.gibibytes)return l("B",3);if(t===d.tebibytes)return l("B",4);if(t===d.pebibytes)return l("B",5);if(t===d.engineering)return r.a;throw TypeError("".concat(t," is not a valid number format"))}},kRJI:function(t,e,n){"use strict";e.a="https://invalid"},kcAi:function(t,e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getAnnotations"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"environmentName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dashboardPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"startingFrom"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Time"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"environments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"environmentName"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"metricsDashboard"},arguments:[{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"dashboardPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"annotations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"startingFrom"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"startingAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"endingAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"panelId"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:522}};n.loc.source={body:"query getAnnotations(\n  $projectPath: ID!\n  $environmentName: String\n  $dashboardPath: String!\n  $startingFrom: Time!\n) {\n  project(fullPath: $projectPath) {\n    environments(name: $environmentName) {\n      nodes {\n        id\n        name\n        metricsDashboard(path: $dashboardPath) {\n          annotations(from: $startingFrom) {\n            nodes {\n              id\n              description\n              startingAt\n              endingAt\n              panelId\n            }\n          }\n        }\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};function a(t,e){for(var n=0;n<t.definitions.length;n++){var r=t.definitions[n];if(r.name&&r.name.value==e)return r}}n.definitions.forEach((function(t){if(t.name){var e=new Set;!function t(e,n){if("FragmentSpread"===e.kind)n.add(e.name.value);else if("VariableDefinition"===e.kind){var r=e.type;"NamedType"===r.kind&&n.add(r.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){t(e,n)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){t(e,n)})),e.definitions&&e.definitions.forEach((function(e){t(e,n)}))}(t,e),r[t.name.value]=e}})),t.exports=n,t.exports.getAnnotations=function(t,e){var n={kind:t.kind,definitions:[a(t,e)]};t.hasOwnProperty("loc")&&(n.loc=t.loc);var i=r[e]||new Set,o=new Set,s=new Set;for(i.forEach((function(t){s.add(t)}));s.size>0;){var c=s;s=new Set,c.forEach((function(t){o.has(t)||(o.add(t),(r[t]||new Set).forEach((function(t){s.add(t)})))}))}return o.forEach((function(e){var r=a(t,e);r&&n.definitions.push(r)})),n}(n,"getAnnotations")},sHIo:function(t,e,n){"use strict";e.a=function(){return{inject:{glFeatures:{from:"glFeatures",default:function(){return{}}}}}}},yA3Z:function(t,e,n){"use strict";var r=n("4ZIW");e.a={bind:function(t,e){t.dataset.trackingOptions=JSON.stringify(e.value||{}),t.addEventListener("click",(function(){var e=JSON.parse(t.dataset.trackingOptions),n=e.category,a=e.action,i=e.label,o=e.property,s=e.value;n&&a&&r.a.event(n,a,{label:i,property:o,value:s})}))},update:function(t,e){e.value!==e.oldValue&&(t.dataset.trackingOptions=JSON.stringify(e.value||{}))}}}}]);
//# sourceMappingURL=gfm_metrics.37488c77.chunk.js.map