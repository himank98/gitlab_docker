(this.webpackJsonp=this.webpackJsonp||[]).push([[87],{"00Gr":function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateNoteInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"note"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:184}};t.loc.source={body:'#import "../fragments/designNote.fragment.graphql"\n\nmutation updateNote($input: UpdateNoteInput!) {\n  updateNote(input: $input) {\n    note {\n      ...DesignNote\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("YatT").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.updateNote=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"updateNote")},AVOg:function(e,n,i){"use strict";var t,o=i("ZfjD"),s=i("MEJ2").f,a=i("KG2+"),r=i("1005"),l=i("R6g9"),d=i("MkVI"),c=i("PpKG"),u="".endsWith,m=Math.min,f=d("endsWith");o({target:"String",proto:!0,forced:!!(c||f||(t=s(String.prototype,"endsWith"),!t||t.writable))&&!f},{endsWith:function(e){var n=String(l(this));r(e);var i=arguments.length>1?arguments[1]:void 0,t=a(n.length),o=void 0===i?t:m(a(i),t),s=String(e);return u?u.call(n,s,o):n.slice(o-s.length,o)===s}})},DAN1:function(e,n,i){var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DesignItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Design"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignListItem"},directives:[]},{kind:"Field",name:{kind:"Name",value:"fullPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"diffRefs"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignDiffRefs"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"discussions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"replyId"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ResolvedStatus"},directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:436}};t.loc.source={body:'#import "./designNote.fragment.graphql"\n#import "./designList.fragment.graphql"\n#import "./diffRefs.fragment.graphql"\n#import "./discussion_resolved_status.fragment.graphql"\n\nfragment DesignItem on Design {\n  ...DesignListItem\n  fullPath\n  diffRefs {\n    ...DesignDiffRefs\n  }\n  discussions {\n    nodes {\n      id\n      replyId\n      ...ResolvedStatus\n      notes {\n        nodes {\n          ...DesignNote\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};function s(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)}))}t.definitions=t.definitions.concat(s(i("YatT").definitions)),t.definitions=t.definitions.concat(s(i("QqLJ").definitions)),t.definitions=t.definitions.concat(s(i("RWzC").definitions)),t.definitions=t.definitions.concat(s(i("Z+Gl").definitions)),e.exports=t},F1YE:function(e,n,i){"use strict";var t=i("ZfjD"),o=i("qR60");t({target:"String",proto:!0,forced:i("262j")("anchor")},{anchor:function(e){return o(this,"a","name",e)}})},F875:function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"activeDiscussion"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activeDiscussion"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"source"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:78}};i.loc.source={body:"query activeDiscussion {\n  activeDiscussion @client {\n    id\n    source\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function o(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),t[e.name.value]=n}})),e.exports=i,e.exports.activeDiscussion=function(e,n){var i={kind:e.kind,definitions:[o(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var s=t[n]||new Set,a=new Set,r=new Set;for(s.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(n){var t=o(e,n);t&&i.definitions.push(t)})),i}(i,"activeDiscussion")},Il0J:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"uploadDesign"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"files"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Upload"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designManagementUpload"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"projectPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}},{kind:"ObjectField",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}},{kind:"ObjectField",name:{kind:"Name",value:"files"},value:{kind:"Variable",name:{kind:"Name",value:"files"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designs"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignItem"},directives:[]},{kind:"Field",name:{kind:"Name",value:"versions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sha"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"skippedDesigns"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:424}};t.loc.source={body:'#import "../fragments/design.fragment.graphql"\n\nmutation uploadDesign($files: [Upload!]!, $projectPath: ID!, $iid: ID!) {\n  designManagementUpload(input: { projectPath: $projectPath, iid: $iid, files: $files }) {\n    designs {\n      ...DesignItem\n      versions {\n        edges {\n          node {\n            id\n            sha\n          }\n        }\n      },\n    }\n    skippedDesigns {\n      filename\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("DAN1").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.uploadDesign=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"uploadDesign")},Js4L:function(e,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DesignNotePermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotePermissions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminNote"},arguments:[],directives:[]}]}}],loc:{start:0,end:66}};i.loc.source={body:"fragment DesignNotePermissions on NotePermissions {\n  adminNote\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i},KDRr:function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"projectFullPath"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"projectPath"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]},{kind:"Field",name:{kind:"Name",value:"issueIid"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]}]}}],loc:{start:0,end:67}};i.loc.source={body:"query projectFullPath {\n  projectPath @client\n  issueIid @client\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function o(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),t[e.name.value]=n}})),e.exports=i,e.exports.projectFullPath=function(e,n){var i={kind:e.kind,definitions:[o(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var s=t[n]||new Set,a=new Set,r=new Set;for(s.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(n){var t=o(e,n);t&&i.definitions.push(t)})),i}(i,"projectFullPath")},Mj8U:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CreateNoteInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"note"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:184}};t.loc.source={body:'#import "../fragments/designNote.fragment.graphql"\n\nmutation createNote($input: CreateNoteInput!) {\n  createNote(input: $input) {\n    note {\n      ...DesignNote\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("YatT").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.createNote=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"createNote")},Nqqk:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"destroyDesign"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filenames"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"projectPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designManagementDelete"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"projectPath"},value:{kind:"Variable",name:{kind:"Name",value:"projectPath"}}},{kind:"ObjectField",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}},{kind:"ObjectField",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"filenames"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VersionListItem"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:289}};t.loc.source={body:'#import "../fragments/version.fragment.graphql"\n\nmutation destroyDesign($filenames: [String!]!, $projectPath: ID!, $iid: ID!) {\n  designManagementDelete(input: { projectPath: $projectPath, iid: $iid, filenames: $filenames }) {\n    version {\n      ...VersionListItem\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("yU3k").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.destroyDesign=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"destroyDesign")},QqLJ:function(e,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DesignListItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Design"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"event"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notesCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"imageV432x230"},arguments:[],directives:[]}]}}],loc:{start:0,end:99}};i.loc.source={body:"fragment DesignListItem on Design {\n  id\n  event\n  filename\n  notesCount\n  image\n  imageV432x230\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i},RWzC:function(e,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DesignDiffRefs"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DiffRefs"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseSha"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"startSha"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"headSha"},arguments:[],directives:[]}]}}],loc:{start:0,end:71}};i.loc.source={body:"fragment DesignDiffRefs on DiffRefs {\n  baseSha\n  startSha\n  headSha\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i},XmZ7:function(e,n){var i={kind:"Document",definitions:[{kind:"ObjectTypeDefinition",name:{kind:"Name",value:"ActiveDiscussion"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"id"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]},{kind:"FieldDefinition",name:{kind:"Name",value:"source"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Query"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"activeDiscussion"},arguments:[],type:{kind:"NamedType",name:{kind:"Name",value:"ActiveDiscussion"}},directives:[]}]},{kind:"ObjectTypeExtension",name:{kind:"Name",value:"Mutation"},interfaces:[],directives:[],fields:[{kind:"FieldDefinition",name:{kind:"Name",value:"updateActiveDiscussion"},arguments:[{kind:"InputValueDefinition",name:{kind:"Name",value:"id"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"InputValueDefinition",name:{kind:"Name",value:"source"},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}},directives:[]}]}],loc:{start:0,end:198}};i.loc.source={body:"type ActiveDiscussion {\n  id: ID\n  source: String\n}\n\nextend type Query {\n  activeDiscussion: ActiveDiscussion\n}\n\nextend type Mutation {\n  updateActiveDiscussion(id: ID!, source: String!): Boolean\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i},XqDB:function(e,n,i){"use strict";i.d(n,"a",(function(){return g}));var t=i("Mm9T"),o=i("o/E4"),s=i("QXXq"),a=i("BrvI"),r=i("7bmO"),l="__bv_modal_directive__",d=function(e){var n=e.modifiers,i=void 0===n?{}:n,t=e.arg,o=e.value;return Object(a.i)(o)?o:Object(a.i)(t)?t:Object(r.j)(i).reverse()[0]},c=function(e){return e&&Object(o.p)(e,".dropdown-menu > li, li.nav-item")&&Object(o.v)("a, button",e)||e},u=function(e){e&&"BUTTON"!==e.tagName&&(Object(o.k)(e,"role")||Object(o.x)(e,"role","button"),"A"===e.tagName||Object(o.k)(e,"tabindex")||Object(o.x)(e,"tabindex","0"))},m=function(e){var n=e[l]||{},i=n.trigger,t=n.handler;i&&t&&(Object(s.c)(i,"click",t,s.b),Object(s.c)(i,"keydown",t,s.b),Object(s.c)(e,"click",t,s.b),Object(s.c)(e,"keydown",t,s.b)),delete e[l]},f=function(e,n,i){var a=e[l]||{},r=d(n),f=c(e);r===a.target&&f===a.trigger||(m(e),function(e,n,i){var a=d(n),r=c(e);if(a&&r){var m=function(e){var n=e.currentTarget;if(!Object(o.m)(n)){var s=e.type,r=e.keyCode;"click"!==s&&("keydown"!==s||r!==t.a.ENTER&&r!==t.a.SPACE)||i.context.$root.$emit("bv::show::modal",a,n)}};e[l]={handler:m,target:a,trigger:r},u(r),Object(s.d)(r,"click",m,s.b),"BUTTON"!==r.tagName&&"button"===Object(o.e)(r,"role")&&Object(s.d)(r,"keydown",m,s.b)}}(e,n,i)),u(f)},g={inserted:f,updated:function(){},componentUpdated:f,unbind:m}},YatT:function(e,n,i){var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DesignNote"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Note"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"author"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Author"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"body"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bodyHtml"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolved"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"diffRefs"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignDiffRefs"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"userPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNotePermissions"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"discussion"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:427}};t.loc.source={body:'#import "./diffRefs.fragment.graphql"\n#import "~/graphql_shared/fragments/author.fragment.graphql"\n#import "./note_permissions.fragment.graphql"\n\nfragment DesignNote on Note {\n  id\n  author {\n    ...Author\n  }\n  body\n  bodyHtml\n  createdAt\n  resolved\n  position {\n    diffRefs {\n      ...DesignDiffRefs\n    }\n    x\n    y\n    height\n    width\n  }\n  userPermissions {\n    ...DesignNotePermissions\n  }\n  discussion {\n    id\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};function s(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)}))}t.definitions=t.definitions.concat(s(i("RWzC").definitions)),t.definitions=t.definitions.concat(s(i("5JsC").definitions)),t.definitions=t.definitions.concat(s(i("Js4L").definitions)),e.exports=t},"Z+Gl":function(e,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ResolvedStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Discussion"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolvable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolved"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolvedAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolvedBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:118}};i.loc.source={body:"fragment ResolvedStatus on Discussion {\n  resolvable\n  resolved\n  resolvedAt\n  resolvedBy {\n    name\n    webUrl\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i},aOF2:function(e,n,i){"use strict";var t=i("/Szx"),o=i("lgrP"),s=i("o/E4"),a={css:!0,enterClass:"",enterActiveClass:"collapsing",enterToClass:"collapse show",leaveClass:"collapse show",leaveActiveClass:"collapsing",leaveToClass:"collapse"},r={enter:function(e){e.style.height=0,Object(s.u)((function(){Object(s.q)(e),e.style.height="".concat(e.scrollHeight,"px")}))},afterEnter:function(e){e.style.height=null},leave:function(e){e.style.height="auto",e.style.display="block",e.style.height="".concat(Object(s.f)(e).height,"px"),Object(s.q)(e),e.style.height=0},afterLeave:function(e){e.style.height=null}},l=t.a.extend({name:"BVCollapse",functional:!0,props:{appear:{type:Boolean,default:!1}},render:function(e,n){var i=n.props,t=n.data,s=n.children;return e("transition",Object(o.a)(t,{props:a,on:r},{props:i}),s)}}),d=i("EGlP"),c=i("QXXq"),u=i("DXSV"),m=i("6iM1"),f=i("EQ0+"),g=(i("NSGy"),i("7bmO"),t.a.extend({name:"BCollapse",mixins:[u.a,m.a,f.a],model:{prop:"visible",event:"input"},props:{isNav:{type:Boolean,default:!1},accordion:{type:String},visible:{type:Boolean,default:!1},tag:{type:String,default:"div"},appear:{type:Boolean,default:!1}},data:function(){return{show:this.visible,transitioning:!1}},computed:{classObject:function(){return{"navbar-collapse":this.isNav,collapse:!this.transitioning,show:this.show&&!this.transitioning}}},watch:{visible:function(e){e!==this.show&&(this.show=e)},show:function(e,n){e!==n&&this.emitState()}},created:function(){this.show=this.visible},mounted:function(){var e=this;this.show=this.visible,this.listenOnRoot("bv::toggle::collapse",this.handleToggleEvt),this.listenOnRoot("bv::collapse::accordion",this.handleAccordionEvt),this.isNav&&(this.setWindowEvents(!0),this.handleResize()),this.$nextTick((function(){e.emitState()})),this.listenOnRoot("bv::request::collapse::state",(function(n){n===e.safeId()&&e.$nextTick(e.emitSync)}))},updated:function(){this.emitSync()},deactivated:function(){this.isNav&&this.setWindowEvents(!1)},activated:function(){this.isNav&&this.setWindowEvents(!0),this.emitSync()},beforeDestroy:function(){this.show=!1,this.isNav&&d.g&&this.setWindowEvents(!1)},methods:{setWindowEvents:function(e){Object(c.e)(e,window,"resize",this.handleResize,c.a),Object(c.e)(e,window,"orientationchange",this.handleResize,c.a)},toggle:function(){this.show=!this.show},onEnter:function(){this.transitioning=!0,this.$emit("show")},onAfterEnter:function(){this.transitioning=!1,this.$emit("shown")},onLeave:function(){this.transitioning=!0,this.$emit("hide")},onAfterLeave:function(){this.transitioning=!1,this.$emit("hidden")},emitState:function(){this.$emit("input",this.show),this.emitOnRoot("bv::collapse::state",this.safeId(),this.show),this.accordion&&this.show&&this.emitOnRoot("bv::collapse::accordion",this.safeId(),this.accordion)},emitSync:function(){this.emitOnRoot("bv::collapse::sync::state",this.safeId(),this.show)},checkDisplayBlock:function(){var e=Object(s.l)(this.$el,"show");Object(s.s)(this.$el,"show");var n="block"===Object(s.h)(this.$el).display;return e&&Object(s.b)(this.$el,"show"),n},clickHandler:function(e){var n=e.target;this.isNav&&n&&"block"===Object(s.h)(this.$el).display&&(Object(s.p)(n,".nav-link,.dropdown-item")||Object(s.c)(".nav-link,.dropdown-item",n))&&(this.checkDisplayBlock()||(this.show=!1))},handleToggleEvt:function(e){e===this.safeId()&&this.toggle()},handleAccordionEvt:function(e,n){this.accordion&&n===this.accordion&&(e===this.safeId()?this.show||this.toggle():this.show&&this.toggle())},handleResize:function(){this.show="block"===Object(s.h)(this.$el).display}},render:function(e){var n=this,i={visible:this.show,close:function(){return n.show=!1}},t=e(this.tag,{class:this.classObject,directives:[{name:"show",value:this.show}],attrs:{id:this.safeId()},on:{click:this.clickHandler}},[this.normalizeSlot("default",i)]);return e(l,{props:{appear:this.appear},on:{enter:this.onEnter,afterEnter:this.onAfterEnter,leave:this.onLeave,afterLeave:this.onAfterLeave}},[t])}})),v=i("Pyw5");const p={components:{BCollapse:g},model:{prop:"visible",event:"input"}};const h=i.n(v)()({render:function(){var e=this.$createElement;return(this._self._c||e)("b-collapse",this._g(this._b({},"b-collapse",this.$attrs,!1),this.$listeners),[this._t("default")],2)},staticRenderFns:[]},void 0,p,void 0,!1,void 0,!1,void 0,void 0,void 0);n.a=h},cfjj:function(e,n,i){var t=i("aEqC");e.exports=function(e){return function(n){return null==e?void 0:t(e,n)}}},emAI:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateImageDiffNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"UpdateImageDiffNoteInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateImageDiffNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"note"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}}]}}]}}],loc:{start:0,end:211}};t.loc.source={body:'#import "../fragments/designNote.fragment.graphql"\n\nmutation updateImageDiffNote($input: UpdateImageDiffNoteInput!) {\n  updateImageDiffNote(input: $input) {\n    errors\n    note {\n      ...DesignNote\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("YatT").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.updateImageDiffNote=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"updateImageDiffNote")},gS9Y:function(e,n,i){"use strict";i.r(n);i("8Qi2");var t=i("3a3M"),o=i.n(t),s=i("jB52"),a=(i("va8A"),i("z4I3"),i("dj/k"),i("OZM5"),i("x/6R"),i("4ql4"),i("MRnW"),i("GzNv"),i("tbvx"),i("orcL"),i("lRsd")),r=(i("kO4A"),i("FMw2"),i("Z5ek"),i("y6Fo"),i("QifN"),i("FkSe")),l=i("dsWN"),d=i("GTGS"),c=i("XRO8"),u=i("/lV4"),m=i("LLbv"),f={mimetype:"image/*",regex:/image\/.+/},g="pin",v="discussion",p=["design-detail-layout","overflow-hidden","m-0"],h={components:{GlDeprecatedButton:d.a,GlLoadingIcon:r.a},directives:{GlTooltip:m.a},props:{isSaving:{type:Boolean,required:!0}},methods:{openFileUpload:function(){this.$refs.fileUpload.click()},onFileUploadChange:function(e){this.$emit("upload",e.target.files)}},VALID_DESIGN_FILE_MIMETYPE:f},k=i("tBpV"),b=Object(k.a)(h,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",[i("gl-deprecated-button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:e.s__("DesignManagement|Adding a design with the same filename replaces the file in a new version."),disabled:e.isSaving,variant:"success"},on:{click:e.openFileUpload}},[e._v("\n    "+e._s(e.s__("DesignManagement|Upload designs"))+"\n    "),e.isSaving?i("gl-loading-icon",{staticClass:"ml-1",attrs:{inline:""}}):e._e()],1),e._v(" "),i("input",{ref:"fileUpload",staticClass:"hide",attrs:{type:"file",name:"design_file",accept:e.$options.VALID_DESIGN_FILE_MIMETYPE.mimetype,multiple:""},on:{change:e.onFileUploadChange}})],1)}),[],!1,null,null,null).exports,y=i("o4PY"),D=i.n(y),S=i("1cpz"),N=i("XqDB"),w={name:"DeleteButton",components:{GlDeprecatedButton:d.a,GlModal:S.a},directives:{GlModalDirective:N.a},props:{isDeleting:{type:Boolean,required:!1,default:!1},buttonClass:{type:String,required:!1,default:""},buttonVariant:{type:String,required:!1,default:""},hasSelectedDesigns:{type:Boolean,required:!1,default:!0}},data:function(){return{modalId:D()("design-deletion-confirmation-")}}},_=Object(k.a)(w,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",[i("gl-modal",{attrs:{"modal-id":e.modalId,title:e.s__("DesignManagement|Delete designs confirmation"),"ok-title":e.s__("DesignManagement|Delete"),"ok-variant":"danger"},on:{ok:function(n){return e.$emit("deleteSelectedDesigns")}}},[i("p",[e._v(e._s(e.s__("DesignManagement|Are you sure you want to delete the selected designs?")))])]),e._v(" "),i("gl-deprecated-button",{directives:[{name:"gl-modal-directive",rawName:"v-gl-modal-directive",value:e.modalId,expression:"modalId"}],class:e.buttonClass,attrs:{variant:e.buttonVariant,disabled:e.isDeleting||!e.hasSelectedDesigns}},[e._t("default")],2)],1)}),[],!1,null,null,null).exports,O=(i("+xU6"),i("ehHk")),P=i("s1D3"),j=i("len0"),C=i("Fsq/"),E="design",x={components:{GlLoadingIcon:r.a,GlIntersectionObserver:O.a,GlIcon:P.a,Icon:j.a,Timeago:C.a},props:{id:{type:[Number,String],required:!0},event:{type:String,required:!0},notesCount:{type:Number,required:!0},image:{type:String,required:!0},filename:{type:String,required:!0},updatedAt:{type:String,required:!1,default:null},isUploading:{type:Boolean,required:!1,default:!0},imageV432x230:{type:String,required:!1,default:null}},data:function(){return{imageLoading:!0,imageError:!1,wasInView:!1}},computed:{icon:function(){var e=this.event.toLowerCase(),n={creation:{name:"file-addition-solid",classes:"text-success-500",tooltip:Object(u.a)("Added in this version")},modification:{name:"file-modified-solid",classes:"text-primary-500",tooltip:Object(u.a)("Modified in this version")},deletion:{name:"file-deletion-solid",classes:"text-danger-500",tooltip:Object(u.a)("Deleted in this version")}};return n[e]?n[e]:{}},notesLabel:function(){return Object(u.c)("%d comment","%d comments",this.notesCount)},imageLink:function(){return this.wasInView?this.imageV432x230||this.image:""},showLoadingSpinner:function(){return this.imageLoading||this.isUploading},showImageErrorIcon:function(){return this.wasInView&&this.imageError},showImage:function(){return!this.showLoadingSpinner&&!this.showImageErrorIcon}},methods:{onImageLoad:function(){this.imageLoading=!1,this.imageError=!1},onImageError:function(){this.imageLoading=!1,this.imageError=!0},onAppear:function(){this.wasInView||(this.wasInView=!0,this.imageLoading=!0)}},DESIGN_ROUTE_NAME:E},F=Object(k.a)(x,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("router-link",{staticClass:"card cursor-pointer text-plain js-design-list-item design-list-item",attrs:{to:{name:e.$options.DESIGN_ROUTE_NAME,params:{id:e.filename},query:e.$route.query}}},[i("div",{staticClass:"card-body p-0 d-flex-center overflow-hidden position-relative"},[e.icon.name?i("div",{staticClass:"design-event position-absolute"},[i("span",{attrs:{title:e.icon.tooltip,"aria-label":e.icon.tooltip}},[i("icon",{class:e.icon.classes,attrs:{name:e.icon.name,size:18}})],1)]):e._e(),e._v(" "),i("gl-intersection-observer",{on:{appear:e.onAppear}},[e.showLoadingSpinner?i("gl-loading-icon",{attrs:{size:"md"}}):e.showImageErrorIcon?i("gl-icon",{staticClass:"text-secondary",attrs:{name:"media-broken",size:32}}):e._e(),e._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:e.showImage,expression:"showImage"}],staticClass:"block mx-auto mw-100 mh-100 design-img",attrs:{src:e.imageLink,alt:e.filename,"data-qa-selector":"design_image"},on:{load:e.onImageLoad,error:e.onImageError}})],1)],1),e._v(" "),i("div",{staticClass:"card-footer d-flex w-100"},[i("div",{staticClass:"d-flex flex-column str-truncated-100"},[i("span",{staticClass:"bold str-truncated-100",attrs:{"data-qa-selector":"design_file_name"}},[e._v(e._s(e.filename))]),e._v(" "),e.updatedAt?i("span",{staticClass:"str-truncated-100"},[e._v("\n        "+e._s(e.__("Updated"))+" "),i("timeago",{attrs:{time:e.updatedAt,"tooltip-placement":"bottom"}})],1):e._e()]),e._v(" "),e.notesCount?i("div",{staticClass:"ml-auto d-flex align-items-center text-secondary"},[i("icon",{staticClass:"ml-1",attrs:{name:"comments"}}),e._v(" "),i("span",{staticClass:"ml-1",attrs:{"aria-label":e.notesLabel}},[e._v("\n        "+e._s(e.notesCount)+"\n      ")])],1):e._e()])])}),[],!1,null,null,null).exports,I=i("GiFX"),V=i("xs3K"),T=i.n(V),q=i("Nqqk"),$=i.n(q);i("9U97"),i("t3Gg"),i("+kFb"),i("yaFd"),i("zCcL"),i("zpLX"),i("BD5p"),i("Id6h"),i("IdsT"),i("l9AF");function A(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function M(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?A(Object(i),!0).forEach((function(n){R(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):A(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function R(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var L=function(e){return(e.type.match(f.regex)||[]).length>0},B=function(e){return e.nodes.map((function(e,n){return M(M({},e),{},{index:n+1,notes:e.notes.nodes})}))},U=function(e,n){return e.nodes.find((function(e){return e.id===n}))},G=function(e){return(e.match("::Version/(.+$)")||[])[1]},z=function(e){var n;return null===(n=(function(e){return e.project.issue.designCollection.designs.edges}(e)||[])[0])||void 0===n?void 0:n.node},Q=function(e){return{__typename:"Mutation",designManagementUpload:{__typename:"DesignManagementUploadPayload",designs:e.map((function(e){return{__typename:"Design",id:-D()(),image:"",imageV432x230:"",filename:e.name,fullPath:"",notesCount:0,event:"NONE",diffRefs:{__typename:"DiffRefs",baseSha:"",startSha:"",headSha:""},discussions:{__typename:"DesignDiscussion",nodes:[]},versions:{__typename:"DesignVersionConnection",edges:{__typename:"DesignVersionEdge",node:{__typename:"DesignVersion",id:-D()(),sha:-D()()}}}}})),skippedDesigns:[],errors:[]}}},W=function(e,n){var i=n.position;return{__typename:"Mutation",updateImageDiffNote:{__typename:"UpdateImageDiffNotePayload",note:M(M({},e),{},{position:M(M({},e.position),i)}),errors:[]}}},Y=function(e){return e.edges.map((function(e){var n,i=e.node;return M(M({},n=i),{},{web_url:n.webUrl,avatar_url:n.avatarUrl})}))},H=function(){return document.querySelector(".layout-page")},X=(i("gyUR"),Object(u.d)("DesignManagement|Could not add a new comment. Please try again.")),K=Object(u.d)("DesignManagement|Could not create new discussion. Please try again."),Z=Object(u.d)("DesignManagement|Could not update discussion. Please try again."),J=Object(u.d)("DesignManagement|Could not update note. Please try again."),ee=Object(u.d)("DesignManagement|Error uploading a new design. Please try again."),ne=Object(u.a)("Could not upload your designs as one or more files uploaded are not supported."),ie=Object(u.a)("Could not find design."),te=Object(u.a)("Requested design version does not exist."),oe=Object(u.d)("DesignManagement|Upload skipped."),se="".concat(oe," ").concat(Object(u.d)("The designs you tried uploading did not change.")),ae=Object(u.a)("You can only upload one design when dropping onto an existing design."),re=Object(u.a)("You must upload a file with the same file name when dropping onto an existing design."),le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.singular,i=void 0===n||n,t=i?Object(u.a)("a design"):Object(u.a)("designs");return Object(u.e)(Object(u.d)("Could not delete %{design}. Please try again."),{design:t})},de=function(e,n){if(0===n.length)return null;if(n.length===e.length){var i=n[0].filename;return Object(u.c)(function(e){return"".concat(oe," ").concat(Object(u.e)(Object(u.d)("DesignManagement|%{filename} did not change."),{filename:e}))}(i),se,n.length)}return function(e){var n="".concat(oe," ").concat(Object(u.d)("Some of the designs you tried uploading did not change:")),i=Object(u.e)(Object(u.d)("DesignManagement|and %{moreCount} more."),{moreCount:e.length-5});return"".concat(n," ").concat(e.slice(0,5).map((function(e){return e.filename})).join(", ")).concat(e.length>5?", ".concat(i):".")}(n)};function ce(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function ue(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?ce(Object(i),!0).forEach((function(n){me(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ce(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function me(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function fe(e){return function(e){if(Array.isArray(e))return ge(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return ge(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ge(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ge(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,t=new Array(n);i<n;i++)t[i]=e[i];return t}var ve=function(e,n){throw Object(c.a)(n),new Error(e.errors)},pe=function(e){var n=e.errors,i=void 0===n?[]:n;return null==i?void 0:i.length},he=function(e,n,i,t){pe(n)?ve(n,le({singular:1===t.length})):(function(e,n,i){var t=e.readQuery(n),o=t.project.issue.designCollection.designs.edges.filter((function(e){var n=e.node;return!i.includes(n.filename)}));t.project.issue.designCollection.designs.edges=fe(o),e.writeQuery(ue(ue({},n),{},{data:t}))}(e,i,t),function(e,n,i){if(i){var t=e.readQuery(n),o={node:i,__typename:"DesignVersionEdge"};t.project.issue.designCollection.versions.edges=[o].concat(fe(t.project.issue.designCollection.versions.edges)),e.writeQuery(ue(ue({},n),{},{data:t}))}}(e,i,n.version))},ke=function(e,n,i,t,o){pe(n)?ve(n,X):function(e,n,i,t,o){var s=e.readQuery({query:i,variables:t}),a=z(s),r=U(a.discussions,o);r.notes.nodes=[].concat(fe(r.notes.nodes),[n.note]),a.notesCount+=1,a.issue.participants.edges.some((function(e){return e.node.username===n.note.author.username}))||(a.issue.participants.edges=[].concat(fe(a.issue.participants.edges),[{__typename:"UserEdge",node:ue({__typename:"User"},n.note.author)}])),e.writeQuery({query:i,variables:t,data:ue(ue({},s),{},{design:ue({},a)})})}(e,n,i,t,o)},be=function(e,n,i,t){pe(n)?ve(n,K):function(e,n,i,t){var o=e.readQuery({query:i,variables:t}),s={__typename:"Discussion",id:n.note.discussion.id,replyId:n.note.discussion.replyId,resolvable:!0,resolved:!1,resolvedAt:null,resolvedBy:null,notes:{__typename:"NoteConnection",nodes:[n.note]}},a=z(o),r=a.notesCount+1;a.discussions.nodes=[].concat(fe(a.discussions.nodes),[s]),a.issue.participants.edges.some((function(e){return e.node.username===n.note.author.username}))||(a.issue.participants.edges=[].concat(fe(a.issue.participants.edges),[{__typename:"UserEdge",node:ue({__typename:"User"},n.note.author)}])),e.writeQuery({query:i,variables:t,data:ue(ue({},o),{},{design:ue(ue({},a),{},{notesCount:r})})})}(e,n,i,t)},ye=function(e,n,i,t){pe(n)?ve(n,Z):function(e,n,i,t){var o=e.readQuery({query:i,variables:t}),s=z(o),a=U(s.discussions,n.note.discussion.id);a.notes=ue(ue({},a.notes),{},{nodes:[n.note].concat(fe(a.notes.nodes.slice(1)))}),e.writeQuery({query:i,variables:t,data:ue(ue({},o),{},{design:s})})}(e,n,i,t)},De=function(e,n,i){pe(n)?ve(n,n.errors[0]):function(e,n,i){var t,o=e.readQuery(i),s=o.project.issue.designCollection.designs.edges.reduce((function(e,n){return e.find((function(e){return e.filename===n.node.filename}))||e.push(n.node),e}),n.designs),a=n.designs.find((function(e){return e.versions}));if(a){var r=a.versions.edges;r&&r.length&&(t=[r[0]])}var l=[].concat(fe(t||[]),fe(o.project.issue.designCollection.versions.edges)),d={__typename:"DesignCollection",designs:{__typename:"DesignConnection",edges:s.map((function(e){return{__typename:"DesignEdge",node:e}}))},versions:{__typename:"DesignVersionConnection",edges:l}};o.project.issue.designCollection=d,e.writeQuery(ue(ue({},i),{},{data:o}))}(e,n,i)},Se={components:{ApolloMutation:I.a},props:{filenames:{type:Array,required:!0},projectPath:{type:String,required:!0},iid:{type:String,required:!0}},computed:{projectQueryBody:function(){return{query:T.a,variables:{fullPath:this.projectPath,iid:this.iid,atVersion:null}}}},methods:{updateStoreAfterDelete:function(e,n){var i=n.data.designManagementDelete;he(e,i,this.projectQueryBody,this.filenames)}},destroyDesignMutation:$.a},Ne=Object(k.a)(Se,(function(){var e=this,n=e.$createElement;return(e._self._c||n)("apollo-mutation",e._g({attrs:{mutation:e.$options.destroyDesignMutation,variables:{filenames:e.filenames,projectPath:e.projectPath,iid:e.iid},update:e.updateStoreAfterDelete},scopedSlots:e._u([{key:"default",fn:function(n){var i=n.mutate,t=n.loading,o=n.error;return[e._t("default",null,null,{mutate:i,loading:t,error:o})]}}],null,!0)},e.$listeners))}),[],!1,null,null,null).exports,we=(i("8pn6"),i("Yyc1")),_e=i("wP8z"),Oe=(i("AVOg"),i("KDRr")),Pe=i.n(Oe),je={apollo:{appData:{query:Pe.a,manual:!0,result:function(e){var n=e.data,i=n.projectPath,t=n.issueIid;this.projectPath=i,this.issueIid=t}},allVersions:{query:T.a,variables:function(){return{fullPath:this.projectPath,iid:this.issueIid,atVersion:null}},update:function(e){return e.project.issue.designCollection.versions.edges}}},computed:{hasValidVersion:function(){var e=this;return this.$route.query.version&&this.allVersions&&this.allVersions.some((function(n){return n.node.id.endsWith(e.$route.query.version)}))},designsVersion:function(){return this.hasValidVersion?"gid://gitlab/DesignManagement::Version/".concat(this.$route.query.version):null},latestVersionId:function(){var e=this.allVersions[0];return e&&G(e.node.id)},isLatestVersion:function(){return!(this.allVersions.length>0)||(!this.$route.query.version||!this.latestVersionId||this.$route.query.version===this.latestVersionId)}},data:function(){return{allVersions:[],projectPath:"",issueIid:null}}},Ce={components:{GlDropdown:we.a,GlDropdownItem:_e.a},mixins:[je],computed:{queryVersion:function(){return this.$route.query.version},currentVersionIdx:function(){var e=this;if(!this.queryVersion)return 0;var n=this.allVersions.findIndex((function(n){return e.findVersionId(n.node.id)===e.queryVersion}));return-1!==n?n:0},currentVersionId:function(){if(this.queryVersion)return this.queryVersion;var e=this.allVersions[this.currentVersionIdx];return this.findVersionId(e.node.id)},dropdownText:function(){if(this.isLatestVersion)return Object(u.a)("Showing Latest Version");var e=this.allVersions.length-this.currentVersionIdx;return Object(u.e)(Object(u.a)("Showing Version #%{versionNumber}"),{versionNumber:e})}},methods:{findVersionId:G}},Ee=Object(k.a)(Ce,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("gl-dropdown",{staticClass:"design-version-dropdown",attrs:{text:e.dropdownText,variant:"link"}},e._l(e.allVersions,(function(n,t){return i("gl-dropdown-item",{key:n.node.id},[i("router-link",{staticClass:"d-flex js-version-link",attrs:{to:{path:e.$route.path,query:{version:e.findVersionId(n.node.id)}}}},[i("div",{staticClass:"flex-grow-1 ml-2"},[i("div",[i("strong",[e._v(e._s(e.__("Version"))+" "+e._s(e.allVersions.length-t)+"\n            "),e.findVersionId(n.node.id)===e.latestVersionId?i("span",[e._v("("+e._s(e.__("latest"))+")")]):e._e()])])]),e._v(" "),e.findVersionId(n.node.id)===e.currentVersionId?i("i",{staticClass:"fa fa-check pull-right"}):e._e()])],1)})),1)}),[],!1,null,null,null).exports,xe=(i("vHow"),i("MV2A")),Fe=i("30su"),Ie=i("Il0J"),Ve=i.n(Ie),Te={components:{GlIcon:P.a,GlLink:xe.a,GlSprintf:Fe.a},data:function(){return{dragCounter:0,isDragDataValid:!1}},computed:{dragging:function(){return 0!==this.dragCounter}},methods:{isValidUpload:function(e){return e.every(L)},isValidDragDataType:function(e){var n=e.dataTransfer;return Boolean(n&&n.types.some((function(e){return"Files"===e})))},ondrop:function(e){var n=e.dataTransfer,i=void 0===n?{}:n;if(this.dragCounter=0,this.isDragDataValid){var t=i.files;this.isValidUpload(Array.from(t))?this.$emit("change",t):Object(c.a)(ne)}},ondragenter:function(e){this.dragCounter+=1,this.isDragDataValid=this.isValidDragDataType(e)},ondragleave:function(){this.dragCounter-=1},openFileUpload:function(){this.$refs.fileUpload.click()},onDesignInputChange:function(e){this.$emit("change",e.target.files)}},uploadDesignMutation:Ve.a,VALID_DESIGN_FILE_MIMETYPE:f},qe=Object(k.a)(Te,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"w-100 position-relative",on:{dragstart:function(e){e.preventDefault(),e.stopPropagation()},dragend:function(e){e.preventDefault(),e.stopPropagation()},dragover:function(e){e.preventDefault(),e.stopPropagation()},dragenter:function(n){return n.preventDefault(),n.stopPropagation(),e.ondragenter(n)},dragleave:function(n){return n.preventDefault(),n.stopPropagation(),e.ondragleave(n)},drop:function(n){return n.preventDefault(),n.stopPropagation(),e.ondrop(n)}}},[e._t("default",[i("button",{staticClass:"card design-dropzone-card design-dropzone-border w-100 h-100 d-flex-center p-3",on:{click:e.openFileUpload}},[i("div",{staticClass:"d-flex-center flex-column text-center"},[i("gl-icon",{staticClass:"mb-4",attrs:{name:"doc-new",size:48}}),e._v(" "),i("p",[i("gl-sprintf",{attrs:{message:e.__("%{lineOneStart}Drag and drop to upload your designs%{lineOneEnd} or %{linkStart}click to upload%{linkEnd}.")},scopedSlots:e._u([{key:"lineOne",fn:function(n){var t=n.content;return[i("span",{staticClass:"d-block"},[e._v(e._s(t))])]}},{key:"link",fn:function(n){var t=n.content;return[i("gl-link",{staticClass:"h-100 w-100",on:{click:function(n){return n.stopPropagation(),e.openFileUpload(n)}}},[e._v(e._s(t))])]}}])})],1)],1)]),e._v(" "),i("input",{ref:"fileUpload",staticClass:"hide",attrs:{type:"file",name:"design_file",accept:e.$options.VALID_DESIGN_FILE_MIMETYPE.mimetype,multiple:""},on:{change:e.onDesignInputChange}})]),e._v(" "),i("transition",{attrs:{name:"design-dropzone-fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.dragging,expression:"dragging"}],staticClass:"card design-dropzone-border design-dropzone-overlay w-100 h-100 position-absolute d-flex-center p-3 bg-white"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!e.isDragDataValid,expression:"!isDragDataValid"}],staticClass:"mw-50 text-center"},[i("h3",[e._v(e._s(e.__("Oh no!")))]),e._v(" "),i("span",[e._v(e._s(e.__("You are trying to upload something other than an image. Please upload a .png, .jpg, .jpeg, .gif, .bmp, .tiff or .ico.")))])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.isDragDataValid,expression:"isDragDataValid"}],staticClass:"mw-50 text-center"},[i("h3",[e._v(e._s(e.__("Incoming!")))]),e._v(" "),i("span",[e._v(e._s(e.__("Drop your designs to start your upload.")))])])])])],2)}),[],!1,null,null,null).exports,$e=i("mnqm"),Ae=i.n($e),Me=(i("S26F"),i("cfjj")),Re=i.n(Me),Le={mixins:[je],apollo:{designs:{query:T.a,variables:function(){return{fullPath:this.projectPath,iid:this.issueIid,atVersion:this.designsVersion}},update:function(e){var n=Re()(e)(["project","issue","designCollection","designs"]);return n?n.edges.map((function(e){return e.node})):[]},error:function(){this.error=!0},result:function(){this.$route.query.version&&!this.hasValidVersion&&(Object(c.a)(Object(u.d)("DesignManagement|Requested design version does not exist. Showing latest version instead")),this.$router.replace({name:"designs",query:{version:void 0}}))}}},data:function(){return{designs:[],error:!1}}},Be=i("O4Ih"),Ue={components:{GlLoadingIcon:r.a,GlAlert:l.a,GlDeprecatedButton:d.a,UploadButton:b,Design:F,DesignDestroyer:Ne,DesignVersionDropdown:Ee,DeleteButton:_,DesignDropzone:qe},mixins:[Le],apollo:{permissions:{query:Ae.a,variables:function(){return{fullPath:this.projectPath,iid:this.issueIid}},update:function(e){return e.project.issue.userPermissions}}},data:function(){return{permissions:{createDesign:!1},filesToBeSaved:[],selectedDesigns:[]}},computed:{isLoading:function(){return this.$apollo.queries.designs.loading||this.$apollo.queries.permissions.loading},isSaving:function(){return this.filesToBeSaved.length>0},canCreateDesign:function(){return this.permissions.createDesign},showToolbar:function(){return this.canCreateDesign&&this.allVersions.length>0},hasDesigns:function(){return this.designs.length>0},hasSelectedDesigns:function(){return this.selectedDesigns.length>0},canDeleteDesigns:function(){return this.isLatestVersion&&this.hasSelectedDesigns},projectQueryBody:function(){return{query:T.a,variables:{fullPath:this.projectPath,iid:this.issueIid,atVersion:null}}},selectAllButtonText:function(){return this.hasSelectedDesigns?Object(u.d)("DesignManagement|Deselect all"):Object(u.d)("DesignManagement|Select all")}},mounted:function(){this.toggleOnPasteListener(this.$route.name)},methods:{resetFilesToBeSaved:function(){this.filesToBeSaved=[]},isValidDesignUpload:function(e){return!!this.canCreateDesign&&(!(e.length>10)||(Object(c.a)(Object(u.e)(Object(u.d)("DesignManagement|The maximum number of designs allowed to be uploaded is %{upload_limit}. Please try again."),{upload_limit:10})),!1))},onUploadDesign:function(e){var n=this;if(this.filesToBeSaved=Array.from(e),!this.isValidDesignUpload(this.filesToBeSaved))return null;var i={optimisticResponse:Q(this.filesToBeSaved),variables:{files:this.filesToBeSaved,projectPath:this.projectPath,iid:this.issueIid},context:{hasUpload:!0},mutation:Ve.a,update:this.afterUploadDesign};return this.$apollo.mutate(i).then((function(e){return n.onUploadDesignDone(e)})).catch((function(){return n.onUploadDesignError()}))},afterUploadDesign:function(e,n){var i=n.data.designManagementUpload;De(e,i,this.projectQueryBody)},onUploadDesignDone:function(e){var n,i,t=(null==e?void 0:null===(n=e.data)||void 0===n?void 0:null===(i=n.designManagementUpload)||void 0===i?void 0:i.skippedDesigns)||[],o=de(this.filesToBeSaved,t);o&&Object(c.a)(o,"warning"),this.isLatestVersion||this.$router.push({name:"designs"}),this.resetFilesToBeSaved()},onUploadDesignError:function(){this.resetFilesToBeSaved(),Object(c.a)(ee)},changeSelectedDesigns:function(e){this.isDesignSelected(e)?this.selectedDesigns=this.selectedDesigns.filter((function(n){return n!==e})):this.selectedDesigns.push(e)},toggleDesignsSelection:function(){this.hasSelectedDesigns?this.selectedDesigns=[]:this.selectedDesigns=this.designs.map((function(e){return e.filename}))},isDesignSelected:function(e){return this.selectedDesigns.includes(e)},isDesignToBeSaved:function(e){return this.filesToBeSaved.some((function(n){return n.name===e}))},canSelectDesign:function(e){return this.isLatestVersion&&this.canCreateDesign&&!this.isDesignToBeSaved(e)},onDesignDelete:function(){this.selectedDesigns=[],this.$route.query.version&&this.$router.push({name:"designs"})},onDesignDeleteError:function(){var e=le({singular:1===this.selectedDesigns.length});Object(c.a)(e)},onExistingDesignDropzoneChange:function(e,n){var i=Array.from(e);i.length>1?Object(c.a)(ae):i.some((function(e){var i=e.name;return n===i}))?this.onUploadDesign(e):Object(c.a)(re)},onDesignPaste:function(e){var n=e.clipboardData,i=Array.from(n.files);if(n&&i.length>0){if(!i.some(L))return;e.preventDefault();var t=Object(Be.b)(e);t&&"image.png"!==t||(t="design_".concat(Date.now(),".png"));var o=new File([i[0]],t);this.onUploadDesign([o])}},toggleOnPasteListener:function(e){"designs"===e?document.addEventListener("paste",this.onDesignPaste):document.removeEventListener("paste",this.onDesignPaste)}},beforeRouteUpdate:function(e,n,i){this.toggleOnPasteListener(e.name),this.selectedDesigns=[],i()},beforeRouteLeave:function(e,n,i){this.toggleOnPasteListener(e.name),i()}},Ge=Object(k.a)(Ue,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",[e.showToolbar?i("header",{staticClass:"row-content-block border-top-0 p-2 d-flex"},[i("div",{staticClass:"d-flex justify-content-between align-items-center w-100"},[i("design-version-dropdown"),e._v(" "),i("div",{class:["qa-selector-toolbar",{"d-flex":e.hasDesigns,"d-none":!e.hasDesigns}]},[e.isLatestVersion?i("gl-deprecated-button",{staticClass:"mr-2 js-select-all",attrs:{variant:"link"},on:{click:e.toggleDesignsSelection}},[e._v(e._s(e.selectAllButtonText))]):e._e(),e._v(" "),i("design-destroyer",{attrs:{filenames:e.selectedDesigns,"project-path":e.projectPath,iid:e.issueIid},on:{done:e.onDesignDelete,error:e.onDesignDeleteError},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.mutate,o=n.loading;return[e.isLatestVersion?i("delete-button",{attrs:{"is-deleting":o,"button-class":"btn-danger btn-inverted mr-2","has-selected-designs":e.hasSelectedDesigns},on:{deleteSelectedDesigns:function(e){return t()}}},[e._v("\n            "+e._s(e.s__("DesignManagement|Delete selected"))+"\n            "),o?i("gl-loading-icon",{staticClass:"ml-1",attrs:{inline:""}}):e._e()],1):e._e()]}}],null,!1,2992247550)}),e._v(" "),e.canCreateDesign?i("upload-button",{attrs:{"is-saving":e.isSaving},on:{upload:e.onUploadDesign}}):e._e()],1)],1)]):e._e(),e._v(" "),i("div",{staticClass:"mt-4"},[e.isLoading?i("gl-loading-icon",{attrs:{size:"md"}}):e.error?i("gl-alert",{attrs:{variant:"danger",dismissible:!1}},[e._v("\n      "+e._s(e.__("An error occurred while loading designs. Please try again."))+"\n    ")]):i("ol",{staticClass:"list-unstyled row"},[i("li",{staticClass:"col-md-6 col-lg-4 mb-3"},[i("design-dropzone",{staticClass:"design-list-item",on:{change:e.onUploadDesign}})],1),e._v(" "),e._l(e.designs,(function(n){return i("li",{key:n.id,staticClass:"col-md-6 col-lg-4 mb-3"},[i("design-dropzone",{on:{change:function(i){return e.onExistingDesignDropzoneChange(i,n.filename)}}},[i("design",e._b({attrs:{"is-uploading":e.isDesignToBeSaved(n.filename)}},"design",n,!1))],1),e._v(" "),e.canSelectDesign(n.filename)?i("input",{staticClass:"design-checkbox",attrs:{type:"checkbox"},domProps:{checked:e.isDesignSelected(n.filename)},on:{change:function(i){return e.changeSelectedDesigns(n.filename)}}}):e._e()],1)}))],2)],1),e._v(" "),i("router-view",{key:e.$route.fullPath})],1)}),[],!1,null,null,null).exports,ze=(i("+xeR"),i("t6Yz")),Qe=i.n(ze),We=i("5v28"),Ye=i("5QKO"),He={components:{Icon:j.a},props:{design:{type:Object,required:!1,default:null},title:{type:String,required:!0},iconName:{type:String,required:!0}},computed:{designLink:function(){return this.design?{name:E,params:{id:this.design.filename},query:this.$route.query}:{}}}},Xe={components:{PaginationButton:Object(k.a)(He,(function(){var e=this.$createElement,n=this._self._c||e;return n("router-link",{staticClass:"btn btn-default",class:{disabled:!this.design},attrs:{to:this.designLink,disabled:!this.design,"aria-label":this.title}},[n("icon",{attrs:{name:this.iconName}})],1)}),[],!1,null,null,null).exports},mixins:[Le],props:{id:{type:String,required:!0}},computed:{designsCount:function(){return this.designs.length},currentIndex:function(){var e=this;return this.designs.findIndex((function(n){return n.filename===e.id}))},paginationText:function(){return Object(u.e)(Object(u.d)("DesignManagement|%{current_design} of %{designs_count}"),{current_design:this.currentIndex+1,designs_count:this.designsCount})},previousDesign:function(){return this.designsCount?this.designs[this.currentIndex-1]:null},nextDesign:function(){return this.designsCount?this.designs[this.currentIndex+1]:null}},mounted:function(){var e=this;Mousetrap.bind("left",(function(){return e.navigateToDesign(e.previousDesign)})),Mousetrap.bind("right",(function(){return e.navigateToDesign(e.nextDesign)}))},beforeDestroy:function(){Mousetrap.unbind(["left","right"],this.navigateToDesign)},methods:{navigateToDesign:function(e){e&&this.$router.push({name:E,params:{id:e.filename},query:this.$route.query})}}},Ke=Object(k.a)(Xe,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return e.designsCount?i("div",{staticClass:"d-flex align-items-center"},[e._v("\n  "+e._s(e.paginationText)+"\n  "),i("div",{staticClass:"btn-group ml-3 mr-3"},[i("pagination-button",{staticClass:"js-previous-design",attrs:{design:e.previousDesign,title:e.s__("DesignManagement|Go to previous design"),"icon-name":"angle-left"}}),e._v(" "),i("pagination-button",{staticClass:"js-next-design",attrs:{design:e.nextDesign,title:e.s__("DesignManagement|Go to next design"),"icon-name":"angle-right"}})],1)]):e._e()}),[],!1,null,null,null).exports,Ze={components:{Icon:j.a,Pagination:Ke,DeleteButton:_,GlDeprecatedButton:d.a},mixins:[Ye.a],props:{id:{type:String,required:!0},isDeleting:{type:Boolean,required:!0},filename:{type:String,required:!1,default:""},updatedAt:{type:String,required:!1,default:null},updatedBy:{type:Object,required:!1,default:function(){return{}}},isLatestVersion:{type:Boolean,required:!0},image:{type:String,required:!0}},data:function(){return{permissions:{createDesign:!1},projectPath:"",issueIid:null}},apollo:{appData:{query:Pe.a,manual:!0,result:function(e){var n=e.data,i=n.projectPath,t=n.issueIid;this.projectPath=i,this.issueIid=t}},permissions:{query:Ae.a,variables:function(){return{fullPath:this.projectPath,iid:this.issueIid}},update:function(e){return e.project.issue.userPermissions}}},computed:{updatedText:function(){return Object(u.e)(Object(u.a)("Updated %{updated_at} by %{updated_by}"),{updated_at:this.timeFormatted(this.updatedAt),updated_by:this.updatedBy.name})},canDeleteDesign:function(){return this.permissions.createDesign}},DESIGNS_ROUTE_NAME:"designs"},Je=Object(k.a)(Ze,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("header",{staticClass:"d-flex p-2 bg-white align-items-center js-design-header"},[i("router-link",{staticClass:"mr-3 text-plain d-flex justify-content-center align-items-center",attrs:{to:{name:e.$options.DESIGNS_ROUTE_NAME,query:e.$route.query},"aria-label":e.s__("DesignManagement|Go back to designs")}},[i("icon",{attrs:{size:18,name:"close"}})],1),e._v(" "),i("div",{staticClass:"overflow-hidden d-flex align-items-center"},[i("h2",{staticClass:"m-0 str-truncated-100 gl-font-base"},[e._v(e._s(e.filename))]),e._v(" "),e.updatedAt?i("small",{staticClass:"text-secondary"},[e._v(e._s(e.updatedText))]):e._e()]),e._v(" "),i("pagination",{staticClass:"ml-auto flex-shrink-0",attrs:{id:e.id}}),e._v(" "),i("gl-deprecated-button",{staticClass:"mr-2",attrs:{href:e.image}},[i("icon",{attrs:{size:18,name:"download"}})],1),e._v(" "),e.isLatestVersion&&e.canDeleteDesign?i("delete-button",{attrs:{"is-deleting":e.isDeleting,"button-variant":"danger"},on:{deleteSelectedDesigns:function(n){return e.$emit("delete")}}},[i("icon",{attrs:{size:18,name:"remove"}})],1):e._e()],1)}),[],!1,null,null,null).exports,en={components:{GlIcon:P.a},data:function(){return{scale:1}},computed:{disableReset:function(){return this.scale<=1},disableDecrease:function(){return 1===this.scale},disableIncrease:function(){return this.scale>=2}},methods:{setScale:function(e){e<1||(this.scale=Math.round(100*e)/100,this.$emit("scale",this.scale))},incrementScale:function(){this.setScale(this.scale+.2)},decrementScale:function(){this.setScale(this.scale-.2)},resetScale:function(){this.setScale(1)}}},nn=Object(k.a)(en,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"design-scaler btn-group",attrs:{role:"group"}},[i("button",{staticClass:"btn",attrs:{disabled:e.disableDecrease},on:{click:e.decrementScale}},[i("span",{staticClass:"d-flex-center gl-icon s16"},[e._v("\n      \n    ")])]),e._v(" "),i("button",{staticClass:"btn",attrs:{disabled:e.disableReset},on:{click:e.resetScale}},[i("gl-icon",{attrs:{name:"redo"}})],1),e._v(" "),i("button",{staticClass:"btn",attrs:{disabled:e.disableIncrease},on:{click:e.incrementScale}},[i("gl-icon",{attrs:{name:"plus"}})],1)])}),[],!1,null,null,null).exports,tn=i("h7kv"),on=i.n(tn),sn={components:{GlIcon:P.a},props:{image:{type:String,required:!1,default:""},name:{type:String,required:!1,default:""},scale:{type:Number,required:!1,default:1}},data:function(){return{baseImageSize:null,imageStyle:null,imageError:!1}},watch:{scale:function(e){this.zoom(e)}},beforeDestroy:function(){window.removeEventListener("resize",this.resizeThrottled,!1)},mounted:function(){var e=this;this.onImgLoad(),this.resizeThrottled=on()((function(){e.setBaseImageSize()}),400),window.addEventListener("resize",this.resizeThrottled,!1)},methods:{onImgLoad:function(){requestIdleCallback(this.setBaseImageSize,{timeout:1e3})},onImgError:function(){this.imageError=!0},setBaseImageSize:function(){var e=this.$refs.contentImg;e&&0!==e.offsetHeight&&0!==e.offsetWidth&&(this.baseImageSize={height:e.offsetHeight,width:e.offsetWidth},this.onResize({width:this.baseImageSize.width,height:this.baseImageSize.height}))},onResize:function(e){var n=e.width,i=e.height;this.$emit("resize",{width:n,height:i})},zoom:function(e){var n=this;if(1===e)return this.imageStyle=null,void this.$nextTick((function(){n.setBaseImageSize()}));var i=this.baseImageSize.width*e,t=this.baseImageSize.height*e;this.imageStyle={width:"".concat(i,"px"),height:"".concat(t,"px")},this.onResize({width:i,height:t})}}},an=Object(k.a)(sn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"m-auto js-design-image"},[e.imageError?i("gl-icon",{staticClass:"text-secondary-100",attrs:{name:"media-broken",size:48}}):e._e(),e._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:!e.imageError,expression:"!imageError"}],ref:"contentImg",staticClass:"mh-100",class:{"img-fluid":!e.imageStyle},style:e.imageStyle,attrs:{src:e.image,alt:e.name},on:{error:e.onImgError,load:e.onImgLoad}})],1)}),[],!1,null,null,null).exports,rn=i("F875"),ln=i.n(rn),dn=i("kjIf"),cn=i.n(dn);function un(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function mn(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?un(Object(i),!0).forEach((function(n){fn(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):un(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function fn(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var gn={name:"DesignNotePin",components:{Icon:j.a},props:{position:{type:Object,required:!0},label:{type:Number,required:!1,default:null},repositioning:{type:Boolean,required:!1,default:!1}},computed:{isNewNote:function(){return null===this.label},pinStyle:function(){return this.repositioning?mn(mn({},this.position),{},{cursor:"move"}):this.position},pinLabel:function(){return this.isNewNote?Object(u.a)("Comment form position"):Object(u.e)(Object(u.a)("Comment '%{label}' position"),{label:this.label})}}};function vn(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function pn(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var hn={name:"DesignOverlay",components:{DesignNotePin:Object(k.a)(gn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("button",{staticClass:"design-pin gl-absolute gl-display-flex gl-align-items-center gl-justify-content-center",class:{"btn-transparent comment-indicator":e.isNewNote,"js-image-badge badge badge-pill":!e.isNewNote},style:e.pinStyle,attrs:{"aria-label":e.pinLabel,type:"button"},on:{mousedown:function(n){return e.$emit("mousedown",n)},mouseup:function(n){return e.$emit("mouseup",n)},click:function(n){return e.$emit("click",n)}}},[e.isNewNote?i("icon",{attrs:{name:"image-comment-dark"}}):[e._v("\n    "+e._s(e.label)+"\n  ")]],2)}),[],!1,null,null,null).exports},props:{dimensions:{type:Object,required:!0},position:{type:Object,required:!0},notes:{type:Array,required:!1,default:function(){return[]}},currentCommentForm:{type:Object,required:!1,default:null},disableCommenting:{type:Boolean,required:!1,default:!1},resolvedDiscussionsExpanded:{type:Boolean,required:!0}},apollo:{activeDiscussion:{query:ln.a}},data:function(){return{movingNoteNewPosition:null,movingNoteStartPosition:null,activeDiscussion:{}}},computed:{overlayStyle:function(){return function(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?vn(Object(i),!0).forEach((function(n){pn(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vn(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}({cursor:this.disableCommenting?"unset":void 0,width:"".concat(this.dimensions.width,"px"),height:"".concat(this.dimensions.height,"px")},this.position)},isMovingCurrentComment:function(){return Boolean(this.movingNoteStartPosition&&!this.movingNoteStartPosition.noteId)},currentCommentPositionStyle:function(){return this.isMovingCurrentComment&&this.movingNoteNewPosition?this.getNotePositionStyle(this.movingNoteNewPosition):this.getNotePositionStyle(this.currentCommentForm)}},methods:{setNewNoteCoordinates:function(e){var n=e.x,i=e.y;this.$emit("openCommentForm",{x:n,y:i})},getNoteRelativePosition:function(e){var n=e.x,i=e.y,t=e.width,o=e.height,s=this.dimensions.width/t,a=this.dimensions.height/o;return{left:Math.round(n*s),top:Math.round(i*a)}},getNotePositionStyle:function(e){var n=this.getNoteRelativePosition(e),i=n.left,t=n.top;return{left:"".concat(i,"px"),top:"".concat(t,"px")}},getMovingNotePositionDelta:function(e){var n=0,i=0;if(this.movingNoteStartPosition){var t=this.movingNoteStartPosition,o=t.clientX,s=t.clientY;n=e.clientX-o,i=e.clientY-s}return{deltaX:n,deltaY:i}},isMovingNote:function(e){var n,i=null===(n=this.movingNoteStartPosition)||void 0===n?void 0:n.noteId;return Boolean(i&&i===e)},canMoveNote:function(e){var n=(e.userPermissions||{}).adminNote;return Boolean(n)},isPositionInOverlay:function(e){var n=this.getNoteRelativePosition(e),i=n.top,t=n.left,o=this.dimensions,s=o.height,a=o.width;return i>=0&&i<=s&&t>=0&&t<=a},onNewNoteMove:function(e){if(this.isMovingCurrentComment){var n=this.getMovingNotePositionDelta(e),i=n.deltaX,t=n.deltaY,o={x:this.currentCommentForm.x+i,y:this.currentCommentForm.y+t,width:this.dimensions.width,height:this.dimensions.height};this.isPositionInOverlay(o)?this.movingNoteNewPosition=o:this.onNewNoteMouseup()}},onExistingNoteMove:function(e){var n=this,i=this.notes.find((function(e){return e.id===n.movingNoteStartPosition.noteId}));if(i&&this.canMoveNote(i)){var t=i.position,o=t.width,s=t.height,a=this.dimensions.width/o,r=this.dimensions.height/s,l=this.getMovingNotePositionDelta(e),d=l.deltaX,c=l.deltaY,u={x:t.x*a+d,y:t.y*r+c,width:this.dimensions.width,height:this.dimensions.height};this.isPositionInOverlay(u)?this.movingNoteNewPosition=u:this.onExistingNoteMouseup()}},onNewNoteMouseup:function(){if(this.movingNoteNewPosition){var e=this.movingNoteNewPosition,n=e.x,i=e.y;this.setNewNoteCoordinates({x:n,y:i})}},onExistingNoteMouseup:function(e){if(!this.movingNoteStartPosition||!this.movingNoteNewPosition)return this.updateActiveDiscussion(e.id),void this.$emit("closeCommentForm");var n=this.movingNoteNewPosition,i=n.x,t=n.y;this.$emit("moveNote",{noteId:this.movingNoteStartPosition.noteId,discussionId:this.movingNoteStartPosition.discussionId,coordinates:{x:i,y:t}})},onNoteMousedown:function(e,n){var i=e.clientX,t=e.clientY;this.movingNoteStartPosition={noteId:null==n?void 0:n.id,discussionId:null==n?void 0:n.discussion.id,clientX:i,clientY:t}},onOverlayMousemove:function(e){this.movingNoteStartPosition&&(this.isMovingCurrentComment?this.onNewNoteMove(e):this.onExistingNoteMove(e))},onNoteMouseup:function(e){this.movingNoteStartPosition&&(this.isMovingCurrentComment?this.onNewNoteMouseup():this.onExistingNoteMouseup(e),this.movingNoteStartPosition=null,this.movingNoteNewPosition=null)},onAddCommentMouseup:function(e){var n=e.offsetX,i=e.offsetY;this.disableCommenting||(this.activeDiscussion.id&&this.updateActiveDiscussion(),this.setNewNoteCoordinates({x:n,y:i}))},updateActiveDiscussion:function(e){this.$apollo.mutate({mutation:cn.a,variables:{id:e,source:g}})},isNoteInactive:function(e){return this.activeDiscussion.id&&this.activeDiscussion.id!==e.id},designPinClass:function(e){return{inactive:this.isNoteInactive(e),resolved:e.resolved}}}},kn=Object(k.a)(hn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"position-absolute image-diff-overlay frame",style:e.overlayStyle,on:{mousemove:e.onOverlayMousemove,mouseleave:e.onNoteMouseup}},[i("button",{directives:[{name:"show",rawName:"v-show",value:!e.disableCommenting,expression:"!disableCommenting"}],staticClass:"btn-transparent position-absolute image-diff-overlay-add-comment w-100 h-100 js-add-image-diff-note-button",attrs:{type:"button","data-qa-selector":"design_image_button"},on:{mouseup:e.onAddCommentMouseup}}),e._v(" "),e._l(e.notes,(function(n){return[e.resolvedDiscussionsExpanded||!n.resolved?i("design-note-pin",{key:n.id,class:e.designPinClass(n),attrs:{label:n.index,repositioning:e.isMovingNote(n.id),position:e.isMovingNote(n.id)&&e.movingNoteNewPosition?e.getNotePositionStyle(e.movingNoteNewPosition):e.getNotePositionStyle(n.position)},on:{mousedown:function(i){return i.stopPropagation(),e.onNoteMousedown(i,n)},mouseup:function(i){return i.stopPropagation(),e.onNoteMouseup(n)}}}):e._e()]})),e._v(" "),e.currentCommentForm?i("design-note-pin",{attrs:{position:e.currentCommentPositionStyle,repositioning:e.isMovingCurrentComment},on:{mousedown:function(n){return n.stopPropagation(),e.onNoteMousedown(n)},mouseup:function(n){return n.stopPropagation(),e.onNoteMouseup(n)}}}):e._e()],2)}),[],!1,null,null,null).exports;function bn(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function yn(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?bn(Object(i),!0).forEach((function(n){Dn(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bn(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function Dn(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var Sn={components:{DesignImage:an,DesignOverlay:kn},props:{image:{type:String,required:!1,default:""},imageName:{type:String,required:!1,default:""},discussions:{type:Array,required:!0},isAnnotating:{type:Boolean,required:!1,default:!1},scale:{type:Number,required:!1,default:1},resolvedDiscussionsExpanded:{type:Boolean,required:!0}},data:function(){return{overlayDimensions:null,overlayPosition:null,currentAnnotationPosition:null,zoomFocalPoint:{x:0,y:0,width:0,height:0},initialLoad:!0,lastDragPosition:null,isDraggingDesign:!1}},computed:{discussionStartingNotes:function(){return this.discussions.map((function(e){return yn(yn({},e.notes[0]),{},{index:e.index})}))},currentCommentForm:function(){return this.isAnnotating&&this.currentAnnotationPosition||null},presentationStyle:function(){return{cursor:this.isDraggingDesign?"grabbing":void 0}}},beforeDestroy:function(){var e=this.$refs.presentationViewport;e&&e.removeEventListener("scroll",this.scrollThrottled,!1)},mounted:function(){var e=this,n=this.$refs.presentationViewport;n&&(this.scrollThrottled=on()((function(){e.shiftZoomFocalPoint()}),400),n.addEventListener("scroll",this.scrollThrottled,!1))},methods:{syncCurrentAnnotationPosition:function(){if(this.currentAnnotationPosition){var e=this.overlayDimensions.width/this.currentAnnotationPosition.width,n=this.overlayDimensions.height/this.currentAnnotationPosition.height,i=this.currentAnnotationPosition.x*e,t=this.currentAnnotationPosition.y*n;this.currentAnnotationPosition=this.getAnnotationPositon({x:i,y:t})}},setOverlayDimensions:function(e){this.overlayDimensions=e,this.syncCurrentAnnotationPosition()},setOverlayPosition:function(){this.overlayDimensions||(this.overlayPosition={});var e=this.$refs.presentationViewport;e&&(this.overlayPosition={left:"calc(50% - ".concat(this.overlayDimensions.width/2,"px)"),top:"calc(50% - ".concat(this.overlayDimensions.height/2,"px)")},this.overlayDimensions.width>e.offsetWidth&&(this.overlayPosition.left="0"),this.overlayDimensions.height>e.offsetHeight&&(this.overlayPosition.top="0"))},getViewportCenter:function(){var e=this.$refs.presentationViewport;if(!e)return{};var n=e.scrollWidth-e.offsetWidth,i=e.scrollHeight-e.offsetHeight,t=e.scrollLeft>0?e.scrollLeft/n:0,o=e.scrollTop>0?e.scrollTop/i:0,s=(e.scrollWidth-e.offsetWidth-0)*t,a=(e.scrollHeight-e.offsetHeight-0)*o;return{x:e.offsetWidth/2+s,y:e.offsetHeight/2+a}},scrollToFocalPoint:function(){var e=this.$refs.presentationViewport;if(e){var n=this.zoomFocalPoint.x-e.offsetWidth/2,i=this.zoomFocalPoint.y-e.offsetHeight/2;e.scrollTo(n,i)}},scaleZoomFocalPoint:function(){var e=this.zoomFocalPoint,n=e.x,i=e.y,t=e.width,o=e.height,s=this.overlayDimensions.width/t,a=this.overlayDimensions.height/o;this.zoomFocalPoint=yn({x:Math.round(n*s*100)/100,y:Math.round(i*a*100)/100},this.overlayDimensions)},shiftZoomFocalPoint:function(){this.zoomFocalPoint=yn(yn({},this.getViewportCenter()),this.overlayDimensions)},onImageResize:function(e){var n=this;this.setOverlayDimensions(e),this.setOverlayPosition(),this.$nextTick((function(){n.initialLoad?(n.shiftZoomFocalPoint(),n.initialLoad=!1):(n.scaleZoomFocalPoint(),n.scrollToFocalPoint())}))},getAnnotationPositon:function(e){var n=e.x,i=e.y,t=this.overlayDimensions,o=t.width,s=t.height;return{x:Math.round(n),y:Math.round(i),width:Math.round(o),height:Math.round(s)}},openCommentForm:function(e){this.currentAnnotationPosition=this.getAnnotationPositon(e),this.$emit("openCommentForm",this.currentAnnotationPosition)},closeCommentForm:function(){this.currentAnnotationPosition=null,this.$emit("closeCommentForm")},moveNote:function(e){var n=e.noteId,i=e.discussionId,t=e.coordinates,o=this.getAnnotationPositon(t);this.$emit("moveNote",{noteId:n,discussionId:i,position:o})},onPresentationMousedown:function(e){var n=e.clientX,i=e.clientY;this.isDesignOverflowing()&&(this.lastDragPosition={x:n,y:i})},getDragDelta:function(e,n){return{deltaX:this.lastDragPosition.x-e,deltaY:this.lastDragPosition.y-n}},exceedsDragThreshold:function(e,n){var i=this.getDragDelta(e,n),t=i.deltaX,o=i.deltaY;return Math.abs(t)>2||Math.abs(o)>2},shouldDragDesign:function(e,n){return this.lastDragPosition&&(this.isDraggingDesign||this.exceedsDragThreshold(e,n))},onPresentationMousemove:function(e){var n=e.clientX,i=e.clientY,t=this.$refs.presentationViewport;if(t&&this.shouldDragDesign(n,i)){this.isDraggingDesign=!0;var o=t.scrollLeft,s=t.scrollTop,a=this.getDragDelta(n,i),r=a.deltaX,l=a.deltaY;t.scrollTo(o+r,s+l),this.lastDragPosition={x:n,y:i}}},onPresentationMouseup:function(){this.lastDragPosition=null,this.isDraggingDesign=!1},isDesignOverflowing:function(){var e=this.$refs.presentationViewport;return!!e&&(e.scrollWidth>e.offsetWidth||e.scrollHeight>e.offsetHeight)}}},Nn=Object(k.a)(Sn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{ref:"presentationViewport",staticClass:"h-100 w-100 p-3 overflow-auto position-relative",style:e.presentationStyle,on:{mousedown:e.onPresentationMousedown,mousemove:e.onPresentationMousemove,mouseup:e.onPresentationMouseup,mouseleave:e.onPresentationMouseup,touchstart:e.onPresentationMousedown,touchmove:e.onPresentationMousemove,touchend:e.onPresentationMouseup,touchcancel:e.onPresentationMouseup}},[i("div",{staticClass:"h-100 w-100 d-flex align-items-center position-relative"},[e.image?i("design-image",{attrs:{image:e.image,name:e.imageName,scale:e.scale},on:{resize:e.onImageResize}}):e._e(),e._v(" "),e.overlayDimensions&&e.overlayPosition?i("design-overlay",{attrs:{dimensions:e.overlayDimensions,position:e.overlayPosition,notes:e.discussionStartingNotes,"current-comment-form":e.currentCommentForm,"disable-commenting":e.isDraggingDesign,"resolved-discussions-expanded":e.resolvedDiscussionsExpanded},on:{openCommentForm:e.openCommentForm,closeCommentForm:e.closeCommentForm,moveNote:e.moveNote}}):e._e()],1)])}),[],!1,null,null,null).exports,wn={name:"DesignReplyForm",components:{MarkdownField:i("IeAI").a,GlDeprecatedButton:d.a,GlModal:S.a},props:{markdownPreviewPath:{type:String,required:!1,default:""},value:{type:String,required:!0},isSaving:{type:Boolean,required:!0},isNewComment:{type:Boolean,required:!1,default:!0}},data:function(){return{formText:this.value}},computed:{hasValue:function(){return this.value.trim().length>0},modalSettings:function(){return this.isNewComment?{title:Object(u.d)("DesignManagement|Cancel comment confirmation"),okTitle:Object(u.d)("DesignManagement|Discard comment"),cancelTitle:Object(u.d)("DesignManagement|Keep comment"),content:Object(u.d)("DesignManagement|Are you sure you want to cancel creating this comment?")}:{title:Object(u.d)("DesignManagement|Cancel comment update confirmation"),okTitle:Object(u.d)("DesignManagement|Cancel changes"),cancelTitle:Object(u.d)("DesignManagement|Keep changes"),content:Object(u.d)("DesignManagement|Are you sure you want to cancel changes to this comment?")}},buttonText:function(){return this.isNewComment?Object(u.d)("DesignManagement|Comment"):Object(u.d)("DesignManagement|Save comment")}},mounted:function(){this.$refs.textarea.focus()},methods:{submitForm:function(){this.hasValue&&this.$emit("submitForm")},cancelComment:function(){this.hasValue&&this.formText!==this.value?this.$refs.cancelCommentModal.show():this.$emit("cancelForm")}}},_n=Object(k.a)(wn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("form",{staticClass:"new-note common-note-form",on:{submit:function(e){e.preventDefault()}}},[i("markdown-field",{staticClass:"bordered-box",attrs:{"markdown-preview-path":e.markdownPreviewPath,"can-attach-file":!1,"enable-autocomplete":!0,"textarea-value":e.value,"markdown-docs-path":"/help/user/markdown"},scopedSlots:e._u([{key:"textarea",fn:function(){return[i("textarea",{ref:"textarea",staticClass:"note-textarea js-gfm-input js-autosize markdown-area",attrs:{dir:"auto","data-supports-quick-actions":"false","data-qa-selector":"note_textarea","aria-label":e.__("Description"),placeholder:e.__("Write a comment")},domProps:{value:e.value},on:{input:function(n){return e.$emit("input",n.target.value)},keydown:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:n.metaKey?e.submitForm(n):null},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:n.ctrlKey?e.submitForm(n):null}],keyup:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:(n.stopPropagation(),e.cancelComment(n))}}})]},proxy:!0}])}),e._v(" "),e._t("resolveCheckbox"),e._v(" "),i("div",{staticClass:"note-form-actions gl-display-flex gl-justify-content-space-between"},[i("gl-deprecated-button",{ref:"submitButton",attrs:{disabled:!e.hasValue||e.isSaving,variant:"success",type:"submit","data-track-event":"click_button","data-qa-selector":"save_comment_button"},on:{click:function(n){return e.$emit("submitForm")}}},[e._v("\n      "+e._s(e.buttonText)+"\n    ")]),e._v(" "),i("gl-deprecated-button",{ref:"cancelButton",on:{click:e.cancelComment}},[e._v(e._s(e.__("Cancel")))])],1),e._v(" "),i("gl-modal",{ref:"cancelCommentModal",attrs:{"ok-variant":"danger",title:e.modalSettings.title,"ok-title":e.modalSettings.okTitle,"cancel-title":e.modalSettings.cancelTitle,"modal-id":"cancel-comment-modal"},on:{ok:function(n){return e.$emit("cancelForm")}}},[e._v(e._s(e.modalSettings.content)+"\n  ")])],2)}),[],!1,null,null,null).exports,On=i("06tH"),Pn=i.n(On),jn=i("NmEs"),Cn=i("aOF2"),En=i("4lAS"),xn=i("A7K0"),Fn=(i("jaBk"),i("KcQl"),i("h/fo")),In=i("Mj8U"),Vn=i.n(In),Tn=i("n2Xr"),qn=i.n(Tn),$n=i("oy7C"),An=i.n($n),Mn=(i("F1YE"),i("00Gr")),Rn=i.n(Mn),Ln=i("ZHzM"),Bn=i("OgyL"),Un={components:{UserAvatarLink:Ln.a,TimelineEntryItem:Bn.a,TimeAgoTooltip:C.a,DesignReplyForm:_n,ApolloMutation:I.a,GlIcon:P.a},directives:{GlTooltip:m.a},props:{note:{type:Object,required:!0},markdownPreviewPath:{type:String,required:!1,default:""}},data:function(){return{noteText:this.note.body,isEditing:!1}},computed:{author:function(){return this.note.author},noteAnchorId:function(){return(this.note.id.match("DiffNote/(.+$)")||[])[1]},isNoteLinked:function(){return this.$route.hash==="#note_".concat(this.noteAnchorId)},mutationPayload:function(){return{id:this.note.id,body:this.noteText}},isEditButtonVisible:function(){return!this.isEditing&&this.note.userPermissions.adminNote}},mounted:function(){this.isNoteLinked&&this.$refs.anchor.$el.scrollIntoView({behavior:"smooth",inline:"start"})},methods:{hideForm:function(){this.isEditing=!1,this.noteText=this.note.body},onDone:function(e){var n=e.data;this.hideForm(),pe(n.updateNote)&&this.$emit("error",n.errors[0])}},updateNoteMutation:Rn.a},Gn=Object(k.a)(Un,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("timeline-entry-item",{ref:"anchor",staticClass:"design-note note-form",attrs:{id:"note_"+e.noteAnchorId}},[i("user-avatar-link",{attrs:{"link-href":e.author.webUrl,"img-src":e.author.avatarUrl,"img-alt":e.author.username,"img-size":40}}),e._v(" "),i("div",{staticClass:"d-flex justify-content-between"},[i("div",[e._m(0),e._v(" "),i("span",{staticClass:"note-headline-light note-headline-meta"},[i("span",{staticClass:"system-note-message"},[e._t("default")],2),e._v(" "),e.note.createdAt?[i("span",{staticClass:"system-note-separator"}),e._v(" "),i("a",{staticClass:"note-timestamp system-note-separator",attrs:{href:"#note_"+e.noteAnchorId}},[i("time-ago-tooltip",{attrs:{time:e.note.createdAt,"tooltip-placement":"bottom"}})],1)]:e._e()],2)]),e._v(" "),i("div",{staticClass:"gl-display-flex"},[e._t("resolveDiscussion"),e._v(" "),e.isEditButtonVisible?i("button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"note-action-button js-note-edit btn btn-transparent qa-note-edit-button",attrs:{type:"button",title:e.__("Edit comment")},on:{click:function(n){e.isEditing=!0}}},[i("gl-icon",{staticClass:"link-highlight",attrs:{name:"pencil"}})],1):e._e()],2)]),e._v(" "),e.isEditing?i("apollo-mutation",{attrs:{mutation:e.$options.updateNoteMutation,variables:{input:e.mutationPayload}},on:{error:function(n){return e.$emit("error",n)},done:e.onDone},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.mutate,o=n.loading;return[i("design-reply-form",{staticClass:"mt-5",attrs:{"is-saving":o,"markdown-preview-path":e.markdownPreviewPath,"is-new-comment":!1},on:{submitForm:t,cancelForm:e.hideForm},model:{value:e.noteText,callback:function(n){e.noteText=n},expression:"noteText"}})]}}])}):[i("div",{staticClass:"note-text js-note-text md",attrs:{"data-qa-selector":"note_content"},domProps:{innerHTML:e._s(e.note.bodyHtml)}}),e._v(" "),e._t("resolvedStatus")]],2)}),[function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("a",{staticClass:"js-user-link",attrs:{href:e.author.webUrl,"data-user-id":e.author.id,"data-username":e.author.username}},[i("span",{staticClass:"note-header-author-name bold"},[e._v(e._s(e.author.name))]),e._v(" "),e.author.status_tooltip_html?i("span",{domProps:{innerHTML:e._s(e.author.status_tooltip_html)}}):e._e(),e._v(" "),i("span",{staticClass:"note-headline-light"},[e._v("@"+e._s(e.author.username))])])}],!1,null,null,null).exports,zn={name:"ToggleNotesWidget",components:{GlIcon:P.a,GlButton:En.a,GlLink:xe.a,TimeAgoTooltip:C.a},props:{collapsed:{type:Boolean,required:!0},replies:{type:Array,required:!0}},computed:{lastReply:function(){return this.replies[this.replies.length-1]},iconName:function(){return this.collapsed?"chevron-right":"chevron-down"},toggleText:function(){return this.collapsed?"".concat(this.replies.length," ").concat(Object(u.c)("reply","replies",this.replies.length)):Object(u.a)("Collapse replies")}}},Qn=Object(k.a)(zn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("li",{staticClass:"toggle-comments gl-bg-gray-50 gl-display-flex gl-align-items-center gl-py-3",class:{expanded:!e.collapsed},attrs:{"data-testid":"toggle-comments-wrapper"}},[i("gl-icon",{staticClass:"gl-ml-3",attrs:{name:e.iconName},on:{click:function(n){return n.stopPropagation(),e.$emit("toggle")}}}),e._v(" "),i("gl-button",{staticClass:"toggle-comments-button gl-ml-2 gl-mr-2",attrs:{variant:"link"},on:{click:function(n){return n.stopPropagation(),e.$emit("toggle")}}},[e._v("\n    "+e._s(e.toggleText)+"\n  ")]),e._v(" "),e.collapsed?[i("span",{staticClass:"gl-text-gray-700"},[e._v(e._s(e.__("Last reply by")))]),e._v(" "),i("gl-link",{staticClass:"link-inherit-color gl-text-black-normal gl-text-decoration-none gl-font-weight-bold gl-ml-2 gl-mr-2",attrs:{href:e.lastReply.author.webUrl,target:"_blank"}},[e._v("\n      "+e._s(e.lastReply.author.name)+"\n    ")]),e._v(" "),i("time-ago-tooltip",{staticClass:"gl-text-gray-700",attrs:{time:e.lastReply.createdAt,"tooltip-placement":"bottom"}})]:e._e()],2)}),[],!1,null,null,null).exports,Wn={components:{ApolloMutation:I.a,DesignNote:Gn,ReplyPlaceholder:Fn.a,DesignReplyForm:_n,GlIcon:P.a,GlLoadingIcon:r.a,GlLink:xe.a,ToggleRepliesWidget:Qn,TimeAgoTooltip:C.a},directives:{GlTooltip:m.a},mixins:[je],props:{discussion:{type:Object,required:!0},noteableId:{type:String,required:!0},designId:{type:String,required:!0},markdownPreviewPath:{type:String,required:!1,default:""},resolvedDiscussionsExpanded:{type:Boolean,required:!0},discussionWithOpenForm:{type:String,required:!0}},apollo:{activeDiscussion:{query:ln.a,result:function(e){var n=e.data,i=n.activeDiscussion.id;this.discussion.resolved&&!this.resolvedDiscussionsExpanded||i&&n.activeDiscussion.source===g&&i===this.discussion.notes[0].id&&this.$el.scrollIntoView({behavior:"smooth",inline:"start"})}}},data:function(){return{discussionComment:"",isFormRendered:!1,activeDiscussion:{},isResolving:!1,shouldChangeResolvedStatus:!1,areRepliesCollapsed:this.discussion.resolved}},computed:{mutationPayload:function(){return{noteableId:this.noteableId,body:this.discussionComment,discussionId:this.discussion.id}},designVariables:function(){return{fullPath:this.projectPath,iid:this.issueIid,filenames:[this.$route.params.id],atVersion:this.designsVersion}},isDiscussionHighlighted:function(){return this.discussion.notes[0].id===this.activeDiscussion.id},resolveCheckboxText:function(){return this.discussion.resolved?Object(u.d)("DesignManagement|Unresolve thread"):Object(u.d)("DesignManagement|Resolve thread")},firstNote:function(){return this.discussion.notes[0]},discussionReplies:function(){return this.discussion.notes.slice(1)},areRepliesShown:function(){return!this.discussion.resolved||!this.areRepliesCollapsed},resolveIconName:function(){return this.discussion.resolved?"check-circle-filled":"check-circle"},isRepliesWidgetVisible:function(){return this.discussion.resolved&&this.discussionReplies.length>0},isReplyPlaceholderVisible:function(){return this.areRepliesShown||!this.discussionReplies.length},isFormVisible:function(){return this.isFormRendered&&this.discussionWithOpenForm===this.discussion.id}},methods:{addDiscussionComment:function(e,n){var i=n.data.createNote;ke(e,i,An.a,this.designVariables,this.discussion.id)},onDone:function(){this.discussionComment="",this.hideForm(),this.shouldChangeResolvedStatus&&this.toggleResolvedStatus()},onCreateNoteError:function(e){this.$emit("createNoteError",e)},hideForm:function(){this.isFormRendered=!1,this.discussionComment=""},showForm:function(){this.$emit("openForm",this.discussion.id),this.isFormRendered=!0},toggleResolvedStatus:function(){var e=this;this.isResolving=!0,this.$apollo.mutate({mutation:qn.a,variables:{id:this.discussion.id,resolve:!this.discussion.resolved}}).then((function(n){var i,t=n.data;(null===(i=t.errors)||void 0===i?void 0:i.length)>0&&e.$emit("resolveDiscussionError",t.errors[0])})).catch((function(n){e.$emit("resolveDiscussionError",n)})).finally((function(){e.isResolving=!1}))}},createNoteMutation:Vn.a};function Yn(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function Hn(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?Yn(Object(i),!0).forEach((function(n){Xn(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yn(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function Xn(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var Kn={components:{DesignDiscussion:Object(k.a)(Wn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"design-discussion-wrapper"},[i("div",{staticClass:"badge badge-pill gl-display-flex gl-align-items-center gl-justify-content-center",class:{resolved:e.discussion.resolved},attrs:{type:"button"}},[e._v("\n    "+e._s(e.discussion.index)+"\n  ")]),e._v(" "),i("ul",{staticClass:"design-discussion bordered-box gl-relative gl-p-0 gl-list-style-none",attrs:{"data-qa-selector":"design_discussion_content"}},[i("design-note",{class:{"gl-bg-blue-50":e.isDiscussionHighlighted},attrs:{note:e.firstNote,"markdown-preview-path":e.markdownPreviewPath,"is-resolving":e.isResolving},on:{error:function(n){return e.$emit("updateNoteError",n)}},scopedSlots:e._u([e.discussion.resolvable?{key:"resolveDiscussion",fn:function(){return[i("button",{directives:[{name:"gl-tooltip",rawName:"v-gl-tooltip"}],staticClass:"line-resolve-btn note-action-button gl-mr-3",class:{"is-active":e.discussion.resolved},attrs:{title:e.resolveCheckboxText,"aria-label":e.resolveCheckboxText,type:"button","data-testid":"resolve-button"},on:{click:function(n){return n.stopPropagation(),e.toggleResolvedStatus(n)}}},[e.isResolving?i("gl-loading-icon",{attrs:{inline:""}}):i("gl-icon",{attrs:{name:e.resolveIconName,"data-testid":"resolve-icon"}})],1)]},proxy:!0}:null,e.discussion.resolved?{key:"resolvedStatus",fn:function(){return[i("p",{staticClass:"gl-text-gray-700 gl-font-sm gl-m-0 gl-mt-5",attrs:{"data-testid":"resolved-message"}},[e._v("\n          "+e._s(e.__("Resolved by"))+"\n          "),i("gl-link",{staticClass:"gl-text-gray-700 gl-text-decoration-none gl-font-sm link-inherit-color",attrs:{href:e.discussion.resolvedBy.webUrl,target:"_blank"}},[e._v(e._s(e.discussion.resolvedBy.name))]),e._v(" "),i("time-ago-tooltip",{attrs:{time:e.discussion.resolvedAt,"tooltip-placement":"bottom"}})],1)]},proxy:!0}:null],null,!0)}),e._v(" "),e.isRepliesWidgetVisible?i("toggle-replies-widget",{attrs:{collapsed:e.areRepliesCollapsed,replies:e.discussionReplies},on:{toggle:function(n){e.areRepliesCollapsed=!e.areRepliesCollapsed}}}):e._e(),e._v(" "),e._l(e.discussionReplies,(function(n){return i("design-note",{directives:[{name:"show",rawName:"v-show",value:e.areRepliesShown,expression:"areRepliesShown"}],key:n.id,class:{"gl-bg-blue-50":e.isDiscussionHighlighted},attrs:{note:n,"markdown-preview-path":e.markdownPreviewPath,"is-resolving":e.isResolving},on:{error:function(n){return e.$emit("updateNoteError",n)}}})})),e._v(" "),i("li",{directives:[{name:"show",rawName:"v-show",value:e.isReplyPlaceholderVisible,expression:"isReplyPlaceholderVisible"}],staticClass:"reply-wrapper"},[e.isFormVisible?i("apollo-mutation",{attrs:{mutation:e.$options.createNoteMutation,variables:{input:e.mutationPayload},update:e.addDiscussionComment},on:{done:e.onDone,error:e.onCreateNoteError},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.mutate,o=n.loading;return[i("design-reply-form",{attrs:{"is-saving":o,"markdown-preview-path":e.markdownPreviewPath},on:{submitForm:t,cancelForm:e.hideForm},scopedSlots:e._u([e.discussion.resolvable?{key:"resolveCheckbox",fn:function(){return[i("label",{attrs:{"data-testid":"resolve-checkbox"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.shouldChangeResolvedStatus,expression:"shouldChangeResolvedStatus"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.shouldChangeResolvedStatus)?e._i(e.shouldChangeResolvedStatus,null)>-1:e.shouldChangeResolvedStatus},on:{change:function(n){var i=e.shouldChangeResolvedStatus,t=n.target,o=!!t.checked;if(Array.isArray(i)){var s=e._i(i,null);t.checked?s<0&&(e.shouldChangeResolvedStatus=i.concat([null])):s>-1&&(e.shouldChangeResolvedStatus=i.slice(0,s).concat(i.slice(s+1)))}else e.shouldChangeResolvedStatus=o}}}),e._v("\n              "+e._s(e.resolveCheckboxText)+"\n            ")])]},proxy:!0}:null],null,!0),model:{value:e.discussionComment,callback:function(n){e.discussionComment=n},expression:"discussionComment"}})]}}])}):i("reply-placeholder",{staticClass:"qa-discussion-reply",attrs:{"button-text":e.__("Reply...")},on:{onClick:e.showForm}})],1)],2)])}),[],!1,null,null,null).exports,Participants:i("7sEu").a,GlCollapse:Cn.a,GlButton:En.a,GlPopover:xn.a},props:{design:{type:Object,required:!0},resolvedDiscussionsExpanded:{type:Boolean,required:!0},markdownPreviewPath:{type:String,required:!0}},data:function(){return{isResolvedCommentsPopoverHidden:Object(jn.H)(Pn.a.get(this.$options.cookieKey)),discussionWithOpenForm:""}},computed:{discussions:function(){return B(this.design.discussions)},issue:function(){return Hn(Hn({},this.design.issue),{},{webPath:this.design.issue.webPath.substr(1)})},discussionParticipants:function(){return Y(this.issue.participants)},resolvedDiscussions:function(){return this.discussions.filter((function(e){return e.resolved}))},unresolvedDiscussions:function(){return this.discussions.filter((function(e){return!e.resolved}))},resolvedCommentsToggleIcon:function(){return this.resolvedDiscussionsExpanded?"chevron-down":"chevron-right"}},methods:{handleSidebarClick:function(){this.isResolvedCommentsPopoverHidden=!0,Pn.a.set(this.$options.cookieKey,"true",{expires:3650}),this.updateActiveDiscussion()},updateActiveDiscussion:function(e){this.$apollo.mutate({mutation:cn.a,variables:{id:e,source:v}})},closeCommentForm:function(){this.comment="",this.$emit("closeCommentForm")},updateDiscussionWithOpenForm:function(e){this.discussionWithOpenForm=e}},resolveCommentsToggleText:Object(u.d)("DesignManagement|Resolved Comments"),cookieKey:"hide_design_resolved_comments_popover"},Zn=Object(k.a)(Kn,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"image-notes",on:{click:e.handleSidebarClick}},[i("h2",{staticClass:"gl-font-weight-bold gl-mt-0"},[e._v("\n    "+e._s(e.issue.title)+"\n  ")]),e._v(" "),i("a",{staticClass:"gl-text-gray-600 gl-text-decoration-none gl-mb-6 gl-display-block",attrs:{href:e.issue.webUrl}},[e._v(e._s(e.issue.webPath))]),e._v(" "),i("participants",{staticClass:"gl-mb-4",attrs:{participants:e.discussionParticipants,"show-participant-label":!1}}),e._v(" "),0===e.unresolvedDiscussions.length?i("h2",{staticClass:"new-discussion-disclaimer gl-font-base gl-m-0 gl-mb-4",attrs:{"data-testid":"new-discussion-disclaimer"}},[e._v("\n    "+e._s(e.s__("DesignManagement|Click the image where you'd like to start a new discussion"))+"\n  ")]):e._e(),e._v(" "),e._l(e.unresolvedDiscussions,(function(n){return i("design-discussion",{key:n.id,attrs:{discussion:n,"design-id":e.$route.params.id,"noteable-id":e.design.id,"markdown-preview-path":e.markdownPreviewPath,"resolved-discussions-expanded":e.resolvedDiscussionsExpanded,"discussion-with-open-form":e.discussionWithOpenForm,"data-testid":"unresolved-discussion"},on:{createNoteError:function(n){return e.$emit("onDesignDiscussionError",n)},updateNoteError:function(n){return e.$emit("updateNoteError",n)},resolveDiscussionError:function(n){return e.$emit("resolveDiscussionError",n)},openForm:e.updateDiscussionWithOpenForm},nativeOn:{click:function(i){return i.stopPropagation(),e.updateActiveDiscussion(n.notes[0].id)}}})})),e._v(" "),e.resolvedDiscussions.length>0?[i("gl-button",{staticClass:"link-inherit-color gl-text-black-normal gl-text-decoration-none gl-font-weight-bold gl-mb-4",attrs:{id:"resolved-comments","data-testid":"resolved-comments",icon:e.resolvedCommentsToggleIcon,variant:"link"},on:{click:function(n){return e.$emit("toggleResolvedComments")}}},[e._v(e._s(e.$options.resolveCommentsToggleText)+" ("+e._s(e.resolvedDiscussions.length)+")\n    ")]),e._v(" "),e.isResolvedCommentsPopoverHidden?e._e():i("gl-popover",{attrs:{show:!e.isResolvedCommentsPopoverHidden,target:"resolved-comments",container:"popovercontainer",placement:"top",title:e.s__("DesignManagement|Resolved Comments")}},[i("p",[e._v("\n        "+e._s(e.s__('DesignManagement|Comments you resolve can be viewed and unresolved by going to the "Resolved Comments" section below'))+"\n      ")]),e._v(" "),i("a",{attrs:{href:"#",rel:"noopener noreferrer",target:"_blank"}},[e._v(e._s(e.s__("DesignManagement|Learn more about resolving comments")))])]),e._v(" "),i("gl-collapse",{staticClass:"gl-mt-3",attrs:{visible:e.resolvedDiscussionsExpanded}},e._l(e.resolvedDiscussions,(function(n){return i("design-discussion",{key:n.id,attrs:{discussion:n,"design-id":e.$route.params.id,"noteable-id":e.design.id,"markdown-preview-path":e.markdownPreviewPath,"resolved-discussions-expanded":e.resolvedDiscussionsExpanded,"discussion-with-open-form":e.discussionWithOpenForm,"data-testid":"resolved-discussion"},on:{error:function(n){return e.$emit("onDesignDiscussionError",n)},updateNoteError:function(n){return e.$emit("updateNoteError",n)},openForm:e.updateDiscussionWithOpenForm},nativeOn:{click:function(i){return i.stopPropagation(),e.updateActiveDiscussion(n.notes[0].id)}}})})),1)]:e._e(),e._v(" "),e._t("replyForm")],2)}),[],!1,null,null,null).exports,Jn=i("ukJ8"),ei=i.n(Jn),ni=i("emAI"),ii=i.n(ni),ti=i("4ZIW");function oi(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function si(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}var ai="projects:issues:design";function ri(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ti.a.event(ai,"design_viewed",function(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?oi(Object(i),!0).forEach((function(n){si(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oi(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}({label:"design_viewed"},{value:{"internal-object-refrerer":(e=[n,i,t,o])[0],"design-collection-owner":e[1],"design-version-number":e[2],"design-is-current-version":e[3]}}))}var li={components:{ApolloMutation:I.a,DesignReplyForm:_n,DesignPresentation:Nn,DesignScaler:nn,DesignDestroyer:Ne,Toolbar:Je,GlLoadingIcon:r.a,GlAlert:l.a,DesignSidebar:Zn},mixins:[je],props:{id:{type:String,required:!0}},data:function(){return{design:{},comment:"",annotationCoordinates:null,projectPath:"",errorMessage:"",issueIid:"",scale:1,resolvedDiscussionsExpanded:!1}},apollo:{appData:{query:Pe.a,manual:!0,result:function(e){var n=e.data,i=n.projectPath,t=n.issueIid;this.projectPath=i,this.issueIid=t}},design:{query:An.a,fetchPolicy:We.b.CACHE_AND_NETWORK,variables:function(){return this.designVariables},update:function(e){return z(e)},result:function(e){this.onDesignQueryResult(e)},error:function(){this.onQueryError(ie)}}},computed:{isFirstLoading:function(){return this.$apollo.queries.design.loading&&!this.design.filename},discussions:function(){return this.design.discussions?B(this.design.discussions):[]},markdownPreviewPath:function(){return"/".concat(this.projectPath,"/preview_markdown?target_type=Issue")},isSubmitButtonDisabled:function(){return 0===this.comment.trim().length},designVariables:function(){return{fullPath:this.projectPath,iid:this.issueIid,filenames:[this.$route.params.id],atVersion:this.designsVersion}},mutationPayload:function(){var e=this.annotationCoordinates,n=e.x,i=e.y,t=e.width,o=e.height;return{noteableId:this.design.id,body:this.comment,position:{headSha:this.design.diffRefs.headSha,baseSha:this.design.diffRefs.baseSha,startSha:this.design.diffRefs.startSha,x:n,y:i,width:t,height:o,paths:{newPath:this.design.fullPath}}}},isAnnotating:function(){return Boolean(this.annotationCoordinates)},resolvedDiscussions:function(){return this.discussions.filter((function(e){return e.resolved}))}},watch:{resolvedDiscussions:function(e){e.length||(this.resolvedDiscussionsExpanded=!1)}},mounted:function(){Qe.a.bind("esc",this.closeDesign),this.trackEvent(),this.updateActiveDiscussion()},beforeDestroy:function(){Qe.a.unbind("esc",this.closeDesign)},methods:{addImageDiffNoteToStore:function(e,n){var i=n.data.createImageDiffNote;be(e,i,An.a,this.designVariables)},updateImageDiffNoteInStore:function(e,n){var i=n.data.updateImageDiffNote;return ye(e,i,An.a,this.designVariables)},onMoveNote:function(e){var n=this,i=e.noteId,t=e.discussionId,o=e.position,s=this.discussions.find((function(e){return e.id===t})).notes.find((function(e){return e.discussion.id===t})),a={optimisticResponse:W(s,{position:o}),variables:{input:{id:i,position:o}},mutation:ii.a,update:this.updateImageDiffNoteInStore};return this.$apollo.mutate(a).catch((function(e){return n.onUpdateImageDiffNoteError(e)}))},onDesignQueryResult:function(e){var n=e.data;e.loading||(n&&z(n)?this.$route.query.version&&!this.hasValidVersion&&this.onQueryError(te):this.onQueryError(ie))},onQueryError:function(e){Object(c.a)(e),this.$router.push({name:this.$options.DESIGNS_ROUTE_NAME})},onError:function(e,n){throw this.errorMessage=e,n},onCreateImageDiffNoteError:function(e){this.onError(K,e)},onUpdateNoteError:function(e){this.onError(J,e)},onDesignDiscussionError:function(e){this.onError(X,e)},onUpdateImageDiffNoteError:function(e){this.onError(Z,e)},onDesignDeleteError:function(e){this.onError(le({singular:!0}),e)},onResolveDiscussionError:function(e){this.onError(Z,e)},openCommentForm:function(e){this.annotationCoordinates=e},closeCommentForm:function(){this.comment="",this.annotationCoordinates=null},closeDesign:function(){this.$router.push({name:this.$options.DESIGNS_ROUTE_NAME,query:this.$route.query})},trackEvent:function(){ri("issue-design-collection","issue",this.$route.query.version||this.latestVersionId,this.isLatestVersion)},updateActiveDiscussion:function(e){this.$apollo.mutate({mutation:cn.a,variables:{id:e,source:v}})},toggleResolvedComments:function(){this.resolvedDiscussionsExpanded=!this.resolvedDiscussionsExpanded}},createImageDiffNoteMutation:ei.a,DESIGNS_ROUTE_NAME:"designs"},di=Object(k.a)(li,(function(){var e=this,n=e.$createElement,i=e._self._c||n;return i("div",{staticClass:"design-detail js-design-detail fixed-top w-100 position-bottom-0 d-flex justify-content-center flex-column flex-lg-row"},[e.isFirstLoading?i("gl-loading-icon",{staticClass:"align-self-center",attrs:{size:"xl"}}):[i("div",{staticClass:"d-flex overflow-hidden flex-grow-1 flex-column position-relative"},[i("design-destroyer",{attrs:{filenames:[e.design.filename],"project-path":e.projectPath,iid:e.issueIid},on:{done:function(n){return e.$router.push({name:e.$options.DESIGNS_ROUTE_NAME})},error:e.onDesignDeleteError},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.mutate,o=n.loading;return[i("toolbar",e._b({attrs:{id:e.id,"is-deleting":o,"is-latest-version":e.isLatestVersion},on:{delete:t}},"toolbar",e.design,!1))]}}])}),e._v(" "),e.errorMessage?i("div",{staticClass:"p-3"},[i("gl-alert",{attrs:{variant:"danger"},on:{dismiss:function(n){e.errorMessage=null}}},[e._v("\n          "+e._s(e.errorMessage)+"\n        ")])],1):e._e(),e._v(" "),i("design-presentation",{attrs:{image:e.design.image,"image-name":e.design.filename,discussions:e.discussions,"is-annotating":e.isAnnotating,scale:e.scale,"resolved-discussions-expanded":e.resolvedDiscussionsExpanded},on:{openCommentForm:e.openCommentForm,closeCommentForm:e.closeCommentForm,moveNote:e.onMoveNote}}),e._v(" "),i("div",{staticClass:"design-scaler-wrapper position-absolute mb-4 d-flex-center"},[i("design-scaler",{on:{scale:function(n){e.scale=n}}})],1)],1),e._v(" "),i("design-sidebar",{attrs:{design:e.design,"resolved-discussions-expanded":e.resolvedDiscussionsExpanded,"markdown-preview-path":e.markdownPreviewPath},on:{onDesignDiscussionError:e.onDesignDiscussionError,onCreateImageDiffNoteError:e.onCreateImageDiffNoteError,updateNoteError:e.onUpdateNoteError,resolveDiscussionError:e.onResolveDiscussionError,toggleResolvedComments:e.toggleResolvedComments},scopedSlots:e._u([{key:"replyForm",fn:function(){return[e.isAnnotating?i("apollo-mutation",{attrs:{mutation:e.$options.createImageDiffNoteMutation,variables:{input:e.mutationPayload},update:e.addImageDiffNoteToStore},on:{done:e.closeCommentForm,error:e.onCreateImageDiffNoteError},scopedSlots:e._u([{key:"default",fn:function(n){var t=n.mutate,o=n.loading;return[i("design-reply-form",{attrs:{"is-saving":o,"markdown-preview-path":e.markdownPreviewPath},on:{submitForm:t,cancelForm:e.closeCommentForm},model:{value:e.comment,callback:function(n){e.comment=n},expression:"comment"}})]}}],null,!1,1579936825)}):e._e()]},proxy:!0}])})]],2)}),[],!1,null,null,null).exports,ci=[{name:"root",path:"/",component:Ge,meta:{el:"discussion"}},{name:"designs",path:"/designs",component:Ge,meta:{el:"designs"},children:[{name:E,path:":id",component:di,meta:{el:"designs"},beforeEnter:function(e,n,i){"string"==typeof e.params.id&&i()},props:function(e){return{id:e.params.id}}}]}];function ui(e){return function(e){if(Array.isArray(e))return mi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return mi(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return mi(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mi(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,t=new Array(n);i<n;i++)t[i]=e[i];return t}s.default.use(a.a);var fi=Object(k.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("router-view")}),[],!1,null,null,null).exports,gi=i("gr1B"),vi=i("XmZ7"),pi=i.n(vi);s.default.use(I.b);var hi={Mutation:{updateActiveDiscussion:function(e,n,i){var t=n.id,o=void 0===t?null:t,s=n.source,a=i.cache,r=a.readQuery({query:ln.a});r.activeDiscussion={__typename:"ActiveDiscussion",id:o,source:s},a.writeQuery({query:ln.a,data:r})}}},ki=Object(We.a)(hi,{cacheConfig:{dataIdFromObject:function(e){return"Design"===e.__typename?e.id&&e.image?"".concat(e.id,"-").concat(e.image):D()():Object(gi.c)(e)}},typeDefs:pi.a}),bi=new I.b({defaultClient:ki});n.default=function(){var e=document.querySelector(".js-design-management"),n=document.querySelector(".js-designs-count"),i=e.dataset,t=i.issueIid,r=i.projectPath,l=function(e){var n=new a.a({base:e,mode:"history",routes:ci}),i=H();return n.beforeEach((function(e,n,t){var s,a,r=e.meta.el,l=e.name;(o()("#".concat(r)).tab("show"),i)&&(l===E?(s=i.classList).add.apply(s,ui(p)):(a=i.classList).remove.apply(a,ui(p)));t()})),n}(i.issuePath);return o()(".js-issue-tabs").on("shown.bs.tab",(function(e){var n=e.target.id;"designs"===n&&"root"===l.currentRoute.name?l.push({name:"designs"}):"discussion"===n&&l.push({name:"root"})})),bi.clients.defaultClient.cache.writeData({data:{projectPath:r,issueIid:t,activeDiscussion:{__typename:"ActiveDiscussion",id:null,source:null}}}),bi.clients.defaultClient.watchQuery({query:T.a,variables:{fullPath:r,iid:t,atVersion:null}}).subscribe((function(e){var i=e.data;n&&(n.textContent=i.project.issue.designCollection.designs.edges.length)})),new s.default({el:e,router:l,apolloProvider:bi,render:function(e){return e(fi)}})}},kjIf:function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"updateActiveDiscussion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateActiveDiscussion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[]}]}]}}],loc:{start:0,end:127}};i.loc.source={body:"mutation updateActiveDiscussion($id: String, $source: String) {\n  updateActiveDiscussion (id: $id, source: $source ) @client\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function o(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),t[e.name.value]=n}})),e.exports=i,e.exports.updateActiveDiscussion=function(e,n){var i={kind:e.kind,definitions:[o(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var s=t[n]||new Set,a=new Set,r=new Set;for(s.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(n){var t=o(e,n);t&&i.definitions.push(t)})),i}(i,"updateActiveDiscussion")},mnqm:function(e,n){var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"permissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPermissions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDesign"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:179}};i.loc.source={body:"query permissions($fullPath: ID!, $iid: String!) {\n  project(fullPath: $fullPath) {\n    id\n    issue(iid: $iid) {\n      userPermissions {\n        createDesign\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var t={};function o(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}i.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),t[e.name.value]=n}})),e.exports=i,e.exports.permissions=function(e,n){var i={kind:e.kind,definitions:[o(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var s=t[n]||new Set,a=new Set,r=new Set;for(s.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){a.has(e)||(a.add(e),(t[e]||new Set).forEach((function(e){r.add(e)})))}))}return a.forEach((function(n){var t=o(e,n);t&&i.definitions.push(t)})),i}(i,"permissions")},n2Xr:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"toggleResolveDiscussion"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resolve"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"discussionToggleResolve"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"resolve"},value:{kind:"Variable",name:{kind:"Name",value:"resolve"}}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"discussion"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ResolvedStatus"},directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:396}};t.loc.source={body:'#import "../fragments/designNote.fragment.graphql"\n#import "../fragments/discussion_resolved_status.fragment.graphql"\n\nmutation toggleResolveDiscussion($id: ID!, $resolve: Boolean!) {\n  discussionToggleResolve(input: { id: $id, resolve: $resolve }) {\n    discussion {\n      id\n      ...ResolvedStatus\n      notes {\n        nodes {\n          ...DesignNote\n        }\n      }\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};function s(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)}))}t.definitions=t.definitions.concat(s(i("YatT").definitions)),t.definitions=t.definitions.concat(s(i("Z+Gl").definitions));var a={};function r(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),a[e.name.value]=n}})),e.exports=t,e.exports.toggleResolveDiscussion=function(e,n){var i={kind:e.kind,definitions:[r(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=a[n]||new Set,o=new Set,s=new Set;for(t.forEach((function(e){s.add(e)}));s.size>0;){var l=s;s=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(a[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=r(e,n);t&&i.definitions.push(t)})),i}(t,"toggleResolveDiscussion")},o4PY:function(e,n,i){var t=i("rhmX"),o=0;e.exports=function(e){var n=++o;return t(e)+n}},oy7C:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getDesign"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"atVersion"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filenames"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designCollection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"atVersion"},value:{kind:"Variable",name:{kind:"Name",value:"atVersion"}}},{kind:"Argument",name:{kind:"Name",value:"filenames"},value:{kind:"Variable",name:{kind:"Name",value:"filenames"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignItem"},directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webPath"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"webUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participants"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"Author"},directives:[]}]}}]}}]}}]}}]}}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:753}};t.loc.source={body:'#import "../fragments/design.fragment.graphql"\n#import "~/graphql_shared/fragments/author.fragment.graphql"\n\nquery getDesign($fullPath: ID!, $iid: String!, $atVersion: ID, $filenames: [String!]) {\n  project(fullPath: $fullPath) {\n    id\n    issue(iid: $iid) {\n      designCollection {\n        designs(atVersion: $atVersion, filenames: $filenames) {\n          edges {\n            node {\n              ...DesignItem\n              issue {\n                title\n                webPath\n                webUrl\n                participants {\n                  edges {\n                    node {\n                      ...Author\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};function s(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)}))}t.definitions=t.definitions.concat(s(i("DAN1").definitions)),t.definitions=t.definitions.concat(s(i("5JsC").definitions));var a={};function r(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),a[e.name.value]=n}})),e.exports=t,e.exports.getDesign=function(e,n){var i={kind:e.kind,definitions:[r(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=a[n]||new Set,o=new Set,s=new Set;for(t.forEach((function(e){s.add(e)}));s.size>0;){var l=s;s=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(a[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=r(e,n);t&&i.definitions.push(t)})),i}(t,"getDesign")},ukJ8:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"createImageDiffNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CreateImageDiffNoteInput"}}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createImageDiffNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"note"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]},{kind:"Field",name:{kind:"Name",value:"discussion"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"replyId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignNote"},directives:[]}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"errors"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:382}};t.loc.source={body:'#import "../fragments/designNote.fragment.graphql"\n\nmutation createImageDiffNote($input: CreateImageDiffNoteInput!) {\n  createImageDiffNote(input: $input) {\n    note {\n      ...DesignNote\n      discussion {\n        id\n        replyId\n        notes {\n          edges {\n            node {\n              ...DesignNote\n            }\n          }\n        }\n      }\n    }\n    errors\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};t.definitions=t.definitions.concat(i("YatT").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)})));var s={};function a(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),s[e.name.value]=n}})),e.exports=t,e.exports.createImageDiffNote=function(e,n){var i={kind:e.kind,definitions:[a(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=s[n]||new Set,o=new Set,r=new Set;for(t.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(s[e]||new Set).forEach((function(e){r.add(e)})))}))}return o.forEach((function(n){var t=a(e,n);t&&i.definitions.push(t)})),i}(t,"createImageDiffNote")},xs3K:function(e,n,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getDesignList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fullPath"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"iid"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"atVersion"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"project"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fullPath"},value:{kind:"Variable",name:{kind:"Name",value:"fullPath"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"issue"},arguments:[{kind:"Argument",name:{kind:"Name",value:"iid"},value:{kind:"Variable",name:{kind:"Name",value:"iid"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designCollection"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"designs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"atVersion"},value:{kind:"Variable",name:{kind:"Name",value:"atVersion"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DesignListItem"},directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"versions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"VersionListItem"},directives:[]}]}}]}}]}}]}}]}}]}}]}}],loc:{start:0,end:548}};t.loc.source={body:'#import "../fragments/designList.fragment.graphql"\n#import "../fragments/version.fragment.graphql"\n\nquery getDesignList($fullPath: ID!, $iid: String!, $atVersion: ID) {\n  project(fullPath: $fullPath) {\n    id\n    issue(iid: $iid) {\n      designCollection {\n        designs(atVersion: $atVersion) {\n          edges {\n            node {\n              ...DesignListItem\n            }\n          }\n        }\n        versions {\n          edges {\n            node {\n              ...VersionListItem\n            }\n          }\n        }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var o={};function s(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!o[n]&&(o[n]=!0,!0)}))}t.definitions=t.definitions.concat(s(i("QqLJ").definitions)),t.definitions=t.definitions.concat(s(i("yU3k").definitions));var a={};function r(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,i)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,i)})),n.definitions&&n.definitions.forEach((function(n){e(n,i)}))}(e,n),a[e.name.value]=n}})),e.exports=t,e.exports.getDesignList=function(e,n){var i={kind:e.kind,definitions:[r(e,n)]};e.hasOwnProperty("loc")&&(i.loc=e.loc);var t=a[n]||new Set,o=new Set,s=new Set;for(t.forEach((function(e){s.add(e)}));s.size>0;){var l=s;s=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(a[e]||new Set).forEach((function(e){s.add(e)})))}))}return o.forEach((function(n){var t=r(e,n);t&&i.definitions.push(t)})),i}(t,"getDesignList")},yU3k:function(e,n){var i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"VersionListItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DesignVersion"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sha"},arguments:[],directives:[]}]}}],loc:{start:0,end:57}};i.loc.source={body:"fragment VersionListItem on DesignVersion {\n  id\n  sha\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};e.exports=i}}]);
//# sourceMappingURL=design_management.f04eda47.chunk.js.map